#use wml::debian::template title="Soumission d'informations de miroir volatile"
#use wml::debian::translation-check translation="1.6" maintainer="Frédéric Bothamy"

<p>Si vous désirez soumettre des informations à propos d'un miroir de
<em>debian volatile</em>, veuillez suivre les règles et directives
suivantes.</p>

<h2>Exigences</h2>

<p>Pour être listé, vous devez respecter les critères de base
suivants&nbsp;:</p>
<ul>
  <li>vous devez utiliser rsync comme méthode pour récupérer les paquets
  actuels&nbsp;;</li>
  <li>vous devez fournir un miroir de l'archive complète
  <em>debian-volatile</em>&nbsp;;</li>
  <li>vous devez rafraîchir le miroir de <em>debian-volatile</em> au
  moins une fois par jour&nbsp;;</li>
  <li>vous devez placer la sortie de «&nbsp;date -u&nbsp;» dans
  /project/trace/$YOURHOSTNAME</li>
  <li>vous devez avoir une adresse électronique à laquelle on peut vous
  écrire. <strong>Les entrées seront supprimées si nous ne pouvons pas
  vous contacter.</strong></li>
</ul>

<p>Une fois que tout ceci est mis en place, vous pouvez <a
href="../mirror/submit">remplir le formulaire de soumission de
miroir</a>.</p>

<h2>Mise en place de rsync</h2>

<p>Nous recommandons fortement d'utiliser notre script
<a href="$(HOME)/volatile/mirror-volatile.sh">mirror-volatile.sh</a>.</p>

<p>Vous êtes libre d'utiliser le script que vous voulez, mais
assurez-vous d'en utiliser un sécurisé. Nous <em>n'acceptons pas</em> de
miroirs utilisant debmirror ou des outils similaires pour le miroitage.
Ces outils sont acceptables pour un miroir privé, mais ne sont pas
utilisables pour des miroirs complets car ils excluent beaucoup de
fichiers intéressants.<p>

<p>Une installation bien configurée de rsync conservera un
miroir complet et fonctionnel tout le temps. Les options suivantes de
rsync (en plus de celles que vous avez normalement) devraient faire
l'affaire&nbsp;:</p>

<hr />

<table>
<tr>
 <th>Exécution</th>

 <th>Options</th>
 <th>Impacts</th>
</tr>
<tr>
<td>1</td>
<td>--exclude Packages* --exclude Sources* --exclude Release*</td>

<td>Vous téléchargez les nouveaux fichiers binaires, sources et
Packages, mais pas leurs métadonnées &mdash; utilisées par
<code>apt-get</code>. Notez également qu'aucune option de suppression
n'est donnée.</td>

</tr>
<tr>
<td>2</td>
<td>--delete --delete-after</td>
<td>La seconde exécution récupère maintenant les fichiers exclus de la
première exécution et supprime également tous les fichiers qui ne sont
plus dans l'archive.</td>
</tr>
</table>

<hr />

<p>
Cette approche de miroitage en deux phases assure que les utilisateurs
avec apt-get peuvent toujours récupérer les fichiers qui sont annoncés
comme étant présents (<em>via</em> les fichiers Packages), même si votre
miroir est lui-même en cours de mise à jour au moment où ils tentent de
télécharger des fichiers. Vous êtes libre d'utiliser toute autre option
que vous voulez avoir, mais nous vous suggérons fortement d'utiliser au
moins -lH.</p>

<h2>Miroir <q>Push</q></h2>

<p>Un miroir <q>Push</q> est un miroir normal avec la seule différence
que volatile.debian.org vous indique quand quelque chose a changé dans
l'archive. Il n'est donc pas nécessaire de tenter une synchronisation
périodique, vous êtes notifié des changements d'archive. Une page
intéressante décrivant cela et certaines parties de la configuration est
<a href="http://www.debian.org/mirror/push_mirroring">disponible</a>
sur les serveurs debian.org. Veuillez la lire si vous n'êtes pas
familier avec cela.</p>

<p>Pour configurer votre site comme miroir <q>Push</q> de
volatile.debian.org, vous devez ajouter <a
href="$(HOME)/volatile/id_mirrorpush.pub">cette clé SSH</a> au
fichier .ssh/authorized_keys de l'utilisateur mirror-user. Si vous
étudiez la clé, vous verrez qu'elle est limitée à une seule commande.
Cela veut dire que nous <em>ne pouvons pas</em> nous connecter à votre
système avec cette clé. Il n'y a aucun moyen pour nous de faire autre
chose sur votre système que de déclencher un miroitage toutes les
quelques secondes, mais pour cela, le script que nous fournissons comme
exemple utilise un fichier de verrou pour éviter des exécutions
simultanées. <strong>Vous devez remplacer cela par le script que
vous utilisez, mais <em>ne supprimez pas</em> le &amp; à la
fin.</strong> </p>

<p>Dès que vous avez fini de mettre en place votre serveur, il est prêt à être
ajouté à la liste des serveurs miroirs <q>Push</q>. Pour cela,
assurez-vous d'avoir envoyé le <a href="../mirror/submit">formulaire
standard de soumission de miroir</a> et un courriel (en anglais) à
<email mirrors@debian.org> demandant d'être ajouté à la configuration
<q>Push</q>.</p>

<h2>Considérations de trafic</h2>

<p>
Vous voulez peut-être avoir une idée du trafic à attendre ou de 
l'espace disque nécessaire. L'utilisation de bande passante
dépend des utilisateurs, de la façon dont ils l'utilisent et des miroirs
qu'ils choisissent. Nous avons actuellement environ 20&nbsp;Go par mois
sur volatile.debian.org. Certains miroirs peuvent avoir plus de trafic,
d'autres moins.
</p>

<h2>Considérations d'espace disque</h2>

<p>
Veuillez consulter la <a href="../mirror/size">page de taille des
miroirs</a> pour plus d'informations. Actuellement, l'archive
debian-volatile est relativement petite comparée à certains autres
archives Debian de miroir, mais comme nous ajoutons des paquets de temps
en temps, attendez-vous à ce que l'archive grossisse.
<p>

<h2>Option de configuration supplémentaires recommandées</h2>

<p>Si vous voulez rendre le miroir Debian disponible par HTTP, veuillez
ajouter les options de configuration suivantes à votre configuration
Apache (en supposant, bien sûr, que vous utilisez Apache), où
/chemin/vers/votre/miroir/debian est le nom réel du répertoire où vous
conservez le miroir&nbsp;:</p>

<pre>
   ReadmeName /chemin/vers/votre/miroir/debian/README

   &lt;Directory /chemin/vers/votre/miroir/debian&gt;
      Options +Indexes +SymlinksIfOwnerMatch
      IndexOptions NameWidth=*
      ReadmeName README.txt
   &lt;/Directory&gt;
</pre>   

<p>Cela active les index de répertoire et assure que les liens
symboliques suivants fonctionneront. Les noms de fichier dans les
indices de répertoire ne seront pas tronqués non plus.</p>

# <form method=post action="http://cgi.ftbfs.de/submit_mirror.cgi">
