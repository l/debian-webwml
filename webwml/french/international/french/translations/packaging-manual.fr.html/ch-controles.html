<html><head>
<title>Le manuel de programmation de dpkg - Les fichiers de contrôle et leurs champs</title>
<link rev=made href="mailto:cure@cnam.fr">
</head><body>
<h1>
Le manuel de programmation de dpkg - chapitre 4<br>
Les fichiers de contrôle et leurs champs
</h1>
Beaucoup d'outils dans la suite <code>dpkg</code> manipulent les données dans
un format commun, connu sous le nom de fichiers de contrôle.
Les paquets source et binaire ont des données de contrôle comme les
fichiers <code>.changes</code> qui contrôlent l'installation et le chargement
des fichiers, et les bases de données internes à <code>dpkg</code> sont dans
un format similaire.
<hr>
<h2><A name="s-controles-1">
4.1 La syntaxe des fichiers de contrôle
</A></h2>
Un fichier consiste en un ou plusieurs paragraphes de champs. Ces
paragraphes sont séparés par des lignes blanches. certains fichiers de
contrôle n'autorisent qu'un seul paragraphe; d'autres plusieurs, dans ce
cas, chaque paragraphe fait souvent référence à différent paquet.<P>

Chaque paragraphe est une série de champs et de valeurs; chaque champ
est constitué d'un nom, suivi par deux-points et la valeur. Il se
termine à la fin de la ligne. Les espaces horizontaux (espaces et
tabulations) peuvent apparaître avant ou après la valeur et sont
ignorés; par convention, il y a un espace après les deux-points.<P>

Certaines valeurs de champs peuvent s'étaler sur plusieurs lignes; dans
ce cas, chaque continuation de ligne doit commencer par un espace ou une
tabulation. N'importe quels espaces ou tabulations à la fin des lignes
d'un champ de valeur est ignoré.<P>

Sauf où cela est indiqué, seulement une simple ligne de données est
autorisée et les espaces ne sont pas significatifs dans un corps de
champ. Les espaces ne doivent jamais apparaître dans les noms (de
paquets, d'architectures, de fichiers, etc), dans les numéros de version
ou entre les caractères des relations de version.<P>

Les lignes vides ou les lignes contenant seulement des espaces ou des
tabulations ne sont pas autorisées à l'intérieur des champs de valeur ou
entre les champs - ce qui marqueraient un nouveau paragraphe.<P>

Il est important de noter qu'il y a plusieurs champs qui sont optionnels
tant que <code>dpkg</code> et les outils associés sont concernés, mais qui
doivent apparaître dans chaque paquet Debian, ou dont l'omission peut
entraîner des problèmes. Quand tu écrits des fichiers de contrôle pour
les paquets Debian, tu dois lire le manuel des principes Debian en même
temps que les détails ci-dessous et la liste des champs pour un fichier
particulier.

<hr>
<h2><A name="s-controles-2">
4.2 La liste des champs
</A></h2>
<hr>
<h3><A name="s-controles-2-1">
4.2.1 <code>Package</code>
</A></h3>

Le nom du paquet binaire. Les noms de paquet sont constitués de
caractères alphanumériques et <code>+ - .</code> (plus, moins, point).
<A href="footnotes.html#14" name="fr14">[14]</A><P>

Ils doivent contenir au moins deux caractères et commencer par un caractère
alphanumérique.
Dans la version courante de dpkg, ils sont triés par ordre alphabétique
en tenant compte des majuscules <A href="footnotes.html#15" name="fr15">[15]</A>;
utilise des noms de paquets en minuscule à moins que le paquet que tu
construis (ou est référencé dans d'autres champs) utilise déjà des
majuscules.

<hr>
<h3><A name="s-controles-2-2">
4.2.2 <code>Version</code>
</A></h3>
Ce champ liste le numéro de version des paquets source ou binaire - voir
<A href="ch-versions.html">Numérotation des versions, chapter 5</A>.
<hr>
<h3><A name="s-controles-2-3">
4.2.3 <code>Architecture</code>
</A></h3>

Ce champ est une chaîne de caractères correspondant à une architecture;
c'est un simple mot pour l'architecture.<P>

<code>dpkg</code> vérifiera l'architecture déclarée d'un paquet binaire avec
sa propre valeur in situ avant de l'installer.<P>

La valeur spéciale <code>all</code> indique que le paquet est indépendant de
l'architecture.<P>

Dans le fichier principal <code>debian/control</code> du paquet source, ou dans
le fichier de contrôle des paquets sources <code>.dsc</code>, une liste des
architectures (séparée par des espaces) est aussi autorisée, tout comme
la valeur spéciale <code>any</code>.
Une liste indique que le source construira un paquet dépendant de
l'architecture, et fonctionnera correctement seulement sur les
architectures listées. <code>any</code> indique que même si le paquet source
n'est pas dépendant d'une architecture particulière et devrait bien se
compiler sur n'importe laquelle, les paquets binaires produits ne sont
pas indépendants des architectures mais sera par contre spécifique à
l'architecture courante de construction.<P>

Dans un fichier <code>.changes</code>, le champ <code>Architecture</code> liste la
ou les architectures des paquets qui sont chargés. Ce sera une liste; si
le source du paquet est aussi chargé, l'entrée spéciale <code>source</code>
est aussi présent.<P>

L'architecture courante de construction peut être déterminée en
utilisant <code>dpkg --print-architecture</code>
<A href="footnotes.html#16" name="fr16">[16]</A>.
Cette valeur est automatiquement utilisée par <code>dpkg-gencontrol</code>
quand il construit le fichier de contrôle pour un paquet binaire pour
lequel les informations de contrôle source ne spécifient pas
l'architecture <code>all</code>.<P>

Il existe une option à part, <code>--print-installation-architecture</code>,
pour trouver quelle architecture, <code>dpkg</code> est prêt à installer.
Cette information est aussi dans la sortie de <code>dpkg --version</code>.<P>

<hr>
<h3><A name="s-controles-2-4">
4.2.4 <code>Maintener</code>
</A></h3>

Ce champ contient le nom du mainteneur et son adresse de courrier électronique.
Le nom vient d'abord, suivi par l'adresse du courrier électronique entre
les signes inférieurs et supérieurs &lt;&gt; (au format RFC822).

Si le nom du mainteneur contient un point alors le champ entier ne
fonctionnera pas directement comme une adresse électronique à cause
d'un problème dans la syntaxe spécifiée dans la RFC822; un programme
utilisant ce champ comme une adresse doit vérifier cela et corriger le
problème si nécessaire (par exemple en mettant entre parenthèses le nom
et en le déplaçant à la fin, et en amenant l'adresse électronique
devant).

Le fichier <code>.changes</code> ou les données analysées de
changelog contiennent le nom et l'adresse électronique de la personne
responsable de cette version particulière en question - ce n'est pas
forcément le mainteneur habituel du paquet.<P>

Ce champ est habituellement optionnel tant qu'il concerne <code>dpkg</code>,
mais son absence génère généralement un avertissement lors de la
construction de paquets.<P>
<hr>
<h3><A name="s-controles-2-5">
4.2.5 <code>Source</code>
</A></h3>

Ce champ identifie le nom du paquet source.<P>

Dans un fichier principal d'information de contrôle de source ou dans un
fichier <code>.changes</code> ou dans un fichier <code>.dsc</code> ou dans les
données analysées de changelog, ceci peut seulement contenir le nom du
paquet source.<P>

Dans un fichier de contrôle d'un paquet binaire (ou dans un fichier
<code>Packages</code>), il peut être suivi par un numéro de version entre
parenthèses<A href="footnotes.html#17" name="fr17">[17]</A>.
Ce numéro de version peut être omis (et l'est par <code>dpkg-
gencontrol</code>) s'il a la même valeur que le champ <code>Version</code> du
paquet binaire en question. Le champ lui-même peut être omis d'un
fichier de contrôle d'un paquet binaire quand le paquet source possède
le même nom et la même version que le paquet binaire.<P>

<hr>
<h3><A name="s-controles-2-6">
4.2.6 Champs de relation entre paquets: <code>Depends, Pre-Depends,
Recommends, Suggest, Conflicts, Provides, Replaces</code>
</A></h3>
Ces champs décrivent les relations du paquet avec les autres paquets.
Leurs syntaxes et sémantiques sont décrites dans <A href="ch-relation.html">Déclaration des relations entre les paquets, chapter 8</A>.<P>
<hr>
<h3><A name="s-controles-2-7">
4.2.7 Description
</A></h3>
Dans un paquet binaire, dans le fichier <code>Packages</code> ou le fichier
principal de contrôle du source, ce champs contient une description du
paquet binaire, dans un format spécial. Voir <A href="ch-descript.html">Description des paquets - le champ <code>Description</code>, chapter 7</A>
pour les détails.<P>

Dans un fichier <code>.changes</code>, il contient un résumé de la description
des paquets chargés. La partie du champ avant la première nouvelle ligne
est vide; ensuite chaque ligne possède le nom d'un paquet binaire et la
ligne de résumé de la description de ce paquet binaire.
Chaque ligne est indentée par un espace.<P>
<hr>
<h3><A name="s-controles-2-8">
4.2.8 Essential
</A></h3>
C'est un champ booléen qui peut apparaître seulement dans un fichier de
contrôle d'un paquet binaire (ou dans le fichier <code>Packages</code>) ou
dans un paragraphe de champs par paquet d'un fichier principal de
données de contrôle de source.<P>

S'il est positionné à <code>yes</code> alors <code>dpkg</code> et <code>dselect</code>
refuseront d'enlever ce paquet (bien qu'il puisse être mis à niveau
et/ou déplacer). L'autre valeur possible est <code>no</code>, ce qui est la
même chose que de n'avoir pas de champ du tout.<P>
<hr>
<h3><A name="s-controles-2-9">
4.2.9 Section et Priority
</A></h3>
Ces deux champs classent le paquet. La <code>Priority</code> représente
l'importance du paquet installé; la <code>Section</code> représente un zone
d'application dans laquelle le paquet a été classifiée.<P>

Quand ces champs apparaissent dans le fichier <code>debian/control</code>, ils
donnent les valeurs des sous-champs priorité et section du champ
<code>Files</code> du fichier <code>.changes</code>, et donnent les valeurs par
défaut de la section et de la priorité pour les paquets binaires.<P>

La section et la priorité sont représentées, même pas comme des champs
séparés, dans les informations  pour chaque fichier dans le champ
<code>Files</code> d'un fichier <code>.changes</code>. La valeur de la section dans
un fichier <code>.changes</code> est utilisée pour décider où sera installé le
paquet dans une archive FTP.<P>

Ces champs ne sont pas utilisés par <code>dpkg</code>, mais par <code>dselect</code>
quand il trie les paquets et sélectionne la valeurs par défaut. Voir le
manuel des principes Debian pour les priorités en usage et les critères
pour sélectionner les priorités pour les paquets Debian, et regarde une
archive FTP Debian pour obtenir une liste des priorités courantes.<P>

Ces champs peuvent apparaître dans les fichiers de contrôle des paquets
binaires, dans ce cas, ils fournissent une valeur par défaut au cas où
les fichiers <code>Packages</code> ne possèdent pas l'information. <code>dpkg</code>
et <code>dselect</code> n'utiliseront seulement la valeur d'un fichier
<code>.deb</code> que s'ils n'ont pas d'autres informations; une valeur listée
dans un fichier <code>Packages</code> sera toujours prioritaire.
Par défaut <code>dpkg-genchanges</code> n'inclut pas la section et la priorité
dans le fichier de contrôle d'un paquet binaire - utilise les options
<code>-isp, -is</code> ou <code>-ip</code> pour réaliser cette opération.<P>
<hr>
<h3><A name="s-controles-2-10">
4.2.10 Binary
</A></h3>

Ce champ est une liste de paquets binaires.<P>

Quand il apparaît dans un fichier <code>.dsc</code>, il représente la liste
des paquets binaires qu'un paquet source peut produire.
Il ne produit pas nécessairement tous ces paquets binaires pour chaque
architecture. Le fichier de contrôle source ne contient pas les détails
sur les architectures qui sont les plus appropriées pour les paquets
binaires.<P>

Quand il apparaît dans un fichier <code>.changes</code>, il liste les noms des
paquets binaires actuellement chargés.<P>

La syntaxe est une liste de paquets binaires séparée par des
virgules<A href="footnotes.html#18" name="fr18">[18]</A>.
Actuellement, les paquets doivent être séparés en utilisant seulement
des espaces dans le fichier <code>.changes</code>.<P>
<hr>
<h3><A name="s-controles-2-11">
4.2.11 Installed-size
</A></h3>

Ce champ apparaît dans les fichiers de contrôle des paquets binaires, et
dans les fichiers <code>Packages</code>. Il donne la capacité totale du disque
nécessaire pour installer le dit paquet.<P>

L'espace disque est représenté en Kilo-octets comme un nombre décimal
simple.<P>
<hr>
<h3><A name="s-controles-2-12">
4.2.12 Files
</A></h3>

Ce champ contient la liste des fichiers avec les informations sur chacun
d'eux. L'information exacte et la syntaxe exacte varient avec le
contexte. Dans tous les cas, la partie du contenu du champ sur la même
ligne que le nom du champ est vide. Le reste du champ est une ligne par
fichier, chaque ligne est indentée par un espace et contient un nombre
de sous-champs séparés par des espaces.<P>

Dans le fichier <code>.dsc</code> (contrôle des sources Debian), chaque ligne
contient la somme de contrôle MD5, la taille et le nom du fichier tar et
(éventuellement) le fichier diff qui représente le reste du paquet
source<A href="footnotes.html#19" name="fr19">[19]</A>.
Les formes exactes des noms de fichier sont décrites dans
<A href="ch-sources.html#s-sources-3">Les paquets sources comme archives, section 3.3</A>.<P>

Dans le fichier <code>.changes</code>, il contient une ligne par fichier
chargé. Chaque ligne contient la somme de contrôle, la taille, la
section et la priorité et le nom du fichier. La section et la priorité
sont les valeurs des champs correspondants dans le fichier principal de
contrôle source - voir <A href="#s-controles-2-9">Section et Priority, subsection 4.2.9</A>.
Si aucune section ou
priorité n'est spécifiée alors <code>-</code> doit être utilisé, bien que les
valeurs de section et de priorité doivent être spécifiées pour installer
proprement les nouveaux paquets.<P>

La valeur spéciale <code>byhand</code> pour la section dans un fichier
<code>.changes</code> indique que le fichier en question n'est pas un fichier
ordinaire de paquet et doit être installé  à la main par les mainteneurs
de la distribution. Si la valeur de la section est <code>byhand</code> alors
la valeur de la priorité devrait être <code>-</code>.<P>

Si une nouvelle révision Debian d'un paquet est chargée et qu'aucune
archive originale source n'est distribuée, le fichier <code>.dsc</code> doit
toujours contenir l'entrée du champ <code>Fields</code> pour l'archive
originale source <em>package-upstream-version</em><code>.orig.tar.gz</code> mais
le fichier <code>.changes</code> devrait l'omettre. Dans ce cas, l'archive
originale source sur le site de distribution doit être exactement, octet
par octet, l'archive originale source qui a été utilisée pour générer le
fichier <code>.dsc</code> et le fichier diff qui a été chargé.<P>
<hr>
<h3><A name="s-controles-2-13">
4.2.13 Standards-Version
</A></h3>

Ce champ contient la version la plus récente des standards (les manuels
des principes et du programmeur dpkg et les textes associés) auxquels
le paquet se conforme. Le champ est mis à jour manuellement lors de
l'édition du paquet source pour se conformer aux nouveaux standards; il
peut parfois être utilisé pour signaler qu'un paquet a besoin d'une
attention particulière.<P>

Son format est le même que le numéro de version sauf que epoch et la
révision Debian ne sont pas autorisés - voir <A href="ch-versions.html">Numérotation des versions, chapter 5</A>.<P>
<hr>
<h3><A name="s-controles-2-14">
4.2.14 Distribution
</A></h3>

Dans un fichier <code>.changes</code> ou dans la sortie analysée de changelog,
ce champ contient le ou les noms (séparés par des espaces) de la ou les
distributions où cette version du paquet devrait être ou a été
installée. Les noms de distribution suivent les règles des noms de
paquets (voir <A href="#s-controles-2-1"><code>Package</code>, subsection 4.2.1</A>).<P>

Les valeurs des distributions courantes sont:
<dl>
<dt>stable<dd>C'est la version courante mise à jour de Debian GNU/Linux. Une
nouvelle version apparaît approximativement tous les 3 mois après que le
code de <em>développement</em> ait été <em>gelé</em> pendant un mois de
test. Une fois que la distribution est <em>stable</em>, seule la
correction d'erreurs majeures est autorisée. Quand les changements sont
faits sur cette distribution, le chiffre mineur de la version est
incrémenté (par exemple: 1.2 devient 1.2.1 puis 1.2.2, etc).
<p><dt>unstable<dd>Cette valeur de distribution fait référence à une partie en cours
de développement de l'arbre de distribution Debian. Les nouveaux
paquets, les nouvelles versions de paquets et la correction d'erreur
vont dans le répertoire <em>unstable</em>. Travailler avec cette
distribution est de ta seule responsabilité.
<p><dt>contrib<dd>Les paquets avec cette valeur de distribution ne respectent pas
les critères pour être inclus dans la distribution principale Debian
comme défini dans le manuel des principes, mais respectent les critères
pour une distribution <em>contrib</em>. Il n'y a actuellement aucune
distinction entre les paquets <em>stable</em> et <em>unstable</em> dans les
distributions <em>contrib</em> et <em>non-free</em>. Utilise à bon escient
le chargement de cette distribution.
<p><dt>non-free<dd>Comme les paquets de la section <em>contrib</em>, les paquets dans
la distribution <em>non-free</em> ne respectent pas certains critères pour
pouvoir être inclus dans la distribution principale Debian comme défini
dans la manuel des principes. De nouveau, utilise à bon escient cette
distribution.
<p><dt>experimental<dd>Les paquets de cette valeur de distribution sont considérés par
leur mainteneur comme étant risqué. Souvent, ils représentent les
paquets en béta-test ou en cours de développement provenant de sources
variées que le mainteneurs veut faire tester, mais ne sont pas prêt pour
être inclus dans l'arbre de distribution Debian. A utiliser à tes
risques et périls.
<p><dt>frozen<dd>De temps en temps, (généralement, tous les 3 mois) la distribution
<em>unsable</em> rentre dans un état 'gelé' dans l'attente d'une version
<em>stable</em>. Pendant cette période de test (habituellement 4
semaines), seules les corrections d'erreurs existantes ou récemment
découvertes sont autorisées.<P>
<p></dl>


Tu devrais lister <em>toutes</em> les distributions où le paquet devrait
être installé. Sauf dans des circonstances inhabituelles; les
installations vers <em>stable</em> doivent aussi aller dans <em>frozen</em>
(si il existe) et dans <em>unstable</em>.
De même, les installations dans <em>frozen</em> devraient aussi aller dans
<em>unstable</em>.<P>
<hr>
<h3><A name="s-controles-2-15">
4.2.15 Urgency
</A></h3>

Ce champ est une description de l'importance d'une mise à jour d'une
version à l'autre. Il contient un simple mot-clé qui prend
habituellement une de ces valeurs <code>LOW, MEDIUM</code> ou <code>HIGH</code>
suivi par un commentaire optionnel (séparé par un espace) qui est
généralement entre parenthèses. Par exemple:
<pre>Urgency: LOW (HIGH for diversions users)</pre>

Ce champ apparaît dans le fichier <code>.changes</code> et dans les changelogs
analysées; sa valeur apparaît comme valeur de l'attribut <code>urgency</code>
dans le changelog de <code>dpkg</code>-style (voir <A href="ch-sources.html#s-sources-2-2"><code>debian/control</code>, subsection 3.2.2</A>).<P>

Les mots-clé ne sont pas sensibles au majuscule/minuscule.<P>
<hr>
<h3><A name="s-controles-2-16">
4.2.16 Date
</A></h3>
Dans les fichiers <code>.changes</code> et les changelogs analysés, ce champ donne
la date de la construction de paquet ou de la dernière édition.<P>
<hr>
<h3><A name="s-controles-2-17">
4.2.17 Format
</A></h3>
Le champ apparaît dans les fichiers <code>.changes</code>, et spécifie une
révision de format pour le fichier. Le format décrit ici est la version
<code>1.5</code>. La syntaxe de la valeur du format est la même que la
numérotation de la version des paquets, sauf que epoch et la révision
Debian ne sont pas autorisés - voir <A href="ch-versions.html">Numérotation des versions, chapter 5</A>.<P>
<hr>
<h3><A name="s-controles-2-18">
4.2.18 Changes
</A></h3>
Dans un fichier <code>.changes</code> ou dans un changelog analysé, ce champ
contient les données lisibles des changements, décrivant les différences
entre la dernière version et celle courante.<P>

Il ne doit rien y avoir dans ce champ avant le première nouvelle ligne;
toutes les lignes suivantes doivent être indentées par au moins un
espace; les lignes vides doivent être représentées par une ligne
contenant seulement un espace et un point.<P>

Chaque information de changement de version doit être précédée par une
ligne de 'titre' donnant au moins la version, la ou les distributions
et l'urgence, d'une façon lisible.<P>

Si les données de plusieurs versions sont retournées, l'entrée de la
plus récente version doit être retournées d'abord, et les entrées
doivent être séparées par une ligne vide (la ligne de 'titre' peut aussi
être suivi par une ligne vide).<P>
<hr>
<h3><A name="s-controles-2-19">
4.2.19 Filenames et MSDOS-Filename
</A></h3>
Ces champs dans les fichiers <code>Packages</code> donnent les noms de
fichiers d'un paquet dans une distribution, par rapport à la racine de
la hiérarchie Debian. Si le paquet a été découpé en plusieurs morceaux,
les parties sont toutes listées dans l'ordre, séparées par des espaces.<P>
<hr>
<h3><A name="s-controles-2-20">
4.2.20 Size et MD5sum
</A></h3>
Ces champs dans les fichiers <code>Packages</code> donnent la taille (en
octets, exprimée en décimal) et la somme de contrôle MD5 du ou des
fichiers qui composent le paquet de la distribution. Si le paquet est
découpé en plusieurs parties, les valeurs pour ces parties sont listées
dans l'ordre, séparées par des espaces.<P>
<hr>
<h3><A name="s-controles-2-21">
4.2.21 Status
</A></h3>
Ce champ dans le fichier status de <code>dpkg</code> enregistre si
l'utilisateur veut un paquet installé, enlevé ou laissé tout seul, si il
est incorrect (nécessite une réinstallation) ou non et son état courant
sur le système. Chaque morceau de ces informations est un simple mot.<P>
<hr>
<h3><A name="s-controles-2-22">
4.2.22 Config-version
</A></h3>
Si un paquet n'est pas installé, ou non configuré, ce champ dans le
fichier status de <code>dpkg</code> enregistre la dernière version de ce
paquet qui a été configuré avec succès.<P>
<hr>
<h3><A name="s-controles-2-23">
4.2.23 Conffiles
</A></h3>
Ce champ dans le fichier status de <code>dpkg</code> contient les informations
sur les fichiers de configuration automatiquement gérés maintenus par un
paquet. Ce champ <em>ne doit pas</em> apparaître n'importe où dans un
paquet!<P>
<hr>
<h3><A name="s-controles-2-24">
4.2.24 Champs obsolètes
</A></h3>
Ils sont toujours reconnus par <code>dpkg</code> mais ne doivent plus
apparaître n'importe où.

<dl>
<dt>Revision<dd><p><dt>Package-Revision<dd><p><dt>Package_Revision<dd>La partie revision Debian d'une version de paquet était à un
moment dans un champ de fichier de contrôle séparé. Ce champ était
présent à travers plusieurs noms.
<p><dt>Recommended<dd>Ancienne dénomination pour <code>Recommends</code>.
<p><dt>Optional<dd>Ancienne dénomination pour <code>Suggests</code>.
<p><dt>Class<dd>Ancien nom pour <code>Priority</code>.
<p></dl>


<hr>
Le manuel de programmation de dpkg
- <A href="index.html#copyright">Copyright ©1996 Ian Jackson
Copyright ©1997 David Curé et Christian Jacolot pour
           la version française.</A>
<br>
<A href="index.html#toc">Table des matières</A>; <A href="index.html#abstract">résumé</A>; <A href="ch-versions.html">suivant</A>; <A href="ch-sources.html">précédent</A>.
<br>
<address>20 décembre 1997<br>
D. Cure <A href="mailto:cure@cnam.fr">cure@cnam.fr</A><br>
C. Jacolot <A href="mailto:jacolot@ubolib.univ-brest.fr">jacolot@ubolib.univ-brest.fr</A></address>
</body></html>