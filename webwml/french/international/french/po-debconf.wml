#use wml::debian::template title="Traduction des fichiers PO associés à debconf"

<h2>Sommaire</h2>

<ul>
  <li><a href="#format">Format des fichiers <tt>templates</tt> de debconf</a></li>
  <li><a href="#po">Utilisation de po-debconf</a></li>
  <li><a href="#list">Coordination des traductions sur debian-l10n-french</a></li>
  <li><a href="#faq">Foire aux questions</a></li>
</ul>



<h2><a name="format">Format des fichiers <tt>templates</tt> de debconf</a></h2>

<p>
Debconf fournit une interface cohérente pour la configuration des
paquets et donne à l'utilisateur le choix entre plusieurs interfaces.
Il peut configurer des paquets avant qu'ils ne soient installés, ce
qui permet à des installations et des mises à niveau importantes de
demander toutes les informations nécessaires au préalable, et de
vous laisser faire ce que vous voulez pendant que les paquets
s'installent. Debconf vous permet, si vous êtes pressé, de sauter les
questions les moins importantes au moment de l'installation d'un
paquet.
</p>

<p>
Les messages affichés par debconf sont mis dans un fichier appelé
<tt>templates</tt>, dont le format est similaire à celui des fichiers
<tt>debian/control</tt> des paquets source Debian &mdash; voir
<tt>deb-control</tt>(5) et <tt>debconf-devel</tt>(7). Voici un exemple :
</p>
<pre>
Template: debconf/frontend
Type: select
Choices: Dialog, Readline, Gnome, Editor, Noninteractive
Description: What interface should be used for configuring packages?
 Packages that use debconf for configuration share a common look and feel.
 You can select the type of user interface they use.
 .
 The dialog frontend is a full-screen, character based interface, while the
 readline frontend uses a more traditional plain text interface, and the
 gnome frontend is a modern X interface. The editor frontend lets you
 configure things using your favorite text editor. The noninteractive
 frontend never asks you any questions.
</pre>

<p>
Le format est basé sur la RFC822 qui définit les en-têtes des
courriels. Il suffit de savoir que chaque ligne est composé d'une
paire « <i>Champ</i>: <i>Valeur</i> », et qu'une ligne commençant
par un espace continue la ligne précédente. L'exemple ci-dessus est
donc composé de 4 champs, le dernier étant disposé sur plusieurs
lignes. S'il y a plusieurs messages, ils sont séparés par une ligne
vide. Il existe deux conventions supplémentaires pour aider au
formatage du texte :
</p>
<ol>
  <li>dans un champ s'étalant sur plusieurs lignes, un point isolé
      sur une ligne sépare deux paragraphes ;</li>
  <li>dans un champ s'étalant sur plusieurs lignes, si une ligne
      commence par plus d'un espace, elle est affichée telle
      quelle.</li>
</ol>

<p>
Chaque bloc contient obligatoirement les champs <b>Template</b>
(sa valeur est un identifiant permettant de distinguer les
différents messages du paquet) et <b>Type</b> (qui indique
le type de message à afficher). Les autres champs possibles sont
<b>Choices</b>, <b>Default</b> et <b>Description</b>.
</p>

<p>
Debconf a été conçu dès l'origine pour que les messages puissent être
traduits facilement. Pour cela, on ajoute au nom du champ la langue
dans laquelle ce champ est traduit ; par exemple, un champ
<b>Description-fr</b> désigne un champ <b>Description</b> traduit en français.
Le fichier <tt>templates</tt> utilisé par debconf ressemble alors à :
</p>
<pre>
Template: debconf/frontend
Type: select
Choices: Dialog, Readline, Gnome, Editor, Noninteractive
Choices-fr: Dialogue, Readline, Gnome, Éditeur, Non-interactif
Description: What interface should be used for configuring packages?
 Packages that use debconf for configuration share a common look and feel.
 You can select the type of user interface they use.
 .
 The dialog frontend is a full-screen, character based interface, while the
 readline frontend uses a more traditional plain text interface, and the
 gnome frontend is a modern X interface. The editor frontend lets you
 configure things using your favorite text editor. The noninteractive
 frontend never asks you any questions.
Description-fr: Quelle interface utiliser pour configurer les paquets ?
 Les paquets utilisant debconf pour leur configuration ont une interface et
 une ergonomie communes. Vous pouvez choisir leur interface utilisateur. 
 .
 « Dialogue » est une interface couleur en mode caractère et en plein
 écran. « Readline » est une interface plus traditionelle en mode texte.
 « Gnome » est une interface X moderne. L'interface « Éditeur » vous permet
 de faire vos configurations depuis votre éditeur favori. Si vous 
 choisissez « Non-interactif », le système ne vous posera jamais de
 question.
</pre>
<p>
Le paquet <tt>debconf-utils</tt> contient les outils qui avaient été
conçus pour manipuler les traductions de fichiers <tt>templates</tt>.
</p>

<p>
Depuis debconf 1.2, le nom du champ contient en plus le codage utilisé
pour cette traduction. Ainsi dans l'exemple précédent, les champs
<b>Choices-fr</b> et <b>Description-fr</b> seront désormais remplacés
par <b>Choices-fr.iso-8859-15</b> et <b>Description-fr.iso-8859-15</b>.
</p>

<h2><a name="po">Utilisation de po-debconf</a></h2>

<p>
Le format des fichiers utilisés par debconf pendant la configuration
des paquets a été exposé dans la partie précédente. Ces fichiers ne
doivent pas être écrits directement, car cela poserait plusieurs problèmes :
</p>
<ul>
  <li>chaque langue utilise un codage différent, et le mélange de
      différents codages au sein d'un même fichier peut poser des
      problèmes à certains éditeurs de texte ;</li>
  <li>si chaque traducteur devait envoyer des corrections sur le même fichier,
      cela pourrait entrainer des conflits ;</li>
  <li>lorsqu'un champ en anglais est modifié, il faudrait mettre à jour en
      même temps toutes ses traductions, ce qui n'est pas réalisable.</li>
</ul>

<p>
Afin de remédier à tous ces inconvénients, les traductions sont mises
dans des fichiers séparés, et le fichier <tt>templates</tt> final est
généré pendant la compilation du paquet binaire.
</p>

<p>
Auparavant le paquet <tt>debconf-utils</tt> contenait les outils
permettant de gérer les traductions de fichiers <tt>templates</tt>,
mais ces outils sont obsolètes et remplacés par <tt>po-debconf</tt>,
qui est décrit ci-dessous.
</p>

<p>
Le principe est exactement le même que pour gettext :
</p>
<ul>
  <li>le développeur marque les champs à traduire dans son fichier
      source ;</li>
  <li>un programme permet d'extraire ces chaînes et fournit un fichier
      <tt>templates.pot</tt> ;</li>
  <li>le traducteur utilise ce fichier <tt>templates.pot</tt> comme
      n'importe quel autre fichier POT de gettext : lors de la
      première traduction, il le renomme en <tt>fr.po</tt> et traduit
      toutes les chaînes disponibles. Pour les mises à jour, il peut
      utiliser la commande <code>msgmerge</code>.
  <li>un programme permet, à partir du fichier <tt>templates</tt>
      original et de tous les fichiers <tt>*.po</tt>, de générer le
      fichir <tt>templates</tt> final contenant toutes les
      traductions.</li>
</ul>

<p>
Dans la pratique, c'est encore plus simple, car certaines étapes sont
automatiques. En reprenant l'exemple précédent, le développeur a
écrit le fichier <tt>debian/templates</tt> suivant :
</p>
<pre>
Template: debconf/frontend
Type: select
_Choices: Dialog, Readline, Gnome, Editor, Noninteractive
Default: Dialog
_Description: What interface should be used for configuring packages?
 Packages that use debconf for configuration share a common look and feel.
 You can select the type of user interface they use.
 .
 The dialog frontend is a full-screen, character based interface, while the
 readline frontend uses a more traditional plain text interface, and the
 gnome frontend is a modern X interface. The editor frontend lets you
 configure things using your favorite text editor. The noninteractive
 frontend never asks you any questions.
</pre>

<p>
Deux champs sont précédés du caractère souligné (<tt>_</tt>), ce qui
signifie que le développeur demande aux traducteurs de traduire ces
champs, et seulement ceux-là.
</p>

<p>
Avant de construire son paquet, le développeur a exécuté la commande
<code>debconf-updatepo</code>, qui génère un fichier
<tt>debian/po/templates.pot</tt> contenant les chaînes marquées comme
étant à traduire dans le fichier <tt>debian/templates</tt>, et met
à jour les fichiers <tt>debian/po/*.po</tt> s'ils existent. Le
même exemple fournit un fichier ressemblant à :
</p>
<pre>
\#
\#    Translators, if you are not familiar with the PO format, gettext
\#    documentation is worth reading, especially sections dedicated to
\#    this format, e.g. by running:
\#         info -n '(gettext)PO Files'
\#         info -n '(gettext)Header Entry'
\#
\#    Some information specific to po-debconf are available at
\#            /usr/share/doc/po-debconf/README-trans
\#         or http://www.debian.org/intl/l10n/po-debconf/README-trans
\#
\#    Developers do not need to manually edit POT or PO files.
\#
\#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: PACKAGE VERSION\n"
"POT-Creation-Date: 2003-05-22 22:47+0200\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME &lt;EMAIL@ADDRESS&gt;\n"
"Language-Team: LANGUAGE &lt;LL@li.org&gt;\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=CHARSET\n"
"Content-Transfer-Encoding: 8bit\n"

\#. Choices
\#: ../templates:3
msgid "Dialog, Readline, Gnome, Editor, Noninteractive"
msgstr ""

\#. Description
\#: ../templates:5
msgid "What interface should be used for configuring packages?"
msgstr ""

\#. Description
\#: ../templates:5
msgid ""
"Packages that use debconf for configuration share a common look and feel. "
"You can select the type of user interface they use."
msgstr ""

\#. Description
\#: ../templates:5
msgid ""
"The dialog frontend is a full-screen, character based interface, while the "
"readline frontend uses a more traditional plain text interface, and the "
"gnome frontend is a modern X interface. The editor frontend lets you "
"configure things using your favorite text editor. The noninteractive "
"frontend never asks you any questions."
msgstr ""
</pre>

<p>
La documentation de gettext explique en détail le format de ce fichier.
On voit cependant que le type de champ est indiqué (<b>Choices</b> et
<b>Description</b> dans cet exemple), que le numéro de ligne dans le
fichier <tt>templates</tt> permet de retrouver la chaîne dans son
contexte, et que le champ <b>Description</b> a été coupé en
3 chaînes : une pour la première phrase (qui est comme un titre),
et une pour chaque paragraphe.
</p>

<h2><a name="list">Coordination des traductions sur debian-l10n-french</a></h2>

<p>
La marche à suivre pour traduire ou mettre à jour un questionnaire
debconf est assez simple.
</p>
<ol>
  <li>Vous allez sur
      <tt>http://www.fr.debian.org/intl/l10n/po-debconf/fr.fr.html</tt>
      et sélectionnez un paquet (choisissez de préférence des paquets que
      vous connaissez bien, afin d'éviter les contre-sens).</li>
  <li>Vous postez un message sur la liste
      <a href="mailto:debian-l10n-french@lists.debian.org">debian-l10n-french</a>
      indiquant votre intention de traduire. Pour cela, vous mettez dans le
      sujet <b>[ITT] po-debconf://foo/fr.po</b> où <i>foo</i> est à
      remplacer par le nom du paquet (et <b>ITT</b> est l'acronyme de
      « Intent To Translate »).</li>
  <li>Vous attendez un jour ou deux, afin de laisser le temps aux autres
      traducteurs de vous indiquer si quelqu'un est déjà en charge de cette
      traduction.</li>
  <li>Si personne ne s'est opposé à votre message, vous traduisez le
      fichier PO comme décrit dans la section précédente, et l'envoyez en
      relecture sur la liste
      <a href="mailto:debian-l10n-french@lists.debian.org">debian-l10n-french</a>
      en remplaçant dans le sujet <b>ITT</b> par <b>DDR</b> (pour « demande
      de relecture »).</li>
  <li>Les relecteurs vont sauver ce fichier, et vous envoyer, soit en
      privé, soit sur la liste, des suggestions de correction sous la
      forme de rustine (« patch »).</li>
  <li>Pendant un jour ou deux, vous collectez les commentaires des
      différents relecteurs ; si vous êtes d'accord avec les corrections
      proposées, vous les incorporez puis envoyez un dernier message sur la
      liste en remplaçant <b>DDR</b> par <b>Relu</b>. En cas de désaccord
      avec un relecteur, vous essayez de trouver une solution, et si c'est
      impossible, vous demandez un arbitrage sur la liste.</li>
  <li>Enfin, il faut envoyer la traduction au responsable du paquet.
      Le plus simple est d'utiliser <code>reportbug</code>, en
      choisissant une priorité (« priority ») <i>minor</i>, la marque
      (« tag ») <i>patch</i>, avec un sujet clair (« French translation
      for debconf templates », par exemple). Il faut mettre le fichier
      <tt>fr.po</tt> en attachement, le BTS sait maintenant bien les gérer.
      Si la traduction française est nouvelle, il vaut mieux indiquer
      dans le corps du message que le fichier attaché doit être mis dans
      <tt>debian/po/fr.po</tt>, afin d'éviter les mauvaises
      surprises.</li>
</ol>

<h2><a name="faq">Foire aux questions</a></h2>

<p>À faire.</p>
