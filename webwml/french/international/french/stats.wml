
#use wml::debian::template title="Statistiques du projet de traduction"

#include 'ltcp.def'

#depends 'documents-bd.pl'
#depends 'check_trans.status'


<perl>
#include 'ltcp.pl'              IPP_NOSYNCLINES
#include 'doccurrent_status.pl' IPP_NOSYNCLINES

update_db_format();

my ($total, $cat, $cpt);

foreach my $k (sort keys %$translations) {
	$total++;
	my $t = $translations->{$k} ;
	$cat->{'DDP'}++;
	$cpt->{'DDP'}->{$t->{'status'}}++;
}

#include 'current_status.pl' IPP_NOSYNCLINES

update_db_format();

foreach my $k (sort keys %$translations) {
	$total++;
	my $t = $translations->{$k} ;
	$cat->{'Web'}++;
	$cpt->{'Web'}->{$t->{'status'}}++;
}

print "
<p>Nombre total de documents : $total</p>
<p>Documents du DDP: $cat->{'DDP'}</p>
<ul>
";

$filename[0] = 'unavailable';
$filename[1] = 'untranslated';
$filename[2] = 'beingtranslated';
$filename[3] = 'outdated';
$filename[4] = 'uptodate';
$filename[5] = 'unchecked';
$filename[6] = 'beingrevised';
$filename[7] = 'obsolete';
$filename[8] = 'unknown';

foreach my $s (sort keys %{$cpt->{'DDP'}}) {
	printf ("<li>Documents « <a href=\"doc-$filename[$s].fr.html\">$status[$s]</a> » : $cpt->{'DDP'}->{$s} (%.1f\%)</li>\n",
           $cpt->{'DDP'}->{$s}/$cat->{'DDP'}*100);
}

print "
</ul>
<p>Documents du site web: $cat->{'Web'}</p>
<ul>
";

foreach my $s (sort keys %{$cpt->{'Web'}}) {
	printf ("<li>Documents « <a href=\"www-$filename[$s].fr.html\">$status[$s]</a> » : $cpt->{'Web'}->{$s} (%.1f\%)</li>\n",
           $cpt->{'Web'}->{$s}/$cat->{'Web'}*100);
}
print "
</ul>
";

</perl>
 
