#use wml::debian::template title="Configuración de una réplica FTP"
#use wml::debian::toc
#use wml::debian::translation-check translation="1.27"

<p>El replicado es el mismo tanto para sitios no oficiales como 
<a href="official">oficiales</a>.

<p>Una vez ponga en marcha una réplica, debería <a
href="submit">registrarla en Debian</a> de manera que sea incluida en la
<a href="list">lista de réplicas</a>. Puede hacerlo
mediante nuestro <A href="submit">sencillo formulario web</A>.

<p>Puede consultar cualquier problema o pregunta la puede enviar a
<A href="mailto:mirrors@debian.org">mirrors@debian.org</A>.
</p>

<toc-display/>

<toc-add-entry name="wherefrom">De dónde replicar</toc-add-entry>

<p>Mucha gente parece pensar que <code>ftp.debian.org</code> es el
sitio canónico o principal donde encontrar los paquetes de Debian,
y que lo mejor es replicar ese sitio. Eso <strong>no es
cierto</strong>. <code>ftp.debian.org</code> es simplemente uno de
entre varios servidores que se actualizan a partir de un servidor
interno de Debian.</p>

<p>Cualquiera de los servidores de la <a href="list-full">lista
completa de réplicas</a> que tengan la etiqueta '<kbd>Type:
Push-Primary</kbd>' deberían ser buenos sitios de los que replicar.

<p>Para usted, no hay apenas diferencia entre replicar ese servidor y
replicar otro servidor <em>Push-Primary</em>. Por otra parte, si mucha
gente usa ftp.debian.org (y por desgracia, así es), se desperdicia el
ancho de banda que nos donan.</p>

<toc-add-entry name="methods">Métodos de replicación</toc-add-entry>

<p>El método recomendado para hacer réplicas es usando rsync.

<p>Nota: mientras que <kbd>wget</kbd> funciona bien cuando se replican
sitios pequeños, no es tan configurable como rsync o 'mirror', de manera
que no lo recomendamos para estas tareas.

<h3>Rsync anónimo</h3>

<p>Puede usar <a href="anonftpsync">este guión</a> para replicar el
archivo. Siga las instrucciones que contiene el guión para configurar
la réplica.

<h3>Rsync con autenticación, de un sitio `push'</h3>

<p>El replicado `push' es una forma de réplica que usa rsync que hemos
desarrollado para minimizar el tiempo que tardan en llegar los cambios en
el archivo hasta las réplicas. El servidor replicado utiliza un disparador
mediante ssh para indicarle al cliente replicador que debe actualizarse.

<p>El replicado `push' es necesario para mantener la sincronización de
múltiples servidores (como servidores de alias de DNS en round-robin como
<tt>ftp.us.debian.org</tt>), y lo usamos comúnmente para los primeros y
segundos niveles de nuestros sitios de réplica. Para los sitios de réplica
"normales", este método precisa mucho esfuerzo en la configuración, lo que
no compensa con respecto a una tarea del cron bien ajustada.</p>

<p>El método es bastante seguro ya que ssh se configura para ejecutar
sólo una orden. Además, el replicado sigue siendo `pull', de manera que
<strong>no</strong> es posible corromper el contenido del archivo mediante
un servidor `push' falso. Algunos administradores de réplicas han mostrado
cierta reluctancia a la hora de usar este método de replicado debido a que
temen que el método pueda abrir sus máquinas ante una invasión. Esto,
sencillamente, <strong>no</strong> es cierto.

<p>Si desea una descripción más detallada de cómo funciona esto, por qué
es seguro, y cómo configurar un servidor `push', por favor lea <a
href="push_mirroring">la explicación completa</a>.

<h3>FTP anónimo usando 'mirror'</h3>

<p>El FTP anónimo fue el método estándar de replicado durante mucho
tiempo. Por tanto, el programa 'mirror' funciona bien con el archivo de
Debian. Como posiblemente haya adivinad, 'mirror' está disponible como
paquete de Debian. Si ha instalado el paquete de Debian, hay un script de
ejemplo para replicar el archivo ftp en
/etc/mirror/packages/ftp.debian.org .


<toc-add-entry name="partial">Réplicas parciales</toc-add-entry>

<p>Considerando el <a href="size">gran tamaño actual del archivo de
Debian</a>, hay gente que prefiere replicar sólo las partes que necesita.
Si quiere excluir algo, debería excuir arquitecturas.</p>

<p>Con <a href="anonftpsync">anonftpsync</a>, puede hacer esto editando la
variable EXCLUDE. También puede usar scripts escritos específicamente, como
<a href="http://packages.debian.org/unstable/net/debmirror.html">debmirror</a>
(de Joey Hess and Joerg Wendland) o
<a href="http://people.debian.org/~absurd/absurd_debmirror/">absurd_debmirror</a>
(dy Stephan Suerken). Si cree que debería añadírseles algo, contacte por favor
con los autores (la información de contacto debería venir en los propios
scripts).

<p>Le aconsejamos encarecidamente que no excluya <tt>project</tt>,
<tt>doc</tt> ni otros subdirectorios. Normalmente, su tamaño es pequeño
y aún son útiles para los usuarios.</p>

<toc-add-entry name="when">Cuándo replicar</toc-add-entry>

<p>El archivo principal se actualiza cada 24 horas.

<p>Si su sitio está siendo replicado de forma `push', entonces no tiene
que preocuparse. En caso contrario, y si el sitio que ha escogido replicar
usa rsync, entonces debería echar un vistazo a <kbd>project/trace/</kbd>
en el archivo Debian de la réplica, en busca de un fichero que se llame
igual que el sitio. El fichero debería contener la hora en la que terminó
de hacerse la última réplica. Añada algo de tiempo, pongamos una hora o
así, al que obtenga, y haga la réplica entonces.

<p>La manera más sencilla de hacer que la réplica se ejecute diariamente
de forma automática es usar cron. Lea <kbd>man crontab</kbd> si desea más
detalles.

<toc-add-entry name="settings">Configuraciones adicionales recomendadas</toc-add-entry>

<p>Si va a dejar disponible mediante HTTP su réplica de Debian, añada por
favor estas opciones a la configuración de su Apache (presumiendo, por
supuesto, que use Apache) para los índices de los directorios:

<pre>
&lt;directory /org/ftp.debian.org/ftp&gt;
   IndexOptions NameWidth=* +SuppressDescription
   DirectoryIndex .
&lt;/directory&gt;
</pre>

<p>(cambie <code>/org/ftp.debian.org/ftp</code> por el nombre del
directorio en el que guarde la réplica)
