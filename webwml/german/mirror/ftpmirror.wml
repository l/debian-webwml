#use wml::debian::template title="Einen Debian-Archiv-Spiegel erstellen"
#use wml::debian::toc
#include "$(ENGLISHDIR)/releases/woody/release.data"
#use wml::debian::translation-check translation="1.38"
# $Id$
# Translator: Thimo Neubauer <thimo@debian.org>
# Updated by: Frank Lichtenheld <frank@lichtenheld.de>

<toc-display/>

<p>Wenn ein Spiegelserver installiert ist, sollte er <a
href="submit">bei Debian registriert</a> werden, damit er in die
<a href="list">Liste der Spiegel</a> aufgenommen
werden kann. Anmelden kann man sich über ein
<a href="submit">einfaches Web-Formular</a>.</p>

<p>Probleme und Anfragen können Sie an
<email mirrors@debian.org> schicken.</p>


<toc-add-entry name="what">Was Spiegeln</toc-add-entry>

<p>Die <a href="./">Haupt-Spiegelseite</a> listet alle zum Spiegeln
verfügbaren Archive auf.
<br />
Benutzer werden nach dem debian/-Archiv suchen um Debian über das
Netzwerk zu installieren, CDs zu erstellen (mit jigdo), und bereits
installierte Systeme zu aktualisieren. Diejenigen, die an den Paketen
interessiert sind, die in den USA nicht gespiegelt werden können,
werden nach debian-non-US/ suchen.
<br />
Das debian/-Archiv ist sehr groß, während das debian-non-US/-Archiv
vergleichsweise klein ist. Auf der
<a href="size">Spiegelgrößen</a>-Seite finden Sie präzisere 
Informationen.</p>

<p>Beachten Sie: Das debian-non-US-Archiv ist <strong>keine</strong>
Obermenge des debian/-Archivs, es ist ein optionaler Zusatz.</p>

<p>debian-cd/ ist ein Archiv, das auf den verschiedenen Spiegelservern
nicht identisch ist. Auf manchen Servern enthält es die
jigdo-Vorlagen, um CD-Images zu erstellen (mit Dateien aus debian/),
auf anderen enthält es fertige CD-Images, auf wieder anderen beides.
<br />
Bitte lesen Sie die Seite <a href="$(HOME)/CD/mirroring/">Spiegeln der
CD-Images</a> für weitere Informationen zu diesem Thema.</p>

<p>debian-archive/ enthält das eigentliche <em>Archiv</em>, die
alten und überholten Debian-Versionen. Es wird im allgemeinen nur
für einen kleinen Nutzerkreis von Interesse sein.</p>

<p>Das debian-security/-Archiv enthält Sicherheitsaktualisierungen,
die durch das Debian-Security-Team veröffentlicht werden. Es klingt
für jeden interessant, da aber Sicherheitsaktualisieren unregelmäßig
auftreten, müssen Sie Ihren Spiegel sehr oft aktualisieren, um
immer auf dem neuesten Stand zu sein (oder <a href="push_mirroring">\
Push-Spiegeln</a> benutzen), deshalb empfehlen wir nicht, es zu
spiegeln. Debian gibt sich alle Mühe, stattdessen die hohe 
Verfügbarkeit von security.debian.org sicherzustellen.</p>


<toc-add-entry name="wherefrom">Von wo Spiegeln</toc-add-entry>

<p>Viele Leute denken, dass <code>ftp.debian.org</code> die vorschriftsmäßige
Adresse von Debian-Paketen ist und da es für Sie am Besten ist, von dort zu
spiegeln. Das ist <strong>nicht wahr</strong>. <code>ftp.debian.org</code> ist
lediglich einer von mehreren Servern, die von einem internen Debian-Server
aktualisiert werden.</p>

<p>Jeder der Server in der <a href="list-full">vollständigen Liste aller
Spiegel</a>, der das '<kbd>Type: Push-Primary</kbd>'-Tag besitzt, sollte fürs
Spiegeln gut geeignet sein.</p>

<p>Es gibt keinen wirklichen Unterschied zwischen den verschiedenen 
<em>Push-Primary</em> Spiegeln, soweit es das Spiegeln betrifft. Auf der
anderen Seite, wenn viele Leute ftp.debian.org verwenden (und
unglücklicherweise tun Sie das), verschwendet das unnötigerweise die
gespendete Bandbreite.</p>


<toc-add-entry name="how">Wie man spiegelt</toc-add-entry>

<p>Die bevorzugte Methode zum Spiegeln ist mit
<a href="http://packages.debian.org/stable/net/rsync">rsync</a>.</p>

<p>Beachten Sie: Während <kbd>wget</kbd> für kleine Sites ganz gut
arbeitet, ist es nicht so gut konfigurierbar wie rsync, deshalb wird es
nicht für diese Aufgabe empfohlen.</p>

<p>Hier einige Ratschläge für jene, die andere Methoden bevorzugen:</p>

<ul>
  <li>Führen Sie rsync mit zumindest diesen Optionen aus: <kbd>--recursive
      --times --links --hard-links --delete</kbd>.</li>

  <li>Falls Sie zusätzlichen Plattenplatz haben, verwenden Sie auch die
      <kbd>--delete-after</kbd> Option, um einige der temporären
      Aktualisierungsprobleme zu vermeiden.</li>

  <li>Falls Sie nicht genügend Plattenplatz haben, um alles zu spiegeln,
      verwenden Sie die <kbd>--exclude</kbd> Option, um Teile des Archivs vom
      Spiegeln auszunehmen. Üblicherweise beinhaltet dies verschiedene
      Architekturen, die Sie nicht wollen; zum Beispiel würde dies
      <em>alle</em> Architekturen ausschließen:
<: 
print "<code>--exclude binary-$_/ --exclude *_$_.deb</code><br>\n"
  foreach (sort keys %arches);
:>
      Lesen Sie ebenfalls den <a href="#partial">Abschnitt über teilweises
      Spiegeln</a>.</li>

  <li>Nachdem rsync mit dem Spiegeln fertig ist, fügen Sie einen Zeitstempel
      im <code>project/trace/</code> Verzeichnis des Debian-Spiegels hinzu,
      der nach ihrem Server benannt ist. Das heißt, dass Sie
      <kbd>date -u &gt; .../debian/project/trace/<var>ihr.server</var></kbd>
      aufrufen sollen, nachdem ihr tägliches rsync beendet ist; und
      <kbd>date -u &gt; .../debian-non-US/project/trace/<var>ihr.server</var></kbd>
      nach dem das tägliche non-US beendet ist, falls Sie debian-non-US
      spiegeln.</li>
</ul>


<h3>Anonymes rsync</h3>

<p>Sie können <a href="anonftpsync">dieses Skript</a> benutzen,
um das Archiv zu spiegeln. Folgen Sie einfach den Anweisungen im
Skript, um den Spiegel zu erstellen.</p>


<h3>Rsync mit Authentifizierung, von einem Push-Spiegel</h3>

<p>Push-Spiegeln ist eine Art des Spiegelns mit rsync, die wir
entwickelt haben, um die Zeit zu minimieren, die es benötigt, bis
Änderungen im Archiv die Spiegel erreichen.   Der Server-Spiegel
benutzt einen SSH-Auslöser, um dem nachgeschalteten Spiegel
mitzuteilen, dass er sein Archiv aktualisieren soll.</p>

<p>Push-Spiegeln wird benötigt, um mehrere Server Synchron zu halten (wie die
Server in DNS round-robin-Aliasen wie <tt>ftp.us.debian.org</tt>), und wir
verwenden es gewöhnlich für unsere ersten und zweiten tier-Spiegel. Für
"normale" Spiegel benötigt diese Methode viel Aufwand, um es aufzusetzen, was
nicht viel Sinn hat gegenüber einem gut angepasstem cron-job.</p>

<p>Die Methode ist ziemlich sicher, da SSH so konfiguriert ist,
dass nur ein einziger Befehl ausgeführt wird.
Außerdem läuft das eigentliche Spiegeln immer noch
"ziehenderweise" ab, so dass es nicht möglich ist, den
Spiegel durch gefälschte Push-Spiegel zu beschädigen.</p>

<p>Einige Spiegel-Verwalter haben aus Angst, das System für
andere zu öffnen, eine gewisse Abneigung gegen diese
Spiegel-Methode gezeigt.  Das ist einfach <strong>nicht</strong> wahr.</p>

<p>Eine detaillierte Beschreibung, wie dieses funktioniert, warum es
sicher ist und wie man einen Push-Spiegel aufsetzt, finden Sie <a
href="push_mirroring">hier</a>.</p>


<h3>Anonymes FTP</h3>

<p>Anonymes FTP war lange Zeit die Standardmethode zum Spiegeln, aber es wurde
zugunsten von rsync abgelehnt.</p>

<p>Falls Sie aus einem zwingenden Grund rsync nicht verwenden können, könnte
das Programm "<a href="http://packages.debian.org/mirror">mirror</a>" nützlich
sein. Bedenken Sie, dass es von ls-lR-Dateien abhängig ist, was es davon
abhält, eine ordentliche Spiegel-Verfolgung im
<kbd>project/trace/</kbd>-Unterverzeichnis des Debian-Spiegels zu
betreuen.</p>


<toc-add-entry name="partial">Teilweises Spiegeln</toc-add-entry>

<p>Aufgrund des bereits <a href="size">großen Umfangs des Debian-Archivs</a>
bevorzugen einige Leute, nur die Teile zu spiegeln, die sie auch benötigen.
Wenn Sie etwas ausschließen wollen, sollten Sie Architekturen
ausschließen.</p>

<p>Mit <a href="anonftpsync">anonftpsync</a> kann dies durch das Editieren der
EXCLUDE Variable geschehen. Sie können auch speziell geschriebene Skripte
verwenden, wie zum Beispiel
<a href="http://packages.debian.org/unstable/net/debmirror">debmirror</a>
(von Joey Hess und Joerg Wendland). Wenn Sie der Meinung sind, dass zu
diesen etwas hinzugefügt werden sollte, kontaktieren Sie bitte die Autoren
(Kontaktinformationen sollten in den Skripten enthalten sein).</p>

<p>Wir empfehlen Ihnen dringenst, dass Sie die <tt>project/</tt>,
<tt>doc/</tt> und weiter Unterverzeichnisse inkludieren. Üblicherweise sind
diese nicht sehr groß und trotzdem für die Benutzer nützlich.</p>


<toc-add-entry name="when">Wann Spiegeln</toc-add-entry>

<p>Das Hauptarchiv wird alle 24 Stunden neu zusammengestellt.</p>

<p>Die Spiegel beginnen üblicherweise um 00:00 UTC herum zu aktualisieren,
aber das ist kein fixer Zeitpunkt.  Wir empfehlen es, täglich zu spiegeln,
einige Stunden danach; tatsächlich sollten Sie prüfen, ob die Site, von der
Sie spiegeln, eine Zeitstempel-Datei in ihrem <kbd>project/trace/</kbd>
Unterverzeichnis hinterlässt. Die Zeitstempel-Datei wird genauso wie die Site
benannt, und sie wird die Zeit der Beendigung der letzten
Spiegel-Aktualisierung enthalten. Fügen Sie ein paar Stunden zu dieser Zeit
hinzu (um sicher zu sein) und spiegeln Sie dann.</p>

<p>Die einfachste Art, um automatisch zu spiegeln, ist, den Prozess
täglich von cron aufrufen zu lassen. Weitere Informationen mit
<kbd>man crontab</kbd>.</p>

<p>Beachten Sie, falls ihre Site mit einem Push-Mechanismus angestoßen wird,
müssen Sie sich um all dies nicht kümmern.</p>


<toc-add-entry name="settings">Empfohlene zusätzliche
  Einstellungen</toc-add-entry>

<p>Wenn Sie planen, den Debian-Spiegel durch HTTP zur Verfügung zu
stellen, fügen Sie bitte die folgenden Einstellungen zur
Apache-Konfiguration (natürlich unter der Annahme, dass Sie Apache benutzen)
im <code>&lt;Directory <var>/pfad/zu/ihrem/debian/spiegel</var>&gt;</code>
Block hinzu, wobei <var>/pfad/zu/ihrem/debian/spiegel</var> der tatsächliche
Namen des Verzeichnisses sein sollte, indem sich ihr Spiegel befindet:</p>

<pre>
   Options +Indexes +SymlinksIfOwnerMatch
   IndexOptions NameWidth=* +SuppressDescription
   DirectoryIndex .
</pre>


<p>Dies erlaubt Verzeichnis-Indizes und stellt sicher, dass Symlink-Verfolgung
funktioniert. Die Datei-Namen in den Verzeichnis-Indizes werden nicht
abgeschnitten, und die (größtenteils nichtvorhandenen) Beschreibungen werden
nicht angezeigt.</p>
