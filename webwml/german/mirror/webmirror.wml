#use wml::debian::template title="Spiegel der Debian-Webseiten"
#use wml::debian::toc
#include "$(ENGLISHDIR)/mirror/webmirrors.data"
#use wml::debian::translation-check translation="1.47"
# $Id$
# Translator: Martin Schulze <joey@debian.org>

<toc-display />

<toc-add-entry name="whynot">Wieso wir keine weiteren Web-Spiegel
benötigen</toc-add-entry>

<p>Unsere Web-Spiegel-Server erfordern Wartung (etwas mehr als die
FTP-Spiegel, da die Konfigurationsdateien von Apache immer mal wieder
geändert werden müssen) und kosten die Sponsoren Ressourcen. Aufgrund
der Natur des Webs und bei Seiten, die nicht andauernd geladen werden
müssen und bei denen es nicht so wichtig ist, ob sie mit 2kbps oder
mit 20kbps ankommen, da sie sehr klein sind, stellt sich die Frage, ob
es sinnvoll ist, viele Spiegel-Server zu bieten.</p>

<p>Es gab Zeiten, da waren die Internet-Verbindungen auf der gesamten
Welt nicht schnell und zu www.debian.org von einem anderen Kontinent
zu gelangen war mühsam und langsam und erheblich langsamer als eine
normale Modemverbindung. Daher haben wir Spiegel organisiert und
mehrere Spiegel-Server wurden geboren. Zehn (oder elf, wenn Sie die
Türkei dazurechnen) dieser liegen in Europa.</p>

<p>Heutzutage haben wir jedoch verblüffend schnelle
Netzwerkverbindungen, speziell in Europa, daher besteht kaum ein
Bedarf an diesen vielen Spiegeln. In der Tat ist es aufgrund der
erhöhten Geschwindigkeit der Netzwerkverbindungen zwischen Europa und
Amerika nicht einmal langsam, von Europa auf www.debian.org zuzugreifen.</p>

<p>Das sind die Hauptgründe, wieso wir keine weiteren
Web-Spiegel-Server benötigen, speziell nicht auf Kontinenten, auf denen
Spiegel so gut verteilt sind. Bitte respektieren Sie unsere Wünsche.
Vielen Dank für Ihre Kooperation.</p>

<p>Wenn Sie irgendwelche Fragen haben, schreiben Sie uns eine E-Mail an
<a href="mailto:mirrors@debian.org">mirrors@debian.org</a>.</p>

<hrline />

<toc-add-entry name="ref">Referenz für existierende Spiegel</toc-add-entry>

<p><strong>Die untenstehenden Informationen werden nur als Referenz
für die Verwalter der bestehenden Spiegel-Server angeboten.</strong></p>

<h3>Spiegel-Prozess</h3>

<p>Die empfohlene Methode zu spiegeln ist mit rsync. Es gibt keinen
anonymen Zugriff zum Archiv der Webseiten. Sie können
authentifizierten Zugang mit dem Verwalter des Rechners ausmachen, von
dem Sie spiegeln möchten. Bitte wenden Sie sich per E-Mail an <a
href="mailto:mirrors@debian.org">mirrors@debian.org</a>.</p>

<p>Spiegeln ist ein <q>ziehender</q> Prozess, d.h. der Client fordert Daten
vom Server an. Um dies einzurichten, können Sie das
<a href="websync">websync-Skript</a> und <a href="websync.conf">seine
Konfiguration</a> nutzen, das aus der Crontab laufen gelassen werden kann
und das alles automatisch machen wird. Folgen Sie den Anweisungen in
dem Skript, um sicherzustellen, dass alles funktioniert.</p>

<h4>Spiegeln von einem Push-Spiegel</h4>

<p>Push-Spiegeln ist eine Art von Spiegeln mit rsync, das wir
entwickelt haben, um die Zeit zu minimieren, die benötigt wird, damit
Änderungen im Archiv die Spiegel erreicht. Der Server verwendet SSH,
um dem Client-Spiegel mitzuteilen, dass er sein Archiv aktualisieren soll.</p>

<p>Diese Methode ist ziemlich sicher, da SSH so konfiguriert ist,
dass nur ein einziger Befehl ausgeführt wird.
Außerdem läuft das eigentliche Spiegeln immer noch
<q>ziehenderweise</q> ab, so dass es <strong>nicht</strong> möglich ist, den
Spiegel durch gefälschte Push-Spiegel zu beschädigen.
Einige Spiegel-Verwalter haben aus Angst, das System für
andere zu öffnen, eine gewisse Abneigung gegen diese
Spiegel-Methode gezeigt. Das ist jedoch <strong>nicht</strong>
der Fall.</p>

<p>Eine ausführliche Beschreibung, wie dieses funktioniert, wieso es
sicher ist und wie man einen Push-Spiegel aufsetzt, finden Sie in der
<a href="push_mirroring">vollständigen Beschreibung</a>.</p>


<h3>Wann spiegeln</h3>

<p>Das Hauptarchiv wird annähernd alle vier Stunden aktualisiert.</p>

<p>Wenn Ihr Rechner push-gespiegelt wird, müssen Sie sich darüber
keine Gedanken machen. Falls doch nicht, sollten Sie die Spiegelzeit
für Ihren Rechner anhand des Datums der Timestamp-Dateien im
Verzeichnis <code>/mirror/timestamps/</code> auf dem
Web-Spiegel-Server. Fügen Sie etwas Zeit hinzu, z.B. eine halbe
Stunde, und spiegeln Sie dann.</p>

<p>Die einfachste Art, den Spiegel automatisch jeden Tag laufen zu
lassen, ist über cron. Lesen Sie <kbd>man crontab</kbd>, um mehr zu
erfahren.</p>


<h3>Bewerben des Sponsors für den Spiegel</h3>

<p>Falls Sie möchten, können Sie das Bild <code>sponsor_img.jpg</code> durch
   ein (unaufdringliches) Logo Ihrer Firma oder Organisation ersetzen und
   <code>sponsor.html</code> zu einer Umleitung auf Ihre Homepage einrichten.
   Standardmäßig werden beide Dateien nicht gespiegelt. Die Voreinstellungen
   heißen <code>sponsor.deb.html</code> und <code>sponsor.deb.jpg</code> &ndash;
   Sie können zwar die voreingestellten Dateien verwenden, wir empfehlen Ihnen
   aber, Ihre eigenes Bild bereitzustellen. Die
vorgeschlagene maximale Größe für Ihr Logo beträgt 120x60 Pixel.</p>

<p>Da <a href="#cn">Content-Negotiation</a> für die Webseiten
verwendet wird, um die bevorzugte Sprache zu ermitteln, können Sie
<code>sponsor.html</code> sogar in verschiedenen Sprachen anbieten.
Um das zu machen, erzeugen Sie einfach sponsor.&lt;sprache&gt;.html für
jede &lt;sprache&gt;, die Sie unterstützen möchten.</p>

<p>Stellen Sie sicher, dass Sie alle Dateien in die Ausschlussliste
(exclude) schreiben, die Sie beim Spiegeln nicht überschreiben
möchten.</p>


<h3>Konfigurieren des Webservers</h3>

<h4>Verschiedene Webserver-Änderungen</h4>

<p>Wenn auf Ihrer Maschine Debian läuft, wurde entschieden, gegen die
Debian-Policy zu verstoßen und <code>/doc</code> zu den Webseiten
hinzuzufügen. Daher sollten Sie die Zeile <q><code>Alias /doc/
/usr/share/doc/</code></q> aus der Datei <code>/etc/apache/srm.conf</code>
auskommentieren.</p>

<p>Bemerkung: Alle unsere CGI-Skripte laufen zentral auf
cgi.debian.org, so dass Sie sich darüber keine Gedanken machen müssen.</p>

<h4><a name="cn">Content-Negotiation</a></h4>

<p>Content-Negotiation ist eine Methode, die den Browser mit dem
Webserver die Art des Dokuments aushandeln lässt. Während es eine
Vielzahl Anwendungen für dieses gibt, ist die am weitesten verbreitete
die Aushandlung, in welcher Sprache ein Dokument zurückgegeben werden
soll. Damit erlaubt es Debian, die Webseiten in mehreren Sprachen auf
eine (technisch gesehen) sehr elegante Weise zurückzuliefern.</p>

<p>Für diejenigen, die Apache verwenden, sind die Änderungen fast
trivial. Fügen Sie einfach diese Option</p>

<pre>
Options +Multiviews
</pre>

<p>zu den <code>&lt;Directory&gt;</code>-Abschnitten für die
Debian-Webseiten in Ihrer Datei <kbd>/etc/apache/access.conf</kbd>
hinzu und starten Sie den Server neu.</p>

<p>Zusätzlich müssen Sie sicherstellen, dass der Server alle Sprachen
unterstützt, die von der Website unterstützt wird. Dieses wird mit
dem Tag <kbd>AddLanguage</kbd> erreicht. Das Folgende ist eine Liste
der Sprachen, die bereits unterstützt werden &ndash; erwarten Sie weitere:</p>

<pre>
  AddLanguage en .en
<:
foreach $l (keys %langs) { push @codes, $langs{$l}; }
foreach $c (sort @codes) { print "  AddLanguage $c .$c\n" if (($c ne "en")
&& ($c ne "zh")); }
:>  \
  AddLanguage pt-br .pt
  AddLanguage nb .nb
  AddLanguage zh-CN .zh-cn
  AddLanguage zh-HK .zh-hk
  AddLanguage zh-TW .zh-tw
</pre>

<p>Aufgrund eines Fehlers im Apache kann unter manchen Umständen die
falsche Sprache zurückgeliefert werden. Daher wäre es eine gute Idee,
jede Sprache zur Option <kbd>LanguagePriority</kbd> hinzuzufügen,
z.B. wie folgt:</p>

<pre>
<:
print "LanguagePriority en fr es ";
foreach $c (sort @codes) { print "$c " if (($c ne "en") && ($c ne "fr") && ($c ne "es") && ($c ne "zh")); }
print "pt-br nb zh-CN zh-HK zh-TW\n";
:>\
</pre>

<p>Um zu vermeiden, dass Dateien mit Content-Negotiation mit falschem
Zeichensatz zurückgeliefert werden, stellen Sie bitte sicher, dass die
Einstellung <code>AddDefaultCharSet</code> entweder auskommentiert
oder auf <q><code>Off</code></q> gesetzt ist.</p>

<p>Falls Sie Apache 1 verwenden, werden Sie wahrscheinlich den Eintrag
   <code>DirectoryIndex</code> in <code>/etc/apache/srm.conf</code> ändern 
   müssen, um Index-Dateien richtig zurückzuliefern. Dies funktioniert 
   allerdings nicht mit Apache 2. Das Folgende sollte für Apache 1 ausreichend
   sein:
</p>

<pre>
DirectoryIndex index index.html
</pre>

<p>Um den richtigen <q>Content-Type</q>-Header für favicon.ico zu senden, sollte
Apache angewiesen werden, den Typ <q>image/x-icon</q> zu verwenden, so wie
hier:</p>

<pre>
AddType image/x-icon .ico
</pre>

<p>Um den richtigen <q>Content-Type</q>-Header für RSS-Einspeisungen zu senden,
sollte Apache angewiesen werden, den Typ <q>application/rss+xml</q> zu
verwenden, so wie hier:</p>

<pre>
AddType application/rss+xml .rdf
</pre>

<p>Um den richtigen <q>Content-Type</q>-Header für die spanischen
Übersetzungen der HTML-, PDF- und Textdateien zu senden, sollte
Apache angewiesen werden, die richtigen Typen zu verwenden, so wie hier:</p>

<pre>
&lt;Files *.html.es>
  ForceType text/html
&lt;/Files>

&lt;Files *.pdf.es>
  ForceType application/pdf
&lt;/Files>

&lt;Files *.txt.es>
  ForceType text/plain
&lt;/Files>
</pre>

<p>Um Probleme mit der Inhaltsaushandlung mit dem Inhalt unter <a
   href="../events/">/events</a> zu vermeiden, müssen Kalender-Dateien eine
   niedrigere Priorität als text/html-Inhalten zugewiesen werden:</p>

<pre>
AddType text/calendar;qs=0.9 .ics
</pre>

<h4>Umleitungen</h4>

<p>Da einige Teile der Website anfingen zu groß zu werden, um von den
meisten Rechnern gespiegelt zu werden, haben wir sie von der
Hauptseite getrennt. Obwohl die meisten Links auf die neuen Adressen
konvertiert sein sollten, bitten wir Sie, eine Umleitung auf einen
anderen Rechner einzufügen, damit keine kaputten Links entstehen.
Dieses wird durch folgenden Eintrag in <kbd>/etc/apache/srm.conf</kbd>
erledigt:</p>

<pre>
Redirect /Lists-Archives http://lists.debian.org/
Redirect /search http://search.debian.org
Redirect /Packages http://packages.debian.org
Redirect /lintian http://lintian.debian.org
</pre>

<h4>Virtuelle Hosts</h4>

<p>Die Debian-Website verwendet eine GeoDNS-Einrichtung, wenn sie unter
<a href="$(HOME)">www.debian.org</a> und verschiedenen anderen
Namen aufgerufen wird. Dadurch kann die Last verteilt und ein Spiegel
ausgewählt werden, der sich in der Nähe des Benutzers befindet.</p>

<p>Daher sollte Apache die Debian-Website über verschiedene virtuelle
Hosts erreichbar machen, so wie hier:</p>

<pre>ServerAlias www.debian.org www.debian.com debian.org www.*.debian.org</pre>
