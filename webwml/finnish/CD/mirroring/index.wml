#use wml::debian::cdimage title="Debian CD-peilipalvelimen perustaminen" BARETITLE=true
#use wml::debian::toc
#use wml::debian::translation-check translation="1.11"

<p>Perustaaksesi Debian CD-vedoksia peilaavan palvelimen, tarvitset
Linux- tai Unix-tyyppisen koneen, jossa on pysyv‰, luotettava
Internet-yhteys. Debianin CD-peileill‰ pidet‰‰n <tt>.iso</tt>-vedoksia
erikokoisille CD- ja DVD-levyille, tiedostoja <a
href="http://atterer.net/jigdo/">jigdo</a>:lle (<tt>.jigdo</tt> ja
<tt>.template</tt>), <a
href="http://bitconjurer.org/BitTorrent/">BitTorrent</a>-tiedostoja
(<tt>.torrent</tt>) sek‰ MD5-tarkistussummia vedoksista
(<tt>MD5SUMS*</tt>).</p>

<toc-display/>

<hr>
#______________________________________________________________________

<toc-add-entry name="httpftp">Juuripalvelin</toc-add-entry>

<p>Peilattavia sijainteja on kaksi, yksi vakaille vedoksille ja yksi
beta/ep‰vakaa/testattava-vedoksille. Juuripalvelimen URL-osoitteet ovat
alla - <strong>ole hyv‰</strong> ja harkitse peilaamista l‰heisemm‰lt‰
peililt‰ (peililuettelot: <a href="../http-ftp/">HTTP/FTP</a>, <a
href="rsync-mirrors">rsync</a>) mik‰li mahdollista. P‰‰sy‰
juuripalvelimeen saatetaan rajoittaa julkaisun aikaan.</p>

<p>Huomaa, ett‰ n‰ihin hakemistoihin on tallennettuna <strong>valtava</strong> 
m‰‰r‰ dataa - lue <a href="#exclude">kappaleesta alempaa</a> kuinka rajoitat 
kokoa ohittamalla tietyt tiedostot.</p>

<ul>

  <li>Vakaan vedokset (p‰ivitet‰‰n jokaiselle vakaalle julkaisulle):<br>

    <a href="http://cdimage.debian.org/debian-cd/"
    ><tt>http://cdimage.debian.org/debian-cd/</tt></a><br>

    <a href="ftp://cdimage.debian.org/debian-cd/"
    ><tt>ftp://cdimage.debian.org/debian-cd/</tt></a><br>

    <tt>rsync://cdimage.debian.org/debian-cd/</tt>

  </li>

  <li>Beta/ep‰vakaa/testattavan vedokset (useimmat osat p‰ivitet‰‰n viikottain):<br>

    <a href="http://cdimage.debian.org/pub/cdimage-testing/"
    ><tt>http://cdimage.debian.org/pub/cdimage-testing/</tt></a><br>

    <a href="ftp://cdimage.debian.org/pub/cdimage-testing/"
    ><tt>ftp://cdimage.debian.org/pub/cdimage-testing/</tt></a><br>

    <tt>rsync://cdimage.debian.org/cdimage-testing/</tt>

  </li>

</ul>
#______________________________________________________________________

<toc-add-entry name="httpftp">Peilaamista HTTP/FTP:ll‰ ei suositella</toc-add-entry>

<p>Peilien p‰ivitt‰miseen ei kannata k‰ytt‰‰ FTP:t‰ tai HTTP:t‰. N‰ill‰
siirtomenetelmill‰ on suuri virhetodenn‰kˆisyys tiedostojen valtavan
koon vuoksi.</p>

<p>Lis‰ksi HTTP ja FTP eiv‰t sis‰ll‰ eheystarkistuksia imuroiduille
tiedostoille, ja on todenn‰kˆisemp‰‰, ett‰ keskeytetyt imuroinnit tai
datan rikkoontumista ei huomata.</p>
#______________________________________________________________________

<toc-add-entry name="rsync">Peilaaminen rsyncill‰ on hyv‰ksytt‰v‰‰</toc-add-entry>

<p><a href="http://rsync.samba.org/"><kbd>rsync</kbd></a>-ohjelma on
hyv‰ ratkaisu peilaamiseen. Se ei ole yht‰ tehokas kuin toinen,
Debian-riippuvainen peilausratkaisu alla, mutta on helpompi pystytt‰‰.
Lis‰ksi se varmistaa, ett‰ kaikki tiedostot siirtyv‰t oikein ja ett‰
metatieto (esim. aikaleimat) pidet‰‰n myˆs synkronisoituina samoin
kuin tiedostojen sis‰ltˆ.</p>

<p>Katso kappaleesta <a href="#exclude">Tiedostojen ohittaminen
peilatessa</a> esimerkkej‰ <kbd>--include</kbd>- ja
<kbd>--exclude</kbd>-valitsimista. <a
href="rsync-mirrors">Rsync-peilien luettelo</a> on erillisell‰
sivulla.</p>

<p>K‰yt‰ v‰hint‰‰n valitsimia <b><tt>--times --links --hard-links --partial
--block-size=8192</tt></b>.  T‰m‰ s‰ilytt‰‰ muutosajan, symboliset ja
kovat linkit ja k‰ytt‰‰ 8192 bitin lohkokokoa (tehokkain
CD-vedoksille).  Kun muutosajassa ja koossa ei ole eroja,
<tt>rsync</tt> ei koske tiedostoon, joten <kbd>--times</kbd> on
todellakin pakollinen.</p>
#______________________________________________________________________

<toc-add-entry name="jigdolite">Peilaamista jigdo-litell‰ ei suositella</toc-add-entry>

<p>Tuoreet versiot <a
href="http://atterer.net/jigdo/"><kbd>jigdo-lite</kbd></a>-ohjelmasta
tukevat useiden vedoksien rinnakkaisimurointia. Emme kuitenkaan
suosittele <kbd>jigdo-lite</kbd>n k‰ytt‰mist‰ Debianin CD-peilien
luomiseen, k‰yt‰ <kbd>jigdo-mirror</kbd>ia sen sijaaan.</p>
#______________________________________________________________________

<toc-add-entry name="jigdomirror">Peilaamista jigdo-mirrorilla suositellaan</toc-add-entry>

<p>T‰m‰ siis tarkoittaa: Peilaa <tt>.iso</tt>-tiedostot <a
href="http://atterer.net/jigdo/"><kbd>jigdo-mirror</kbd></a>ia
k‰ytt‰en, sitten (jos haluat peilata myˆs muun tyyppisi‰ tiedostoja,
esim. <tt>.jigdo</tt>- ja <tt>.template</tt>-tiedostoja) aja rsync
hakemiston yli noutaaksesi loput. <a
href="http://www.acc.umu.se/~maswan/debian-push/cdimage/">T‰m‰n sivun skriptit</a> 
saattavat olla avuksi peilin pystytt‰misess‰.</p>

<p>Monet ihmiset yll‰pit‰v‰t "tavallisia" Debian-peilej‰
(<kbd>debian/</kbd>) tai heill‰ on sellainen l‰histˆll‰.  T‰m‰
tarkoittaa, ett‰ heill‰ on jo <kbd>.deb</kbd>it, jotka sis‰ltyv‰t CD-vedoksiin.
Miksip‰ emme k‰ytt‰isi siis noita samoja tiedostoja CD-vedoksissa?</p>

<p><kbd>jigdo-mirror</kbd> on ohjelma, jolla jokainen voi luoda
Debian-CD-vedokset k‰ytt‰en tiedostoja "tavalliselta" peililt‰ sek‰
muutamaa ylim‰‰r‰ist‰ jigdo-mallitiedostoa.</p>

<p>Ensiksi tarvitset jigdo-mallitiedostot.  N‰m‰ lˆyd‰t useimmista
virallisista paikoista, mutta kaksi ensisijaista paikkaa ovat:</p>

<ul compact>
  <li><kbd>rsync us.cdimage.debian.org::jigdo-area/</kbd> (Yhdysvaltain peili)
  <li><kbd>rsync non-us.cdimage.debian.org::debian-jigdo/</kbd> (Euroopan peili)
</ul>

<p>Hae tiedostot
&lt;<var>versio</var>&gt;/jigdo/&lt;<var>arkkitehtuuri</var>&gt;\
-alihakemistosta jokaiselle arkkitehtuurille, joille haluat vedokset
luoda.</p>

<p>Luo <kbd>~/.jigdo-mirror</kbd>-tiedosto s‰‰t‰‰ksesi ohjelman.  T‰m‰
on esimerkki:</p>

<pre>
jigdoDir="/miss‰/pid‰t/peilej‰si/debian-cd/current/jigdo"
imageDir="/miss‰/pid‰t/peilej‰si/debian-cd/current/images"
tmpDir="/miss‰/pid‰t/peilej‰si/debian-cd/current/images"
debianMirror="file:/miss‰/pid‰t/peilej‰si/debian"
nonusMirror="file:/miss‰/pid‰t/peilej‰si/debian-non-US"
include='i386/|sparc/|powerpc/|source/'; exclude='-1\.'
</pre>

<p><i>include</i>- ja <i>exclude</i>-muuttujat sis‰lt‰v‰t listan
arkkitehtuureista, joille haluat luoda vedokset (tai siis s‰‰nnˆlliset
lausekkeet).  Lis‰tietoja lˆyd‰t <kbd>jigdo-mirror</kbd>:n
manuaalisivulta tai itse l‰hdekoodista.  (Se on komentotulkin skripti,
jossa on paljon kommentteja).</p>

<p>Kun olet s‰‰t‰nyt sen, yksinkertaisesti aja <kbd>jigdo-mirror</kbd>
ja se tekee kaiken itse.  Se tulostaa paljon asioita ja kest‰‰
hetkisen, joten suosittelemme ottamaan sen huomioon (aja esimerkiksi
screeniss‰, ohjaa tuloste tiedostoon, jne).</p>
#______________________________________________________________________

<toc-add-entry name="pushmirror">Kuinka tulla tyˆnt‰v‰ksi peiliksi</toc-add-entry>

<p>Kun uudet vedokset ovat saatavilla, juuripalvelin voi l‰hett‰‰
viestin peileilleen ja saada ne aloittamaan p‰ivitys v‰littˆm‰sti.
T‰ll‰ tavoin uusi sis‰ltˆ "tyˆnnet‰‰n" pikemminkin kuin "vedet‰‰n"
peilien seuraavan p‰ivitt‰isen p‰ivityksen aikana. T‰m‰ johtaa
nopeampaan uusien vedoksien levi‰miseen.</p>

<p>Jos haluat peilisi olevan osa t‰t‰ p‰ivitysj‰rjestelm‰‰, katso <a href="http://www.acc.umu.se/~maswan/debian-push/cdimage/"
>t‰t‰ sivua</a>.</p>
#______________________________________________________________________

<toc-add-entry name="exclude">Tiedostojen ohittaminen
peilatessa</toc-add-entry>

<p>V‰hent‰‰ksesi Debianin CD-peilisi tilavaatimuksia, voit j‰tt‰‰
tietyt tiedostot peilaamatta. Seuraavat ohjeet sis‰lt‰v‰t
komentorivivalitsimet <kbd>rsync</kbd>ille, mutta voivat auttaa myˆs
muillakin tyˆkaluilla peilattaessa. <kbd>rsync</kbd>ill‰,
<kbd>--include</kbd>- ja <kbd>--exclude</kbd>-valitsimia k‰sitell‰‰n
esiintymisj‰rjestyksess‰, ja ensimm‰inen valitsin, jonka tiedostohahmo
t‰sm‰‰, p‰‰tt‰‰ ohitetaanko vai sis‰llytet‰‰nkˆ tiedosto.</p>

<ul>

  <li><strong>Ohita l‰hdekoodit:</strong>
  <kbd>--exclude=source/</kbd><br>

  T‰m‰ est‰‰ l‰hdekoodit sis‰lt‰vien vedoksien peilautumisen. Huomaa,
  ett‰ joidenkin mielest‰ ei ole soveliasta tarjota GPL-lisensoituijen
  ohjelmien bin‰‰reit‰ tarjoamatta samalla ohjelmien l‰hdekoodeja
  <em>samalla palvelimella</em>.</li>

  <li><strong>Ohita t‰ydet vedokset:</strong>
  <kbd>--include='*businesscard*.iso' --include='*netinst*.iso'
  --exclude='*.iso'</kbd><br>

  Ohittaa kaikki t‰ydet CD/DVD-vedossarjat kaikista arkkitehtuureista,
  <em>mutta</em> peilaa k‰yntikorttikokoiset ja net-install-
  <tt>.iso</tt>-vedokset. Suosittelemme aina peilaamaan n‰m‰ pienet vedokset:
  Suhteessa niiden kokoon ne ovat eritt‰in hyˆdyllisi‰!</li>

  <li><strong>Ohita t‰ydet vedokset ei-i386-arkkitehtuureille:</strong>
  <kbd>--include='*businesscard*.iso' --include='*netinst*.iso'
  --include='i386/**.iso' --exclude='*.iso'</kbd><br>

  Kuten yll‰, mutta <em>sis‰lt‰‰</em> kaikki CD/DVD-vedokset
  i386-arkkitehtuurille.</li>

  <li><strong>Ohita t‰ydet vedokset paitsi i386:lle CDt 1-3:</strong>
  <kbd>--include='*netinst*.iso' --include='i386/**-[1-3].iso'
  --exclude='*.iso'</kbd><br>

  T‰ysi sarja i386-vedoksia voi edelleen vied‰ liian paljon tilaa, jos se 
	sis‰lt‰‰ DVD- ja kaksipuoli-DVD-vedokset. T‰m‰ ohittaa kaikki 
	<tt>.iso</tt>-vedokset paitsi net-install-vedokset ja kolmen ensimm‰isen 
	i386-CD:n vedokset.</li>

  <li><strong>Ohita kaikki arkkitehtuurit paitsi i386:</strong>
  <kbd>--exclude=alpha/ --exclude=arm/ --exclude=hppa/ --exclude=hurd/
  --exclude=ia64/ --exclude=m68k/ --exclude=mips/ --exclude=mipsel/
  --exclude=powerpc/ --exclude=s390/ --exclude=sh/
  --exclude=sparc/</kbd><br>

  Sis‰llytt‰‰ vain t‰yden kokoelman tiedostoja i386:lle, mutta ei sis‰llyt‰ 
	mit‰‰n <tt>.jigdo</tt>-, <tt>.iso</tt>- jne. tiedostoja millek‰‰n muulle 
	arkkitehtuurille.</li>

</ul>
#______________________________________________________________________

<toc-add-entry name="names">Nime‰misk‰yt‰ntˆ ja tilavaatimukset <tt>.iso</tt>-vedoksille</toc-add-entry>

<p>Eri versiot <tt>.iso</tt>-vedoksista erotetaan nimien perusteella,
jolloin voit rajoittaa mink‰ tyyppisi‰ vedoksia peilaat:</p>

<ul>

  <li><strong><tt>*-businesscard.iso</tt></strong>: Yksi vedos jokaiselle
  <a href="/ports/#released">tuetulle arkkitehtuurille</a>,
  50&nbsp;Mt</li>

  <li><strong><tt>*-netinst.iso</tt></strong>: Yksi vedos joka
  arkkitehtuurille, 110&nbsp;Mt</li>

  <li><strong><tt>*-dvd.iso</tt></strong> (yksipuoliset DVDt):
  Useita vedoksia vain i386:lle, jokainen korkeintaan 4482&nbsp;Mt kooltaan.
  Sargelle i386-vedoksien yhteiskoko on noin 9000&nbsp;Mt.</li>

  <li><strong><tt>*-dldvd.iso</tt></strong> (kaksipuoliset DVDt): Kuten yll‰,
  mutta yksitt‰iset vedokset voivat olla 8106&nbsp;Mt kokoisia.
  Sargelle ei <tt>.iso</tt>-vedoksia ole saatavilla, vain
  jigdo-tiedostot.</li>

  <li><strong><tt>*.iso</tt></strong>: Kaikki j‰ljelle j‰‰neet
  <tt>.iso</tt>-tiedostot, jotka eiv‰t t‰sm‰‰ yll‰oleviin, ovat CD-vedoksia.
  Jokaiselle arkkitehtuurille on useita vedoksia, jokainen kooltaan
  korkeintaan 650&nbsp;Mt. Yhteiskoko kaikille vedoksille ja kaikille
  arkkitehtuureille on <a href="/mirror/size">t‰ydellisen Debian-peilin
  koko</a> (100&nbsp;Gt t‰t‰ kirjoitettaessa).</li>

</ul>
#______________________________________________________________________

<toc-add-entry name="register">Peilin rekisterˆiminen</toc-add-entry>

<p>Tehd‰ksesi CD-vedospeilisi hyˆdylliseksi laajalla yleisˆlle, voit
rekisterˆid‰ sen peililistallemme kuten <a
href="../http-ftp/">t‰m‰</a> tai <a href="rsync-mirrors">t‰m‰</a>.
Koska kuitenkin t‰ydet vedokset ovat suuria tiedostoja, voi t‰m‰
aiheuttaa usean gigatavun liikenteen p‰iv‰ss‰.</p>

<p>Voit rekisterˆid‰ peilisi joko t‰ytt‰m‰ll‰ <a
href="$(HOME)/mirror/submit">peili-ilmoituslomakkeen</a> (huomaa, ett‰
CDImage-*-kent‰t ovat t‰rkeimm‰t) tai l‰hett‰m‰ll‰ s‰hkˆpostia
(englanniksi) osoitteeseen <a
href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;debian-cd&#64;lists.debian.org">\
debian-cd&#64;lists.debian.org</a>.</p>

<p>Arvostamme kaikkia uusia CD-vedospeilej‰.  Kiitos etuk‰teen!</p>
