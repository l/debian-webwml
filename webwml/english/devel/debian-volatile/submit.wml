#use wml::debian::template title="Submit Volatile Mirror Information"

<p>If you would like to submit information about a mirror of Debian Volatile
(FTP archive, web), you can do so using the form below.

<p>There are <a href="#examples">examples</a> at the bottom of the page in
case you aren't sure how to proceed.

<p>If you need to submit changes to your existing entry, simply make
a new (complete) submission and add a comment stating it is an update.

<p>Not all information provided will be displayed in the mirror list, such
as the mirror maintainer address.
The email address will be saved somewhere on our sites,
so that mirror list editors can contact you with news and bug reports.

<p>Please note that an official mirror must use rsync as the method to
get current packages. We strongly recommend to use our 
<a href="http://volatile.debian.net/mirror-volatile.sh">mirror-volatile.sh</a> script.</p>

<p>To get listed, you need to respect the following criteria:</p>
<ul>
  <li>You need to mirror the complete debian-volatile archive.</li>
  <li>You need to mirror debian-volatile at least once a day </li>
  <li>You need to put 'date -u' into /project/trace/$YOURHOSTNAME</li>
  <li>You need to have an e-mail adress one can write to. <b>Entries will
  be removed, if we won't be able to contact you.</b></li>
</ul>
<p>We differentiate between push mirrors and normal mirrors.</p>

<h2>What is a "Push" Mirror?</h2>
<p>In brief it is a normal mirror, with the only difference that
volatile.debian.net tells you when something has changed in the
archive. So there is no need to try a sync periodically, your are
notified when the archive changes.
A good page describing it, and some parts of the setup, is
<a href="http://www.debian.org/mirror/push_mirroring.en.html">available
on the debian.org servers</a>. Please read it if you are not familiar
with it.</p>

<p>You are free to use any script you want, but please be sure to
use a safe one. We do NOT accept mirrors that use debmirror or similar tools
to mirror. These tools are fine for a private mirror, but not usable for full
mirrors, as they exclude many of the useful files. This basically means: keep
a full working mirror the whole time. The following options to rsync
(besides what you normally have) do the trick:</p>

<hr>

<table>
<tr>
 <th>Run</th>

 <th>Options</th>
 <th>Affects</th>
</tr>
<tr>
<td>1</td>
<td>--exclude Packages* --exclude Sources* --exclude Release*</td>

<td>You download new binary files, sources and Packages, but not the metadata
for them that <code>apt-get</code> uses. Also note that no delete option is
given.</td>

</tr>
<tr>
<td>2</td>
<td>--delete --delete-after</td>
<td>The second run now fetches the files excluded in the first run and also
deleted all files not any longer in the archive.</td>
</tr>
</table>

<hr>

<p>
This two-way mirror approach makes sure that users with their apt-get can
always fetch the files that are announced to be there (via the Packages files),
even when your mirror is updating itself at the moment they try to download
stuff.  You are free to use any other option to rsync you may like, but we
strongly suggest to use at least -lH.</p>

<p>Now you need to add <a
href="http://volatile.debian.net/id_mirrorpush.pub">this ssh key</a> to the mirror-user's
.ssh/authorized_keys file.  If you look into the key you see that it is limited
to only one command.  This means that we are NOT able to log on to your system
with this key. There is no way for us to do anything other to your
system then to just trigger the mirror - so the only harm we can do
would be to trigger your mirror every few seconds, but for that the
script we provide as an example uses a lockfile to avoid multiple
runs at the same time.  <b>You need to change that to whatever
script you use, but do NOT delete the &amp; at the end.</b> </p>

<h2>Traffic and Space Considerations</h2>
<h3>Traffic</h3>
<p>
Maybe you want to know what traffic you will get - or how much disk space you
need.  The bandwith usage depends on the
users, how they use it and what mirrors they choose. We have a
currently about 20GB a month on volatile.debian.net. Some mirrors might have
more, some less traffic.
</p>

<h3>Space</h3>

<p>
At the moment our archive takes about 200MB of space. As we add packages from
time to time expect the archive to grow.
</p>

<h2>Recommended additional settings</h2>

<p>If you are going to make the Debian mirror available through HTTP, please
add the following settings to your Apache configuration (presuming, of course,
you will use Apache), where /path/to/your/debian/mirror should be the actual
name of the directory where you keep the mirror:</p>

<pre>
   ReadmeName /path/to/your/debian/mirror/README

   &lt;Directory /path/to/your/debian/mirror&gt;
      Options +Indexes +SymlinksIfOwnerMatch
      IndexOptions NameWidth=*
      ReadmeName README.txt
   &lt;/Directory&gt;
</pre>			   

<p>This enables the directory indices and makes sure and that following
symlinks will work. Also file names in the directory indices won't be
truncated.</p>

<h2>Getting the push</h2> 

<p> As soon as you finished setting it up you are ready to be added to the list
of "pushed" servers.  For that please use the form in the following section.
</p>

<H2>Basic information</H2>

<P>Please, include the name under which you wish the mirror to be listed in
the <em>Site</em> field. If the server has other names, list them in the
<em>Alias</em> field, separated with commas (`,'). This is probably the
reverse of the DNS entries.

<form method=post action="http://cgi.ftbfs.de/submit_mirror.cgi">
<p>
Site: <input type="text" name="site" size="30"><br>
Alias: <input type="text" name="aliases" size="60">

<H2>Types of mirrors and methods of accessing them</H2>

<p>Enter the paths to the Volatile mirror on your site in the fields below.
Leave non-relevant fields blank.

<define-tag tablerow>
	<tr><td>%0: </td><td><input type="text" name="%1" size="%2"></td></tr>
</define-tag>

<table>
<tablerow "Packages archive, over HTTP"   archive-http   30>
<tablerow "Packages archive, over FTP"    archive-ftp    30>
<tablerow "Packages archive, over rsync"  archive-rsync  30>
</table>

<H2>Information about the mirror site</H2>

<p>Please fill in all of the following (we will not disclose the name and
e-mail to anyone). The country and mirror origin are important since we use
that to organize the entries.

<table>
<tablerow "Mirror is updated from"          mirrors_from  30>
<tablerow "Name of site maintainer"         maint_name    30>
<tablerow "Email of site maintainer"        maint_email   30>
<tr><td>Country of site:  <td><select name="country">
#include "$(ENGLISHDIR)/mirror/countries.data"
<: country_list() :>
</select>
<tablerow "Location of site (optional)"     location      30>
<tablerow "Name of site sponsor (optional)" sponsor_name  30>
<tablerow "URL of site sponsor (optional)"  sponsor_url   30>
</table>

<table><tr>
<td valign="top">Comment:</td>
<td><textarea name="comment" cols=40 rows=7></textarea></td>
</tr></table>

<p>Note: if there is more than one sponsor, add the others in the comment.
You may also want to note if a mirror is partial, how often does it get
updated, and how fast the site is (its maximum bandwidth).
Alternative access methods (NFS, IPv6, ...) are also suitable there.
<br>

<input type="submit" value="Submit"> <input type="reset" value="Clear form">
</p>
</form>

<p>Your site will appear on the list within a week. We might email you in
case of any problems with the submitted entry.


<H2><a name="examples">Examples</a></H2>

<p>The following submission would be for a server called debian.example.com,
which can also be reached using e1.example.com. These names are fictional,
of course.

<blockquote>
<p>
Site: <code>debian.example.com</code><br>
Alias: <code>e1.example.com</code>
</p>
</blockquote>

<p>Volatile archive mirror is in the /debian-volatile/ directory on the web server:

<blockquote>
<p>
Packages archive, over HTTP: <code>/debian-volatile/</code>
</p>
</blockquote>

<p>This is for ftp://debian.example.com/debian-volatile/:
     
<blockquote>
<p>
Packages archive, over FTP: <code>/debian-volatile/</code>
</p>
</blockquote>

<p>This is the directory used for rsync access, debian.example.com::debian-volatile/:

<blockquote>
<p>
Packages archive, over rsync: <code>debian-volatile/</code>
</p>
</blockquote>

<p>This mirror gets refreshed from ftp.de.debian.org, so we'll add:

<blockquote>
<p>
Mirror is updated from: <code>ftp.de.debian.org</code>
</p>
</blockquote>

<p>Now for the maintainer information:

<blockquote>
<p>
Name of site maintainer: <code>John Doe</code><br>
Email of site maintainer: <code>address.goes@here.example.com</code>
</p>
</blockquote>

<p>(Once again, the maintainer address will not be shown on the public lists,
but on sites used by mirror list editors.
Please enter a correct address.)

<p>The other information would be:

<blockquote>
<p>
Country: <code>United States [US]</code><br>
Comment: <code>Any notes you feel would help others</code>
</p>
</blockquote>

<p>The following example would describe the mirror at ftp.uk.debian.org:

<blockquote>
<p>
Site: <code>ftp.uk.debian.org</code><br>
Alias: <code>open.hands.com</code><br>
Packages archive, over HTTP: <code>/debian-volatile/</code><br>
Packages archive, over FTP: <code>/debian-volatile/</code><br>
Packages archive, over rsync: <code>debian-volatile/</code><br>
Name of site maintainer: <code>Philip Hands</code><br>
Email of site maintainer: <code>abc@address.goes.here</code><br>
Country: <code>United Kingdom [GB]</code>
</p>
</blockquote>

