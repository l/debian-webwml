#!wml -o ../../../debian.org/devel/%BASE.html.en
#use wml::debian::template title="Debian GNU/Linux - Mirroring"

<H1>Mirroring</H1>

<P>The world is a big place and without the large number of
mirrors around the world many people would have
difficulty acquiring Debian.

<P>Of course, that means that we need people to create and maintain
these mirrors. That means you. If you are in a position to donate some disk
space and connectivity to making Debian more accessible, then this
page is for you.

<P>Debian has both ftp archives and web sites. The ftp archive contains
all the packages, source and installation material. The web site
contains background information on Debian, documentation, material for
developers and links to related sites. You can choose to mirror 
the web, ftp or both. You can even keep the mirror private, but most
people choose to add ftp sites to the <A HREF="../misc/README.mirrors">mirror list</A>.

<H2>Official Mirrors</H2>
<P>In addition, you can choose to become an official Debian site.
Official sites get an address of the form ftp.&lt;country&gt;.debian.org
or www.&lt;country&gt;.debian.org. These are the best advertised and
most used sites; the face of Debian for most people. Because of this
we have certain minimum requirements for official sites:

<UL>
<LI>The site must be reliable and be up 24 hours a day. The machine must
   not be heavily loaded.
<LI>It must have a decent connectivity (relative to the respective country).
   Bandwidth equivalent to a T1 connection is preferred.
<LI>For ftp: the debian ftp hierarchy must be available under /debian
   This is done for consistency between sites.
<LI>For ftp: we are asking that all new official ftp sites also make the ftp archive
   available using http. With http/1.1 transfers have the potential of being
   more efficient than with ftp so we are trying to make a move in that direction.
   Of course, we would appreciate it if all mirrors allowed http access.
<LI>For www: a real virtual server with its own IP address. If possible
            the list and bug archives should be mirrored too (see the notes on
            mirroring below).
<LI>For www: cgi scripts are run centrally on cgi.debian.org so you don't
   need to worry about them.
<LI>For www: content negotiation must be enabled. This is to allow us to serve
   the web pages in multiple languages transparently (for those who have set up
   their browser properly). Apache supports this quite well. If you have questions
   about this please send mail to
   <A HREF="mailto:webmaster@debian.org">webmaster@debian.org</A>
<LI>Disk space commitments (with room for expansion):
            1+GB for www (includes list and bug archives),
            3+GB for ftp
<LI>The mirror must be updated at least once a day. If possible, mirror the
    bug archives more frequently.
</UL>
Please note that these are really just guidelines. If you are unsure of something,
send a note to <A HREF="mailto:webmaster@debian.org">webmaster@debian.org</A>
with your questions.

<P>If you would like to become an official mirror, send the name and
address of the machine along with the name and e-mail of the person
who will be maintaining the mirror to
<A HREF="mailto:webmaster@debian.org">webmaster@debian.org</A>. The webmaster
will get the DNS set up, and if an ftp site added to the list of mirrors.
When everything is working, your site will be added to the web pages.

<P>Currently only one official site per country is being set up. If your
country already has one, you can still set up an unofficial mirror. 
Debian is still looking for official mirrors in South America and Africa
(long term goals include Antarctica and a mirror in space. Don't laugh,
we've already run experiments on the space shuttle).

<H2>Mirroring</H2>
Mirroring is the same for both official and unofficial sites.
For ftp sites simply mirror
<A HREF="ftp://debian.crosslink.net/pub/debian">ftp://debian.crosslink.net/pub/debian</A>.
For web sites mirror
<A HREF="ftp://debian.crosslink.net/www/debian.org">ftp://debian.crosslink.net/www/debian.org</A>
and
<A HREF="ftp://debian.crosslink.net/www/debian.org-local">ftp://debian.crosslink.net/www/debian.org-local</A>.
You may of course choose to mirror a site closer to you.

<P>FTP mirrors should register with Debian in order to get included in the
mirror list. Send mail to <A HREF="mailto:mirrors@debian.org">mirrors@debian.org</A>
with the name of the mirror maintainer, mirror site, and path to the debian
archive.

<P> Just a few notes for web mirrors: debian.org has links into debian.org-local
so your web server must allow symbolic links. Also, if your machine is running
Debian, it was decided to break Debian policy and use /doc in the web pages.
This means you should comment out 'Alias /doc/ /usr/doc/' from srm.conf .
sponsor.html and sponsor_img.jpg can and should be replaced by you. They are
for you to advertise your site so people know who the sponsor is.
The originals are under sponsor.deb.html and sponsor.deb.jpg as the site you
are mirroring may have replaced the ones Debian provided as examples.
The suggested maximum size for your logo is 120x60.

<H2>Mirror Programs</H2>
Most people mirror using anonymous ftp. For this, the program 'mirror' works
well on the ftp archive. Unless you have a lot of RAM (75MB has been reported
to work), mirror has difficulty mirroring debian.org-local because the bug lists
have a large number of files. The creator of mirror is aware of the problem and
is supposed to fix it in a future version.
As you probably guessed, 'mirror' is available as a Debian package.
If you have installed the Debian package, there is a sample script for mirroring
the ftp archive in /etc/mirror/packages/ftp.debian.org .

<P>If you have an account on the machine you are mirroring, many
people prefer rsync. Besides working better for large archives, it
allows you to use ssh for a secure connection.
You may find it useful to look an <A HREF="rsync_examples">example</A>
on using rsync to mirror Debian. Use rsync version 1.7.4 or later as earlier
versions used much more memory.

<P>While wget works well for mirroring small sites, it is not as efficient as
mirror or rsync so is not recommended for this job.

<H2>Content Negotiation</H2>
Content Negotiation is a method which lets a browser negotiate with a server
the type of document that should be served. While there are a number of
uses for this, the most common is to negotiate what language a document
should be served in. Using this will allow Debian to serve its pages in
multiple languages in a (technically) very elegant fashion.

<P>For those who are using Apache, the change is almost trivial. Simply
add a section similar to the following to /etc/apache/access.conf
(substitute the directory containing the web pages for /debian/web) and
restart the server (this example works with the apache 1.3 beta releases and later):
<blockquote><pre>
&lt;Directory /debian/web&gt;
Options +Multiviews   
&lt;/Directory&gt;
</pre></blockquote>

<H2>Other Web Server Changes</H2>
In order to serve directory index files correctly, you will probably need to
modify the DirectoryIndex entry in /etc/apache/srm.conf. The following should
be sufficient:
<pre>
   DirectoryIndex index index.html index.shtml index.htm
</pre>
Additionally, you need to make sure that the server can handle all the languages
that will be on the web site. This is done using the AddLanguage tag. The
following is just a sample - expect to add more later:
<pre>
   AddLanguage en .en
   AddLanguage fr .fr                                                       
   AddLanguage de .de                         
   AddLanguage it .it
   AddLanguage es .es
   AddLanguage ja .ja
   AddLanguage da .da
</pre>


<HR>
<P>Back to the <A href="../">Debian GNU/Linux homepage</A>.

<:= languages ("$(HOME)", "devel", "$(WML_SRC_BASENAME)", "$(CUR_LANG)") :>
