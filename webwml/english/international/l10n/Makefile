# This Makefile should need no changes from webwml/english/international/l10n/Makefile
# Please send a message to debian-www if you need to modify anything
# so the problem can be fixed.

WMLBASE=../..
CUR_DIR=international/l10n
SUBS=

include $(WMLBASE)/Make.lang

all::data/langs

LANGS_TMPL=$(shell cat data/langs |grep 'templates:'|sed 's/templates://')
LANGS_PO  =$(shell cat data/langs |grep 'po:'       |sed 's/po://')
LANGS_ALL =$(shell cat data/langs |grep 'all:'      |sed 's/all://')

HTML_PO  =$(foreach lang,$(LANGS_PO)  ,po-$(lang).$(LANGUAGE).html)
HTML_TMPL=$(foreach lang,$(LANGS_TMPL),templates-$(lang).$(LANGUAGE).html)

all::$(HTML_PO) $(HTML_TMPL)

data/langs:data/unstable scripts/list-languages
	scripts/list-languages data/unstable> data/langs

po-%.$(LANGUAGE).html:\
	../../../english/international/l10n/scripts/init.pl\
	../../../english/international/l10n/scripts/ranking.pl\
	../../../english/international/l10n/scripts/team-po.pl\
	../../../english/international/l10n/team-po.wml\
	../../../english/international/l10n/dtc.def \
	../../../english/international/l10n/data/unstable
	$(WML) -D TEAM=$* team-po.wml

templates-%.$(LANGUAGE).html:\
	../../../english/international/l10n/scripts/init.pl\
	../../../english/international/l10n/scripts/ranking.pl\
	../../../english/international/l10n/scripts/team-templates.pl\
	../../../english/international/l10n/team-templates.wml\
	../../../english/international/l10n/dtc.def \
	../../../english/international/l10n/data/unstable
	$(WML) -D TEAM=$* team-templates.wml

team-po.$(LANGUAGE).html:\
	../../../english/international/l10n/scripts/init.pl\
	../../../english/international/l10n/scripts/ranking.pl\
	../../../english/international/l10n/scripts/team-po.pl\
	../../../english/international/l10n/team-po.wml\
	../../../english/international/l10n/dtc.def \
	../../../english/international/l10n/data/unstable

team-templates.$(LANGUAGE).html:\
	../../../english/international/l10n/scripts/init.pl\
	../../../english/international/l10n/scripts/ranking.pl\
	../../../english/international/l10n/scripts/team-templates.pl\
	../../../english/international/l10n/team-templates.wml\
	../../../english/international/l10n/dtc.def \
	../../../english/international/l10n/data/unstable

l10n-lang.$(LANGUAGE).html: ../../../english/international/l10n/scripts/init.pl\
	../../../english/international/l10n/scripts/ranking.pl\
	../../../english/international/l10n/scripts/l10n-lang.pl ../../../english/international/l10n/l10n-lang.wml\
	../../../english/international/l10n/dtc.def \
	../../../english/international/l10n/data/unstable

i18n.$(LANGUAGE).html: ../../../english/international/l10n/scripts/init.pl\
	../../../english/international/l10n/scripts/i18n.pl ../../../english/international/l10n/i18n.wml\
	../../../english/international/l10n/dtc.def\
	../../../english/international/l10n/data/unstable

l10n.$(LANGUAGE).html: ../../../english/international/l10n/scripts/init.pl\
	../../../english/international/l10n/scripts/ranking.pl\
	../../../english/international/l10n/scripts/l10n.pl ../../../english/international/l10n/l10n.wml\
	../../../english/international/l10n/dtc.def\
	../../../english/international/l10n/data/unstable

l10n-packages.$(LANGUAGE).html: ../../../english/international/l10n/scripts/init.pl\
	../../../english/international/l10n/scripts/l10n-packages.pl ../../../english/international/l10n/l10n-packages.wml\
	../../../english/international/l10n/dtc.def\
	../../../english/international/l10n/data/unstable

l10n-error.$(LANGUAGE).html: ../../../english/international/l10n/scripts/init.pl\
	../../../english/international/l10n/scripts/l10n-error.pl ../../../english/international/l10n/l10n-error.wml\
	../../../english/international/l10n/dtc.def\
	../../../english/international/l10n/data/unstable

l10n-rank.$(LANGUAGE).html: ../../../english/international/l10n/scripts/init.pl\
	../../../english/international/l10n/scripts/ranking.pl\
	../../../english/international/l10n/scripts/l10n-rank.pl ../../../english/international/l10n/l10n-rank.wml\
	../../../english/international/l10n/dtc.def \
	$(TEMPLDIR)/language_names.wml\
	../../../english/international/l10n/data/unstable

# theses wml files are generated by l10n-lang
#l10n-lang-*.wml:l10n-lang.$(LANGUAGE).html l10n-lang.wml\
#	../../../english/international/l10n/data/unstable

# The following is not really correct, but it should work well enough.
# The problem is that we don't know in advance what files will exist (the
# list of variants is buried in the db), so we can't set up an explicit
# dependency chain for the files. Instead we simply force the installation
# (with every invocation) of all files with the correct form.
# Feel free to fix this if you know how

#This hack should not be needed anymore since l10n-lang.wml was splitted

#install:: FORCE
#	install -p -m664 $(wildcard l10n-lang-??.$(LANGUAGE).html) $(HTMLDIR)
#FORCE:
