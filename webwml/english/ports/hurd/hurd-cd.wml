#use wml::debian::template title="Debian GNU/Hurd --- Documentation" NOHEADER="yes"
#include "$(ENGLISHDIR)/ports/hurd/menu.inc"

<H1>Debian GNU/Hurd</h1>

<h2>Using the unofficial Debian GNU/Hurd installation CD-ROMs</H2>

<P>Current series, H3</P>

<P>There are four CD images.  The "unstable-extra" tree has been included on 
the fourth CD.  The scripts used to build the images are also on this CD. 
Warning, these scripts are very rough.</P>

<P>baseHurd.tgz (the tarball) is rebuilt as part of the creation of the CD set 
and so is up to date.</P>

<H3>Important note.</H3>

<P>apt will lock up when installing packages from the cdrom on some hardware.  
The dirty work-round is to delete pkgcache.bin and srcpkgcache.bin from 
/var/cache/apt/ and running apt-get update before running apt-get install.</P>

<H3>Download.</H3>

<P>The current iso images are hurd-H3-CD[1,2,3,4].iso and most of the Hurd 
specific binaries are found on the first CD, but all the games, graphics and 
some other packages are found on the second CD.  A basic Hurd system can be 
installed using the first CD.</P>

<P> These sites usually mirror the images, but check first.</P>

<P>The primary site for these images is 
ftp://ftp.gnu.org/pub/gnu/hurd/contrib/iso/hurd-H3/ and they can also be 
fetched from its mirrors.</P> 

<ul>
<li>
<P><A HREF="ftp://ftp.planetmirror.com/pub/debian-cd/unofficial">ftp.planetmirror.com/pub/debian-cd/unofficial</A> -  Australia
<li>
<A HREF="ftp://ftp.acc.umu.se/pub/cd-images/debian-unofficial">ftp.acc.umu.se/pub/cd-images/debian-unofficial</A> -  Sweden
<li>
<A HREF="ftp://omega.elte.hu/mirror/debian-unofficial">ftp://omega.elte.hu/mirror/debian-unofficial</A> -  Hungary
<li>
<A HREF="ftp://ftp.fsn.hu/pub/CDROM-Images/debian-unofficial/hurd">ftp.fsn.hu/pub/CDROM-Images/debian-unofficial</A> -  Hungary (Primary site)
<li>
<A HREF="http://getyouriso.dyndns.org/debian-cd/unstable/hurd-i386/">http://getyouriso.dyndns.org/debian-cd/unstable/hurd-i386/</A> - Spain
<li>
<A HREF="ftp://www.che.iitm.ac.in/pub/hurd-cd">ftp://www.che.iitm.ac.in/pub/hurd-cd</A> - The Indian sub-continent only please.
</ul>

<P>A <a href="http://www.google.com/search?q=intitle:hurd-H3">Google search</a>
for intitle:hurd-H3 could find a closer site.</P>

<p> Instructions for burning CDs from the images can be found at <A
HREF="http://cdimage.debian.org/faq.html">http://cdimage.debian.org/faq.html</A>
</P>

<H3>CD-ROMs</H3>

<P>See <A HREF="../../CD/vendors/"> this page for Hurd CD vendors</A>.  
Look for <code>hurd</code> using your browser's search facility.</P>

<H3>How the Installation Disc works</H3>

<P>The potato Debian GNU/Linux installation CDs uses the cross
install method to install the base system.  A ramdisk is created in
memory and a mini GNU/Linux system installed into this disk.  This
mini system is used to partition and format drives, and to prepare the
target machine for the main installation.  The critical phase is to
unpack a tarball with the essential base packages onto the drives of
the target system.  The new system is then rebooted using the packages
unpacked onto the HDD.  Further packages are then installed and
configured to create the desired system.</P>

<P>As the Hurd also uses the cross install method, this meant that the
scripts to build the Hurd installation CDs could be adapted from the
Debian GNU/Linux boot and CD scripts so that the Hurd rather than the 
Linux tarball would be unpacked.</P>

<P>Installing the Hurd using a cd-rom set has several advantages.

<ul><li>
Hurd specific documentation is found in ./doc/hurd.  hurd-install-guide
is a "must read" document before you start.
<li>

As the Linux system runs in a ramdisk and the tarball is on the cdrom,
the Hurd can be installed onto a bare machine, or onto a system where
people do not want to use the installed operating system.

<li>
The file system storing the packages on the CDs could be reorganised
to incorporate work-arounds.

<li>
There are no partitioning tools for the Hurd (yet) so the installation
CD can be used to partition HDDs during the installation.

<li>
It is faster, less fiddle and most people are familiar with the process.
</ul>


<H3>Hurd Partitions</H3>

<P>The Hurd does not support partition sizes greater than about 1 Gb.
However, several partitions can be created during the installation
process.  The Hurd also uses extensions to the ext2 file system, the
call is "mke2fs -o hurd /dev/*".  The installation CDs
use this by default.</P>


<H3>Using the Installation CD</H3>

<H4>Preparation.</H4>

<ol>
<li><P><em>Make a GRUB boot-disk</em>
<p>
The image file is /install/grub_0.9 image on the CDROM.  You
can use "dd" if you are working in Linux or rawrite if you are working
in MS.</P>

<li><P>Make certain that you understand Linux, GRUB and Hurd methods
of naming drives and partitions. You will be using all three and the
relationship between them can be confusing.
</ol>

<p> Hurd uses different partition names to Linux, so be careful. IDE
hard disks are numbered in order, beginning from hd0. The second IDE
drive will be hd1, regardless of whether it is a slave or a second
master. SCSI drives are also numbered in absolute order.  They will
always be sd0, sd1, and so on regardless of whether the two drives are
SCSI id 4 and 5 or whatever. Experience has shown that CD-ROM drives
can be tricky.  More about this later.

<p> Linux-style partitions are always called sn when using the Hurd,
where n is the partition number, so the first partition on the first
IDE drive will be hd0s1, the third partition on the second SCSI drive
will be sd1s3, and so on.
				
<p> GRUB has yet another partition naming system. It calls partitions
(hdN,n), but this time the disk number and partition number are both
zero indexed, and the disks run in order, all the IDE disks first, and
the SCSI ones second.  This time, the first partition on the first IDE
drive will be (hd0,0).  To really cause a confusion, (hd1,2) could
refer to the first SCSI drive if you only have one IDE drive, or it
could refer to the second IDE drive.  So it is important that you have
worked out the various names of your partitions before you start.</P>
						      
<H4>Installation</H4>

<ol>
<li><em>Boot the CD.</em>
<p>
Any of the methods of booting a Debian 2.2 (potato) CD will
work, ie. from the CD, from MS and by any of the boot/root floppy images.
A complete set of base floppies can created if there is no cdrom drive.

<li><em>After the opening screens, open "Partition a Hard Disk".</em>
<p>
If you are going to copy the .deb packages onto the HDD then you will need 
to create to other partitions, one for each CD. As there are no 
partitioning tools for the Hurd so you have to use this facility. About 
500 Mb will be enough to start with for the main system.  If you need to 
create another partition then you can reboot the CD and use the tools in 
the Linux ramdisk to do this.
			    
<li><em> Work out the GRUB and Hurd names of the partition you will be using.</em>

<li><em>Prepare your partitions using "Partition a Hard Disk"</em>
and make certain that you have a swap partition.  Hurd is fussy about swap.

<li><em> Format your Hurd partition</em>
using "Initialize a Hurd or Linux Partition" and mount it on <code>/</code>.
Do not mount  any other partitions.

<li><em>Install the base system using "Install the Base System".</em>
				    
<li><em>Insert a GRUB floppy in the drive and reboot with "Reboot the System"</em>
(don't forget to reset the bios).  That is it!  [First reboot]
</ol>   

<P>If your Hurd partition is <code>(hd0,0)</code> [GRUB nomenclature]
and <code>sd0s1</code> [Hurd], which being interpreted means the first
partition on the first HDD which is SCSI and there are no IDE drives,
then the system will boot with no intervention.<BR>

If your Hurd partition is <code>(hd0,0)</code> [GRUB nomenclature] and
<code>hd0s1</code> [Hurd], which being interpreted means the first
partition on the first HDD which is IDE, then GRUB will only be
slightly confused.  It will tell you that it cannot find
<code>sd0s1</code> and ask you to correct it.  Having thoroughly
understood the different naming schemes you know instantly that the
correct answer is hd0s1.  GRUB will then ask if it should use
<code>/boot/serverboot.gz</code>, reply with "Enter".</P>

<P>Keep you hands off the keyboard until the boot process has
completed.</P>

<P>"/boot/grub/menu.lst" on the GRUB floppy can be edited so you
system will boot without manual intervention.</P>


<H3>The next steps.</H3>

<ol>
<li><em>After the system has booted run ./native-install.</em> Reboot
the system using "reboot".  THIS IS IMPORTANT watch the boot messages
and note carefully where the cdrom is.  [Second reboot]
    
<li><em>After the reboot has completed run ./native-install a second time.</em> 
This time a whole bundle of packages will be configured.  Reboot yet again. 
[Third reboot]. You will now have a system to configure.<BR> 
Login as root, "login root".

<li><em>cd to /dev.  Make the necessary devices.</em> Ie, for the
cdrom, the swap partition and any other HDD partitions.

<p> Eg
"MAKEDEV hd2 hd0s2 hd0s3"</P>
		
<li><em>Edit /etc/fstab, "nano /etc/fstab"</em>.
nano is not a bad editor.<p>
Add the HDD partitions, eg,<br>
/dev/[Hurd partition name]   none    swap    sw    0       0<BR>
/dev/[Hurd partition name]   /CD1     ext2    rw    1       1</P>

<P>The Hurd uses the ext2 fs.  "/CD1" is a suggested mount-point for 
the partition which contains the packages from hurd-H3-CD1. 
Swap can be shared with Linux.</P>
					
<li><em> Activate the swap "swapon -a".</em>
Check to see that is has worked.  Swap is HIGHLY recommended with the Hurd.

<li><em>Set up the translator that accesses the cdrom,</em> eg
<p>
settrans -a /cdrom /hurd/isofs /dev/[Hurd drive name]</P>
	
<li><em>Run "/cdrom/upgrade/initial.sh"</em>.
<p>This will install some useful packages.<BR>
developer.sh and gui.sh are also provided.</p>
				
<li><em>If apt locks up the system when running apt-get install.</em>
<p>You have the hardware that apt does not like, see above for a solution.<BR>
The scripts in /cdrom/upgrade include this feature.</p>

<li><em> Further packages can be installed using "apt or "dselect".</em>
<p>If you are unfamiliar with these Debian tools, see 
"man apt" and "man dselect".</p>

<li><em>Unmounting the cdrom</em>
<P>The cdrom drive is unmounted with <code>settrans -agf /cdrom</code><BR>
The cdrom drive drawer should then be unlocked.

<li><em>Copying the CDs to partitions.</em>
<P>It is safe to copy the cdroms to HDD partitions as apt will not add the 
packages "PACKAGES-extra" to its cache.</P>

</ol>

<P>This is where this guide finishes and you start exploring.  Enjoy the Hurd.</P>
<P>Comments about the CDs are welcome.<BR>  
Philip Charles, philipc@debian.org
