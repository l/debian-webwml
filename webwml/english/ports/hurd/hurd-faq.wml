#use wml::debian::template title="Debian GNU/Hurd --- Documentation" NOHEADER="yes"
[ <a href="..">Ports</a> ]
[ <a href="index">Debian GNU/Hurd</a> ]
[ <a href="hurd-news">News</a> ]
[ <a href="hurd-install">Installation</a> ]
[ <a href="hurd-doc">Documentation</a> ]
[ <a href="hurd-devel">Development</a> ]
[ <a href="hurd-links">Links</a> ]
[ <a href="hurd-contact">Contact</a> ]<p>

<h1>
Debian GNU/Hurd</h1>
<h2>
Frequently Asked Questions (FAQ)</h2>

<p>
Note that this FAQ will not only contain FAQ's, but probably all
interesting talk on the Hurd mailing lists. I am going to use this as
a catch all bucket until the various information is in its proper
place.

<h3>
`General'</h3>
<p>
<b>
Question</b>: Is the Hurd under development, or is it a dead
project?
<p>
<b>
Answer</b>: It is under active development these days. We are fixing
bugs to get more stability and port many common software packages. We
also add small to medium sized features. We would like to get more
developers on board, too.  There are a lot of very interesting
features to be implemented, and you seldom get the chance to design
and implement parts of an exciting operating system, so join in
today!

<p>
<b>
Question</b>: Does it run at all?
<p>
<b>
Answer:</b> Yeah.

<h3>
... At Installation Time</h3>
<p>
<b>
Question</b>: Which hardware is supported by the Hurd?
<p>
<b>
Answer</b>: Please read the <a
href="http://www.urbanophile.com/arenn/hacking/hurd/hurd-hardware.html">Hardware
Compatibility Guide</a> to answer your question.

<p>
<b>
Question</b>: Which partition type should I use for my GNU/Hurd
partition?</P>
<p>
<b>Answer</b>: You should use an ext2 file system. Alternatively, you
may use BSD style ufs. The partition type number for ext2fs is
<code>0x83</code> (same as Linux), <em>not</em> <code>0x63</code> (GNU
HURD). Thomas explains why <code>0x63</code> is the wrong choice:
<blockquote>
One day we may have a new filesystem format, which would probably be
called the GNU Hurd filesystem format, and might well use that
partition code.  Regardless, it is always an error to use that code
for an ext2fs partition, as Roland points out.</blockquote>

<p>
<b>
Question</b>: What is my partition name/number?
<p>
<b>
Answer</b>: I knew you would ask this. If I had to reduce this FAQ to
only one question, I'd choose this one. It is pretty easy, but you
have to know that there are actually three naming convention we face
here.
<p>
All naming conventions use <code>hd</code> for IDE and <code>sd</code>
for SCSI disks. So far the commonalities. Now for the differences.
<p>
First, figure out the disk number. If it is a SCSI disk, you need to
know the SCSI disk number. If it is an IDE disk, you need to know on
which controller it is and if it is a master or slave. For Linux, the
master disks on the primary controller has the letter "a", the slave
on the same controller the letter `b'. Master and slave on the
secondary controller have the letters `c' and `d' respectively. The
Hurd does use BSD style notation so it is `0', `1', `2' and `3'
instead `a', `b', `c' and `d'. This means <code>/dev/hdc</code> under
Linux translates to <code>/dev/hd2</code> under the Hurd. Got it?
Good. GRUB does it differently! GRUB is doing it like the BIOS and
enumerates all installed disks it can boot from starting from "0"
incrementing by 1. So `hd(0,?)' is a partition on the first disk it
can boot from, regardless if this is a master or slave or
whatever. The second disk it finds has `hd(1,?)' etc. Luckily, the
BIOS is searching in the well defined order primary controller
master/slave, secondary controller master/slave.
<p>
Now figure out the partition number. The partition number for DOS
style partitions is the same under Linux and the Hurd, but the Hurd
does use BSD style notation with slices. So it is
<code>/dev/hdc3</code> under Linux, but <code>/dev/hd2s3</code> under
the Hurd. If you use BSD partitions, you already know what the Hurd
name for this partition is. GRUB does it, again, differently: It
starts counting from "0", so <code>/dev/hd0s3</code> is
<code>hd(0,2)</code> in GRUB, <em>not</em> <code>hd(0,3)</code>!

<p>
<b>
Question</b>: How do I add a swap partition?
<p>
<b>
Answer</b>: A swap partition is also called a paging file. Usually, it
is sufficient to add the swap partition to <code>/etc/fstab</code>
just as you would under Linux.  You can swap to a Linux swap
partition, and the Hurd will honour the Linux swap signature (both
versions). But the Hurd will just as happily swap to any other raw
disk space and overwrite anything it finds, so be careful!
<p>
If you want to swap to a file, or make sure that it checks the Linux
swap signature before, you need to edit
<code>/boot/servers.boot</code>. The syntax is the partition device
file name, plus optionally the swap file inside an ext2fs partition,
followed by a space and then one of
<code>$(add-raw-paging-file)</code>,
<code>$(add-linux-paging-file)</code>,
<code>$(add-paging-file)</code>. The first works with any
partition/file and does not honour any swap sigature or other
data. The second has a safety check and only works if a Linux swap
signature can be found. The third looks for a swap signature first and
falls back to raw paging if it couldn't find one. This is also the
default for entries in <code>/etc/fstab</code>.

<p>
<b>
Question</b>: I get <code>Operation not permitted</code> error at
installation time!
<p>
<b>
Answer</b>: You forgot to set the file system owner of the Hurd
partition to <code>hurd</code>. The Hurd does use additional
information in inodes to set translators, to make this work the
partition must be marked as "owned by the Hurd". You can do this with
<code>mke2fs -o hurd /dev/XXX</code> when creating the partition or
afterwards using the <code>e2os</code> script.

<p>
<b>
Question</b>: What does the following error mean?
<pre>
/hurd/ext2fs.static: cannot vm_map whole disk: (os/kern) no space available
</pre>
<p>
<b>
Answer</b>: It means that your partition is bigger than 1 GB. Such big
partitions are currently not supported, sorry.

<p>
<b>
Question</b>: After <code>native-install</code> finished, I had to
write tthhiiss wwaayy.  In particular I had to type
<code>rreebboooott</code> to reboot.
<p>
<b>
Answer</b>: Funny, isn't it? In addition to the rescue
<code>term</code> server in <code>/tmp/console</code>, another
<code>term</code> server got started and is clobbing the keyboard
input. After a reboot this problem vanishes, because only one
<code>term</code> server will remain.  There is currently no known
clean solution, but we are keeping an eye on it. If <code>tar</code>
would support translator, we would not have this problem... Even if
you don't experience this problem right after the installation, reboot
immediately so you don't hit this bug by accident.

<p>
<b>
Question</b>: Why is <code>/usr</code> a symbolic link to
<code>.</code>?
<p>
<b>
Answer</b>: The distinction between <code>/</code> and
<code>/usr</code> has historical reasons, back when Unix systems were
booted from two tapes, a small root tapes and a big user tape. Today,
we like to use different partitions for these two spaces. The Hurd
throws this historical garbage away. We think that we have found a
more flexible solution called shadow filesystems. Unfortunately,
support for shadowed filesystems is not yet implemented.

<p>
<b>
Question</b>: How do I set up my network card? It was autodetected by
GNU Mach.
<p>
I don't have any network card, how do I set up a loopback only network?
<p>
<b>
Answer</b>: Setup the <a href="hurd-doc-server"><code>pfinet</code></a>
server. Also don't forget to set up <code>/etc/resolv.conf</code>,
<code>/etc/hosts</code> and so on.
<p>
Of course, you only need to do this if the installation routine didn't do it
for you.

<p>
<b>
Question</b>: Pipes don't work!
<p>
<b>
Answer</b>: <code>settrans -fgc /servers/socket/1 /hurd/pflocal</code>
will help you.

<p>
<b>
Question</b>: When the APM support in the BIOS spins down my disk
drives, the Hurd is unable to wake up!
<p>
<b>
Answer</b>: APM is not supported in the current version of GNU Mach,
sorry. Please disable APM in your BIOS setup.

<p>
<b>
Question</b>: What about X?
<p>
<b>
Answer</b>: Soon to come. We already have hacked together the <a
href="ftp://alpha.gnu.org/gnu/hurd/debian">libraries and clients</a>,
but the servers need support in GNU Mach and Hurd which is not
finished yet.

<p>
<b>
Question</b>: My X clients won't work!
<p>
<b>
Answer</b>: Try <code>export LD_LIBRARY_PATH=/usr/X11R6</code>. This
is a linker issue.  The Hurd systems wants to use <code>RPATH</code>,
and Debian does avoid <code>RPATH</code>.

<h3>
Using the Hurd</h3>

<p>
<b>
Question</b>: What's a translator?
<p>
<b>
Answer</b>: There is a <a href="hurd-doc-translator">text about
translators</a> available. Read this and ask further questions on the
mailing list.

<p>
<b>
Question</b>: Why can I <code>read()</code> a directory?
<p>
<b>
Answer</b>: It is important to understand that there is nothing
special about a directory under the Hurd, it is just another
file. This fits in the translator concept where a translator can
appear as a directory but provide a file, too.
 
<p>
<b>
Question</b>: How can I pass options to <code>serverboot</code> from
the GRUB command line?
<p>
<b>
Answer</b>: Just give them to the kernel and it will pass them down to
<code>serverboot</code>.

<p>
<b>
Question</b>: Can I use the Linux version of <code>e2fsck</code> on my
Hurd partition?
<p>
<b>
Answer</b>: Yes, you can since <code>e2fsprogs-1.05</code>. Check with
<code>e2fsck -V</code> first.

<p>
<b>
Question</b>: <code>ps aux</code> does not give the output I'd
expected.
<p>
<b>
Answer</b>: Try <code>ps Aux</code>.

<p>
<b>
Question</b>: What are these strange pids 2 and 3?
<p>
<b>
Answer</b>: 2 is the kernel, 3 is the default pager. 4 is the root
filesystem.

<p>
<b>
Question</b>: Where is ...
<p>
<b>
Answer</b>:
<ul>
<li>
<code>fdisk</code>, <code>dmesg</code> are not yet ported.</li>
<li>
Instead <code>free</code>, use <code>vmstat</code> and
<code>vminfo</code>.</li></ul>

<p>
<b>
Question</b>: Is there a <code>/proc</code> filesystem?
<p>
<b>
Answer</b>: No. Maybe there will be an emulation some day for programs
that need it. If you wonder about the empty <code>/proc</code>
directory, that is a relict from a Debian GNU/Linux package
(<code>base-files</code>). You can probe for existing hardware devices with
the <a href="hurd-doc-utils#devprobe">devprobe</a> utility.


<h3>... When Something Breaks</h3>

<p>
<b>
Question</b>: What is a <code>default pager</code>,
<code>paging</code>, or a <code>pager request</code>?
<p>
<b>
Answer</b>: The default pager handles the virtual memory
allocation. If it can't allocate a new memory page because you are out
of memory, some terrible things may happen. Whenever you get such
errors you either need more memory or you have found a memory
leak. Always add a swap partition.

<p>
<b>
Question</b>: What is a <code>Gratuitous error</code>?
<p>
<b>
Answer</b>: This is coming from <code>strerror(EGRATUITOUS)</code>. If
you check <code>glibc</code>'s documentation, it will say that this
error code has no purpose <code>:)</code>.  However, this is not quite
true. You only get this when something terrible happened. Thomas
explains:
<blockquote>
More precisely <code>EGRATUITOUS</code> officially means that some
server has responded in an impossible or protocol-violating fashion.
There are some cases in the Hurd where <code>EGRATUITOUS</code> is
returned and probably something else should be chosen instead.
</blockquote>
If you can reproduce this error message, please report it. But <em>do
not</em> report this for accessing <code>/dev/fd</code>, we already know
that.

<p>
<b>
Question</b>: Why does <code>df</code> not work?
<p>
<b>
Answer</b>: <code>df</code> tries to get a list of all mounted
filesystems. This is a list that is not available under the Hurd
because there is currently no central list of all mounted
filesystems. You can use <code>df /</code> to get the free diskspace
on the root filesystem and similar for other filesystem (you need at
least <code>fileutils 4.0-2.1</code> for this feature).

<p>
<b>
Question</b>: When something crashes, GNU Mach reboots
automatically. But it does it too fast, and I can't write the error
message.
<p>
<b>
Answer</b>: Give the <code>-H</code> option to init (add it to the
boot command line), and <code>init</code> will tell Mach to enter the
kernel debugger instead to reboot. At the debugger prompt, you can
type <code>db&gt; reboot</code> any time to reboot the system.

<h3>Development</h3>

<p>
<b>
Question</b>: Where can I get the source?
<p>
<b>
Answer</b>: You can get the source of all Debian packages on any <a
href="../../distrib/ftplist">Debian ftp mirror</a>. For GNU Mach and
the Hurd there is also <a
href="http://www.gnu.org/software/devel">anonymous CVS access</a>
available.

<p>
<b>
Question</b>: Where should I start reading the Hurd source code?
<p>
<b>
Answer</b>: Probably start with the <code>auth</code> server.

<p>
<b>
Question</b>: Are there example programs that make use of special Hurd
features?
<p>
<b>
Answer</b>: Have a look at the <code>utils/</code> directory in the
Hurd source tree.

<p>
<b>
Question</b>: <code>ps</code> hangs, and I need to check its output!
<p>
<b>
Answer</b>: Interrupt it and start it with <code>-M</code>.
