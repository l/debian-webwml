#use wml::debian::common_tags

<define-tag moreinfo whitespace=delete>
  <gettext>More information:</gettext>
</define-tag>

<define-tag takenby whitespace=delete>
  <gettext>Taken by:</gettext>
</define-tag>

<define-tag nobody whitespace=delete>
  <gettext>Nobody</gettext>
</define-tag>

<define-tag rating whitespace=delete>
  <gettext>Rating:</gettext>
</define-tag>

<define-tag rating1>
 <img src="$(PICS)/star-grn.gif" alt="*">
</define-tag>
<define-tag rating2>
 <img src="$(PICS)/star-yel.gif" alt="*"><img src="$(PICS)/star-yel.gif" alt="*">
</define-tag>
<define-tag rating3>
 <img src="$(PICS)/star-red.gif" alt="*"><img src="$(PICS)/star-red.gif" alt="*"><img src="$(PICS)/star-red.gif" alt="*">
</define-tag>

<set-var todoitem:count=0 />

<define-tag item endtag=required>
<preserve id subject url urlname taken-by rating />
<set-var %attributes />

<when <not <get-var id />/>>
  <set-var id=<get-var todoitem:count />/>
  <increment todoitem:count />
</when>
<subst-in-var id ".*/([^/.]+).*" "\\1" />

{#!TODO<get-var id />OUT#:
<table width="100%" border="0" cellspacing="0" cellpadding="15">
<tr><td>
  <minicard name=<get-var subject />>
    %body
    <table width="100%" border="0" cellspacing="0" cellpadding="0"><tr>
     <td align="left" valign="bottom">
      <when <get-var rating />>
        <br>
        <i><rating/></i>
        <subst-in-string "<_dummy_rating<get-var rating/>/>" "_dummy_" "" />
      </when>
     </td>
     <td align="right" valign="bottom">
      <i><moreinfo/> <a href="<get-var url/>"><get-var urlname/></a></i>
      <when <get-var taken-by/>><br><i><takenby/></i> <get-var taken-by/></when>
     </td>
    </tr></table>
  </minicard>
</td></tr>
</table>
:#TODO<get-var id />OUT#}
<when <not <get-var todoitem:<get-var id />/>/>>
   #   Insert only once
   {#TODO<get-var id />OUT#}
   <set-var todoitem:<get-var id />=1 />
</when>

<restore id subject url urlname taken-by rating />
</define-tag>

<define-tag todo-list-items>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#BBDDFF"><tr>
  <td width="3%"></td>
  <td>
#   English items
#include '$(ENGLISHDIR)/devel/todo/items/[0-9][0-9]*.wml' IPP_SORT=name
#   Overwrite localized items
#include 'items/[0-9][0-9]*.wml' IPP_SORT=name
  </td>
</tr></table>
</define-tag>

