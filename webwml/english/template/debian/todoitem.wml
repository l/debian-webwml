#use wml::debian::common_tags

<define-tag moreinfo whitespace=delete>
  <gettext>More information:</gettext>
</define-tag>

<define-tag takenby whitespace=delete>
  <gettext>Taken by:</gettext>
</define-tag>

<define-tag nobody whitespace=delete>
  <gettext>Nobody</gettext>
</define-tag>

<define-tag rating whitespace=delete>
  <gettext>Rating:</gettext>
</define-tag>

<define-tag rating1>
 <img src="$(PICS)/star-grn.gif" alt="*" />
</define-tag>
<define-tag rating2>
 <img src="$(PICS)/star-yel.gif" alt="*" /><img src="$(PICS)/star-yel.gif" alt="*" />
</define-tag>
<define-tag rating3>
 <img src="$(PICS)/star-red.gif" alt="*" /><img src="$(PICS)/star-red.gif" alt="*" /><img src="$(PICS)/star-red.gif" alt="*" />
</define-tag>

<set-var todoitem:count=0 />

<define-tag item endtag=required>
<preserve id subject url urlname taken-by rating />
<set-var %attributes />

<when <not <get-var id />/>>
  <set-var id=<get-var todoitem:count />/>
  <increment todoitem:count />
</when>
<subst-in-var id ".*/([^/.]+).*" "\\1" />

{#!TODO<get-var id />OUT#:
<div class="card">
  <h2><get-var subject /></h2>
  <div>
    <p>
    %body
    </p>
      <when <get-var rating />>
        <div class="lefthalf">
        <i><rating/></i>
        <subst-in-string "<_dummy_rating<get-var rating/>/>" "_dummy_" "" />
	</div>
      </when>
      <div class="righthalf">
      <i><moreinfo/> <a href="<get-var url/>"><get-var urlname/></a></i>
      <when <get-var taken-by/>><br /><i><takenby/></i> <get-var taken-by/></when>
      </div>
  </div>
</div>
:#TODO<get-var id />OUT#}
<when <not <get-var todoitem:<get-var id />/>/>>
   #   Insert only once
   {#TODO<get-var id />OUT#}
   <set-var todoitem:<get-var id />=1 />
</when>

<restore id subject url urlname taken-by rating />
</define-tag>

<define-tag todo-list-items>
<div id="main">
#   English items
#include '$(ENGLISHDIR)/devel/todo/items/[0-9][0-9]*.wml' IPP_SORT=name
#   Overwrite localized items
#include 'items/[0-9][0-9]*.wml' IPP_SORT=name
</div> <!-- end  main -->
</define-tag>

