
# The translatable tags are in security_tags.wml

#use wml::debian::common_translation
#use wml::debian::fixes_link
#use wml::debian::languages
#use wml::debian::ctime
#use wml::debian::security_tags

<define-tag vulnerability>
	<ifeq "<isvulnerable>" "yes" "<FONT COLOR=FF0000><yes></FONT>">
	<ifeq "<isvulnerable>" "no" "<FONT COLOR=00FF00><no></FONT>">
</define-tag>

<define-tag nosecref whitespace=delete>
	[EN:No other external database security references currently available.:]
	[ES:No se dispone, de momento, de referencias a otras bases de datos de seguridad externas.:]
</define-tag>

<define-tag cert whitespace=delete>
	[EN:CERT's vulnerabilities, advisories and incident notes::]
	[ES:Notas y avisos de incidentes y vulnerabilidades en CERT::]
</define-tag>
<define-tag bugtraq whitespace=delete>
	[EN:In the Bugtraq database (at SecurityFocus)::]
	[ES:En la base de datos de Bugtraq (en SecurityFocus)::]
</define-tag>
<define-tag cve whitespace=delete>
	[EN:In Mitre's CVE dictionary::]
	[ES:En el diccionario CVE de Mitre::]
</define-tag>

<perl>
sub security_references {
 	my $refstr = shift(@_);
	my $str = "";
	my $bid = "";
	my $cve = "";
	foreach $ref (split(' ',$refstr)) { 
		if ( $ref =~ /BID(\d+)/i ) {
		my $id=$1;
		$bid .= ", " if $bid ne "";
		$bid .= "<a href=\"http://online.securityfocus.com/bid/".$id."\">BID".$id."</A>"; 
		}
		if ( $ref =~ /CVE(\d+)/i ) {
		my $id=$1;
		$cve .= ", " if $cve ne "";
		$cve .="<a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=".$id."\">CVE".$id."</A>";
		}
		if ( $ref =~ /CA-([\d-]+)/i ) {
		my $id=$1;
		$cert .= ", " if $cert ne "";
		$cert .="<a href=\"http://www.cert.org/advisories/CA-".$id.".html\">CA-".$id."</A>";
		}
		if ( $ref =~ /VU#(\d+)/i ) {
		my $id=$1;
		$cert .= ", " if $cert ne "";
		$cert .="<a href=\"http://www.kb.cert.org/vuls/id/".$id.".html\">VU#".$id."</A>";
		}

	}
	$str .="<bugtraq> $bid"  if $bid ne "";
	$str .="<cve> $cve"  if $cve ne "";
	$str .="<cert> $cert"  if $cert ne "";

	$str .= ". " if $str ne "";
	$str  = "<nosecref>" if $str eq "";
	return $str;
}
</perl>
<define-tag secdbinfo>
  [EN:Security Database references:]
  [ES:Referencias a bases de datos de seguridad:]
</define-tag>
<define-tag secreferences>
  <:= security_references("<secrefs>") :>
</define-tag secreferences>

<define-tag fileurl whitespace=delete>
<a href="%0">%0</a><br />
</define-tag>

# Start of the actual page

#use wml::debian::basic title="<security/> -- <pagetitle/>"

<h1><debian_security_advisory/></h1>

<h2><pagetitle/> -- <description/></h2>

<dl compact>
<dt><datereported/>:</dt>
	<dd><:= newsdate('<report_date/>') :></dd>
<dt><affectedpackages/>:</dt>
	<dd><packages/></dd>
<dt><vulnerable/>:</dt>
	<dd><vulnerability/></dd>
# This might be done with a ifneq "" tag too if people 
# do not like the <nosecref> here (jfs)
<dt><secdbinfo>:</dt>
	<dd><secreferences></dd>
<dt><formoreinfo/>:</dt>
	<dd><moreinfo/></dd>
#<ifneq "{#securitybody#}" "" "
<ifneq "<isvulnerable/>" "no" "
<dt><fixedin/>:</dt>
	<dd>{#securitybody#}</dd>
"/>
</dl>

<hrline/>

<:= languages() :>

<hrline/>

{#securitybody#:
