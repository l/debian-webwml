
# The translatable tags are in security_tags.wml

#use wml::debian::common_translation
#use wml::debian::fixes_link
#use wml::debian::languages
#use wml::debian::ctime
#use wml::debian::security_tags

<define-tag vulnerability>
	<ifeq "<isvulnerable/>" "yes" "<font color="#FF0000"><yes></font>">
	<ifeq "<isvulnerable/>" "no" "<font color="#00FF00"><no></font>">
</define-tag>

<perl>
sub security_references {
 	my $refstr = shift(@_);
	my $str = "";
	my $bid = "";
	my $cve = "";
	foreach $ref (split(' ',$refstr)) { 
		if ( $ref =~ /BID(\d+)/i ) {
			my $id = $1;
			$bid .= ", " if $bid ne "";
			$bid .= "<a href=\"http://online.securityfocus.com/bid/".$id."\">BID".$id."</a>"; 
		}
		if ( $ref =~ /CVE-([\d-]+)/i ) {
			my $id = $1;
			$cve .= ", " if $cve ne "";
			$cve .= "<a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=".$id."\">CVE-".$id."</a>";
		}
		if ( $ref =~ /(CAN-[\d-]+)/i ) {
			my $id = $1;
			$cve .= ", " if $cve ne "";
			$cve .= "<a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=".$id."\">CAN-".$id."</a>";
		}
		if ( $ref =~ /CA-([\d-]+)/i ) {
			my $id = $1;
			$cert .= ", " if $cert ne "";
			$cert .= "<a href=\"http://www.cert.org/advisories/CA-".$id.".html\">CA-".$id."</a>";
		}
		if ( $ref =~ /VU#(\d+)/i ) {
			my $id = $1;
			$cert .= ", " if $cert ne "";
			$cert .= "<a href=\"http://www.kb.cert.org/vuls/id/".$id."\">VU#".$id."</a>";
		}

	}
	$str .= "<bugtraq> $bid.<br>"  if $bid ne "";
	$str .= "<cve> $cve.<br>"  if $cve ne "";
	$str .= "<cert> $cert.<br>"  if $cert ne "";
	$str = "<nosecref>" if $str eq "";
	return $str;
}
</perl>

<define-tag secreferences>
  <:= security_references("<secrefs>") :>
</define-tag secreferences>

<define-tag fileurl whitespace=delete>
<a href="%0">%0</a><br />
</define-tag>

# Start of the actual page

#use wml::debian::basic title="<security/> -- <pagetitle/>"

<h1><debian_security_advisory/></h1>

<h2><pagetitle/> -- <description/></h2>

<dl compact>
<dt><datereported/>:</dt>
	<dd><:= newsdate('<report_date/>') :></dd>
<dt><affectedpackages/>:</dt>
	<dd><packages/></dd>
<dt><vulnerable/>:</dt>
	<dd><vulnerability/></dd>
# This might be done with a ifneq "" tag too if people 
# do not like the <nosecref> here (jfs)
<dt><secdbinfo/>:</dt>
	<dd><secreferences></dd>
<dt><formoreinfo/>:</dt>
	<dd><moreinfo/></dd>
#<ifneq "{#securitybody#}" "" "
<ifneq "<isvulnerable/>" "no" "
<dt><fixedin/>:</dt>
	<dd>{#securitybody#}</dd>
"/>
</dl>

<hrline/>

<:= languages() :>

<hrline/>

{#securitybody#:
