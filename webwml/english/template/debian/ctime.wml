<perl>
use Time::Local;

%dow = (
	en => [ 'Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat' ],
	fi => [ 'Su', 'Ma', 'Ti', 'Ke', 'To', 'Pe', 'La' ],
	pt => [ 'Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb' ],
	hr => [ 'nedjelja', 'ponedjeljak', 'utorak', 'srijeda', 'èetvrtak', 'petak', 'subota' ],
	fr => [ 'Dim', 'Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam' ],
	de => [ 'Sonntag', 'Montag', 'Dienstag', 'Mittwoch', 'Donnerstag', 'Freitag', 'Samstag' ],
	it => [ 'dom', 'lun', 'mar', 'mer', 'gio', 'ven', 'sab' ],
	ja => [ '(Æü)', '(·î)', '(²Ð)', '(¿å)', '(ÌÚ)', '(¶â)', '(ÅÚ)' ],
	pl => [ 'Ni', 'Pon', 'Wt', '¦ro', 'Czw', 'Pt', 'So' ],
	es => [ 'Dom', 'Lun', 'Mar', 'Mie', 'Jue', 'Vie', 'Sab' ],
	da => [ 'S&oslash;n', 'Man', 'Tirs', 'Ons', 'Tors', 'Fre', 'L&oslash;r' ],
	zh => [ '¤é', '¤@', '¤G', '¤T', '¥|', '¤­', '¤»' ],
	sv => [ 'Sön', 'Mån', 'Tis', 'Ons', 'Tor', 'Fre', 'Lör' ],
	ko => [ 'ìí', 'êÅ', 'ûý', 'â©', 'ÙÊ', 'ÐÝ', '÷Ï' ],
);
%moy = (
	en => [ 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',
         'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec' ],
	fi => [ 'tammi', 'helmi', 'maalis', 'huhti', 'touko',
	 'kesä', 'heinä', 'elo', 'syys', 'loka', 'marras', 'joulu' ],
        pt => [ 'Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun',
         'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez' ],
	hr => [ 'sijeènja', 'veljaèe', 'o¾ujka', 'travnja', 'svibnja', 'lipnja',
         'srpnja', 'kolovoza', 'rujna', 'listopada', 'studenog', 'prosinca' ],
	fr => [ 'Jan', 'Fév', 'Mar', 'Avr', 'Mai', 'Jun',
         'Jui', 'Aoû', 'Sep', 'Oct', 'Nov', 'Déc' ],
	de => [ 'Januar', 'Februar', 'M&auml;rz', 'April', 'Mai', 'Juni', 'Juli',
         'August', 'September', 'Oktober', 'November', 'Dezember' ],
	it => [ 'gen', 'feb', 'mar', 'apr', 'mag', 'giu',
         'lug', 'ago', 'set', 'ott', 'nov', 'dic' ],
	ja => [ '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12' ],
	pl => [ 'Sty', 'Lut', 'Mar', 'Kwie', 'Maj', 'Cze',
         'Lip', 'Sie', 'Wrz', 'Pa¼', 'Lis', 'Gru' ],
	es => [ 'Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun',
         'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic' ],
	da => [ 'Jan', 'Feb', 'Mar', 'Apr', 'Maj', 'Jun',
         'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dec' ],
	zh => [ '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12' ],
#	zh => [ '¤@¤ë', '¤G¤ë', '¤T¤ë', '¥|¤ë', '¤­¤ë', '¤»¤ë',
#         '¤C¤ë', '¤K¤ë', '¤E¤ë', '¤Q¤ë', '¤Q¤@¤ë', '¤Q¤G¤ë' ],
	sv => [ 'jan', 'feb', 'mar', 'apr', 'maj', 'jun',
         'jul', 'aug', 'sep', 'okt', 'nov', 'dec' ],
	ko => [ '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12' ],
);
%dateform = (
	hr => '"%s, %2d. %s %s., %02d:%02d:%02d %s", $wday, $mday, $mon, 1900+$year, $hour, $min, $sec, "UTC"',
	zh => '"%s ¦~ %s ¤ë %s ¤é ¬P´Á%s %02d:%02d:%02d %s", 1900+$year, $mon, $mday, $wday, $hour, $min, $sec, "UTC"',
	sv => '"%s %2d %s %s %02d.%02d.%02d %s", $wday, $mday, $mon, 1900+$year, $hour, $min, $sec, "UTC"',
	ja => '"%s Ç¯ %s ·î %s Æü %s %02d:%02d:%02d %s", 1900+$year, $mon, $mday, $wday, $hour, $min, $sec, "UTC"',
);

sub ctime {
	my ($time, $sec, $min, $hour, $mday, $mon, $year, $wday, $yday, $isdst);
	# The last modification time of inputfile in ISO dd-mm-yyyy hh:mm:ss format.
	if (defined $(GEN_TIME)) {
		$WML_GEN_ISOTIME =~ /(..)-(..)-(....) (..):(..):(..)/;
		$time = timelocal($6, $5, $4, $1, $2-1, $3);
	}
	else {
		$WML_SRC_ISOTIME =~ /(..)-(..)-(....) (..):(..):(..)/;
		$time = timelocal($6, $5, $4, $1, $2-1, $3);
	}
	($sec, $min, $hour, $mday, $mon, $year, $wday, $yday, $isdst) = gmtime($time);
	$wday = $dow{$CUR_ISO_LANG}[$wday];
	$mon = $moy{$CUR_ISO_LANG}[$mon];
	$str = defined($dateform{$CUR_ISO_LANG}) ? 
		eval("sprintf($dateform{$CUR_ISO_LANG})") :
		sprintf("%s, %s %2d %02d:%02d:%02d %s 19%s",
			$wday, $mon, $mday, $hour, $min, $sec, "UTC", $year);
	return $str;
}
</perl>


