
# Generic source to add HTML links to common
# vulnerability databases

<perl>
sub bid_secref {
 	my $refstr = shift(@_);
	my $bid = "";
	foreach $ref (split(' ',$refstr)) { 
		if ( $ref =~ /BID(\d+)/i ) {
			my $id = $1;
			$bid .= ", " if $bid ne "";
			$bid .= "<a href=\"http://online.securityfocus.com/bid/".$id."\">BugTraq ID ".$id."</a>"; 
		}
	}
	return $bid;
}
sub cve_secref {
 	my $refstr = shift(@_);
	my $cve = "";
	foreach $ref (split(' ',$refstr)) { 
		if ( $ref =~ /((CVE|CAN)-[\d-]+)/i ) {
			my $id = $1;
			$cve .= ", " if $cve ne "";
			$cve .= "<a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=".$id."\">".$id."</a>";
		}
	}
	return $cve;
}

sub cert_secref {
 	my $refstr = shift(@_);
	my $cert = "";
	foreach $ref (split(' ',$refstr)) { 
		if ( $ref =~ /(CA-[\d-]+)/i ) {
			my $id = $1;
			$cert .= ", " if $cert ne "";
			$cert .= "<a href=\"http://www.cert.org/advisories/".$id.".html\">".$id."</a>";
		}
		if ( $ref =~ /VU#(\d+)/i ) {
			my $id = $1;
			$cert .= ", " if $cert ne "";
			$cert .= "<a href=\"http://www.kb.cert.org/vuls/id/".$id."\">VU#".$id."</a>";
		}
	}
	return $cert;
}

sub security_references {
 	my $refstr = shift(@_);
	my $str = "";
	my $bid = "";
	my $cve = "";
	$bid = bid_secref($refstr);
	$cve = cve_secref($refstr);
	$cert = cert_secref($refstr);
	$str .= "<bugtraq> $bid.<br>"  if $bid ne "";
	$str .= "<cve> $cve.<br>"  if $cve ne "";
	$str .= "<cert> $cert.<br>"  if $cert ne "";
	$str = "<nosecref>" if $str eq "";
	return $str;
}
</perl>

<define-tag secreferences>
  <:= security_references("<secrefs>") :>
</define-tag secreferences>
