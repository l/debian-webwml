#use wml::sup::path
<perl>

# Do not translate the directory names
#             Directory     Abbrev Language
my %langs = ("english"  => ["en", "English"],
             "danish"   => ["da", "Danish"],
             "french"   => ["fr", "French"],
             "german"   => ["de", "German"],
             "italian"  => ["it", "Italian"],
             "spanish"  => ["es", "Spanish"],
             "korean"   => ["kr", "Korean"],
             "japanese" => ["ja", "Japanese"],
             "croatian" => ["hr", "Croatian"]);

sub languages {
  # my ($base_url, $file, $cur_lang) = @_;
  my $str = "";

  $base_url = "$(HOME)";
  $file = "$(WML_SRC_BASENAME)";
  $cur_lang = "$(CUR_LANG)";
  $cwd = `pwd`;
  $full_base_url = &canonpath("$cwd/$base_url");
  $rel_dir = &relpath($full_base_url, $cwd);
  chop $rel_dir; chop $rel_dir;

  # printf STDERR "base=$base_url rel_dir=$rel_dir file=$file cur_lang=$cur_lang\n";

  foreach(keys %langs) {
     # printf STDERR "$base_url/../$_/$rel_dir/$file.wml\n";
     if ( -f "$base_url/../$_/$rel_dir/$file.wml" ) {
        if ($_ ne lc($cur_lang)) {
           push @used_langs, $_;
           # printf STDERR "found file in $_\n";
        }
     }
  }
  # printf STDERR join(', ', @used_langs);
  if (@used_langs) {
     $str = "<hr>\nThis page is also available in the following languages:<BR>\n";
     foreach (@used_langs) {
        $str .= "<a href=\"$file.html.$langs{$_}[0]\">$langs{$_}[1]</a>&nbsp;\n";
     }
     $str .= "\n<BR><a href=\"$base_url/intro/cn.html.en\">How to set the ".
             "default document language</a>\n";
  }

  return $str;
}

</perl>
