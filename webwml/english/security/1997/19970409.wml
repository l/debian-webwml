#!wml -o ../../../../debian.org/security/1998/%BASE.html.en
<define-tag pagetitle>metamail</define-tag>
<define-tag report_date>09 Apr 1997</define-tag>
<define-tag packages>metamail</define-tag>
<define-tag description>It may be possible to make metamail execute arbitrary commands</define-tag>
<define-tag vulnerable><FONT COLOR=00FF00>No</FONT></define-tag>
<define-tag fixed></define-tag>
#use wml::debian::basic title="Debian GNU/Linux &mdash; <pagetitle>"
#use wml::debian::security

<blockquote>
<b>From: Alan Cox &lt;alan@cymru.net&gt;</b> <br>
<b>Date: Wed, 9 Apr 1997 10:58:48 +0100 (BST)</b> <p>

This appears to be a tcsh bug, but it shows up with metamail and can
be abused. Olaf's message follows below. I've also passed it on to CERT <p>

Alan Cox <p>

<hr>

Hi Alan, <p>

Here's the info on metamail I promised to send you. The hole may be
exploitable if you let metamail run showext for messages of type
message/external-body. At least tcsh, and possily a few other csh's,
do seem to do weird things when expanding command line arguments.
If you give a script an argument of "foo FTP=/tmp/evilcmd", and it
does <p>

<pre>
	set var=$1
</pre>

this will assign foo to $var, and /tmp/evilcmd to $FTP. Unfortunately,
metamail invokes showext with the mime attributes on the command line,
so you basically send it a header like this <p>

<pre>
   Content-type:  message/external-body;
	   access-type="anon-ftp";
	   name="passwd";
	   site="monad.swb.de";
	   directory="/etc";
	   mode="image FTP=/tmp/evilcmd"
</pre>

Further below, the script will run $FTP to initiate the ftp connection.
Up to now, I have not been able to pass arguments to the command, but
that doesn't mean that you can't do interesting things with the above. <p>

Patch removed due to age.<p>

Cheers
Olaf <p>
<hr>
<pre>
Olaf Kirch         |  --- o --- Nous sommes du soleil we love when we play
okir@monad.swb.de  |    / | \   sol.dhoop.naytheet.ah kin.ir.samse.qurax
okir@lst.de        +-------------------- Why Not?! -----------------------
</pre>
<hr>

</blockquote>

<:= languages ("$(HOME)", "security", "$(WML_SRC_BASENAME)", "$(CUR_LANG)") :>

<HR>
#use wml::debian::footer
