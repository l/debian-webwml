#!wml -o ../../../../debian.org/security/1997/%BASE.html.en
<define-tag pagetitle>php</define-tag>
<define-tag report_date>16 Apr 1997</define-tag>
<define-tag packages>php</define-tag>
<define-tag description>There is a vulnerability in PHP/FI, a NCSA httpd cgi enhancment</define-tag>
<define-tag isvulnerable>no</define-tag>
<define-tag fixed>php 2.0b10-4</define-tag>
#use wml::debian::basic title="Debian GNU/Linux &mdash; <pagetitle>"
#use wml::debian::security

<I>Note:  php was not in Debian at the time of this report.  All releases with php will include the fix</I>

<blockquote>
<b>Date: 	Wed, 16 Apr 1997 21:01:12 -0400</b><br>
<b>From: Shamanski &lt;jshaman@m-net.arbornet.org&gt;</b><p>

<hr>
[DiS] Advisory 97-347.1<br>
Issue date: April 16, 1997<br>
Topic:  REMOTE Vulnerability in PHP/FI<br>
<hr>

A vulnerability has been found by DiS in PHP/FI, a NCSA httpd cgi enhancment.
This vulnerability allows unauthorized users to view arbitrary file contents
on the machine running httpd by sending the file name wishing to be displayed
as the QUERY_STRING. <p>

<ol>
<li> Exploit

   simply use any web browser to send the following URL:

   http://boogered.system.com/cgi-bin/php.cgi?/file/to/view

   Note: this exploit has not been tested on a system that has compiled
         PHP/FI as an apache module. This information may or may not
         be applicable on such a system.

<li> Impact

    Remote, unauthorized users can view arbitrary file contents on the
    system with the same privileges as the httpd (HTTP daemon) child process.


<li> Solution

    The author has propsed the following sollution:

    <em>
    ...The workaround is to set the following in php.h<p>

    #define PATTERN_RESTRICT ".*\\.phtml$"<p>

    This will limit the php.cgi parser to only display files ending in .phtml <p>

    The exact same adviasory applies to any other parser someone might decide
    to stick in their cgi-bin directory.  This is in no way specific to PHP/FI. <p>

    You can also avoid the problem by using either CGI redirection or
    by using the Apache module version. <p>

    -Rasmus
    </em>
</ol>

The current PHP/FI distribution may be obtained from <a href="http://www.php.net/">http://www.php.net/</a> <p>

<hr>
J-Man Th' Shaman [DiGiTAL iNFORMATiON SOCiETY]<br>
<a href="mailto:jshaman@m-net.arbornet.org">jshaman@m-net.arbornet.org</a><br>
<a href="mailto:jamin@avatar.ml.org">jamin@avatar.ml.org</a><p>
<hr>
</blockquote>

<:= languages ("$(HOME)", "security", "$(WML_SRC_BASENAME)", "$(CUR_LANG)") :>

<HR>
#use wml::debian::footer
