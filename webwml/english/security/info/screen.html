
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
<TITLE>Debian GNU/Linux - Security Information</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso-8859-1">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
</HEAD>

<BODY BGCOLOR="#FFFFFF">
<H1><IMG SRC="../../Pics/debian.jpg" WIDTH=114 HEIGHT=140 ALIGN="middle" ALT="Debian GNU/Linux - ">Security Information</H1>
<HR>
Debian takes security very seriously.  Most <a href="../index.html">security problems</a> brought
to our attention are corrected within 48 hours.

<P> Please send security-related bug reports to <a href="mailto:security@debian.org">security@debian.org</a><P>

<blockquote>
<b>Date: 	Thu, 20 Feb 1997 21:23:31 -0500</b> <br>
<b>From: Khelbin &lt;khelbin@connix.com&gt;</b> <p>

Screen 3.07.02, when setuid root (as it usually is), is possibly to a
buffer overflow at least on certain platforms.  I havn't read through all
the source but just looking quickly I noticed that attacher.c does the
following: <p>

<pre>
      struct passwd ppp;
      char fullname[100];

      strcpy(fullname, ppp->pw_gecos);
</pre>

I was able to whip up a quick exploit but it failed to work here on BSDI
1.1 because chpass/chfn will not except certain characters.  Thus, reading
in shellcode into the Ful Name field produced an error message of "Illegal
Character found in the Full Name field,  re-edit [y]?" or something
similar. <p>

Any OS or version of chfn/chpass which does not check for 'illegal
characters' or the length of the info being put into the field (BSDI 1.1
did not check length, only for illegal characters) may be vulnerable (i
didn't check if it had given up suid root privs yet, i was going to do
that by overflowing it with my shellcode string). <p>

If anyone can check on different platforms and get back to me, I'd be
interested.  What I was doing was just putting my shellcode string into an
ENV variable (with the NOPs and ret address back to the NOPs) and echoing
the ENV variable to a file.  Then just read in that file when yer in
chpass/chfn as the new gecos info. <p>

I really didn't take much time in looking through the code and found a
possible problem so I'm sure there's more.  Screen is a pretty big program
for being suid root and that old advice of not running programs you don't
need, especially suid ones, is always true. <p>

</blockquote>

<P><SMALL>Last Modified: 10 Jan 1998.
Copyright &copy;1997 SPI; See
<A HREF="../../license.html">license terms.</A></SMALL>
<HR>
</BODY>
</HTML>


