#use wml::debian::cdimage title="Jak stworzyæ serwer lustrzany z obrazami p³yt Debiana" BARETITLE=true
#use wml::debian::toc
#use wml::debian::translation-check translation="1.11"

<p>
     Stworzenie serwera lustrzanego z obrazami p³yt instalacyjnych
     Debiana wymaga posiadania Linuksa lub innego uniksowego systemu
     ze sta³ym, solidnym ³±czem do Internetu. Serwery lustrzane Debiana
     przechowuj± ró¿nych rozmiarów obrazy <tt>.iso</tt> p³yt CD i DVD,
     pliki programu <a
     href="http://atterer.net/jigdo/">jigdo</a> (<tt>.jigdo</tt> oraz
     <tt>.template</tt>), pliki <a
     href="http://bitconjurer.org/BitTorrent/">BitTorrenta</a>
     (<tt>.torrent</tt>), jak równie¿ sumy MD5 obrazów
     (<tt>MD5SUMS*</tt>).</p>

<toc-display/>

<hr>

<toc-add-entry name="master">Serwer g³ówny</toc-add-entry>

<p>Istniej± dwia miejsca wymagaj±ce serwerów lustrzanych - jedno dla
obrazów stabilnych, drugie dla obrazów beta/niestabilnych/testowych.
Poni¿ej s± podane URLe serwerów g³ównych - <strong>prosimy</strong> jednak
o rozwa¿enie mo¿liwo¶ci pobierania plików z innego, pobliskiego serwera
lustrzanego (ich lista: <a
href="../http-ftp/">HTTP/FTP</a>, <a href="rsync-mirrors">rsync</a>), je¶li
to tylko jest mo¿liwe. W trakcie wydawanie kolejnej wersji dystrybucji, dostêp
do serwerów g³ównych mo¿e byæ oraniczony.</p>

<p>Nale¿y byæ ¶wiadomym tego, ¿e w podanych katalogach znajduje siê
<strong>baardzo</strong> du¿o danych. <a href="#exclude">Poni¿ej</a> znajduj±
siê szczegó³y na temat ograniczenia zajmowanej przestrzeni dyskowej poprzez
pominiêcie poieranie pewnych plików.</p>

<ul>

  <li>Obrazy dystrybucji stabilnej (uaktualnienia wraz z ka¿dym wydaniem):<br>

    <a href="http://cdimage.debian.org/debian-cd/"
    ><tt>http://cdimage.debian.org/debian-cd/</tt></a><br>

    <a href="ftp://cdimage.debian.org/debian-cd/"
    ><tt>ftp://cdimage.debian.org/debian-cd/</tt></a><br>

    <tt>rsync://cdimage.debian.org/debian-cd/</tt>

  </li>

  <li>Obrazy beta/niestabilne/testowe (wiêkszo¶æ uaktualniana co tydzieñ):<br>

    <a href="http://cdimage.debian.org/pub/cdimage-testing/"
    ><tt>http://cdimage.debian.org/pub/cdimage-testing/</tt></a><br>

    <a href="ftp://cdimage.debian.org/pub/cdimage-testing/"
    ><tt>ftp://cdimage.debian.org/pub/cdimage-testing/</tt></a><br>

    <tt>rsync://cdimage.debian.org/cdimage-testing/</tt>

  </li>
</ul>
#______________________________________________________________________
<toc-add-entry name="httpftp">Pobierania przy u¿yciu HTTP/FTP jest odradzane</toc-add-entry>

<p>
     Nie powinno siê u¿ywaæ FTP ani HTTP do aktualizowania serwera lustrzanego.
     Te metody przesy³ania obarczone s± wysokim ryzykiem niepowodzenia,
     z uwagi na ogromny rozmiar plików.
</p>

<p>
     Ponadto, HTTP i FTP nie pozwalaj± na sprawdzanie integralno¶ci ¶ci±gniêtych
     danych, przez co prawdopodobieñstwo niezauwa¿enia przerwanych transferów
     lub uszkodzeñ plików jest znacznie wiêksze.
</p>
#______________________________________________________________________
<toc-add-entry name="download">Pobieranie przy pomocy rsync jest dopuszczalne</toc-add-entry>

<p>Program <a href="http://rsync.samba.org/"><kbd>rsync</kbd></a>
jest dobrym rozwi±zaniem problemu uaktualniania serwerów lustrzanych.
Jest on mniej wydajny od innego, specyficznego dla Debiana uaktualnienia,
ale jest ³atwiejszy do konfiguracji. Ponadto, <kbd>rsync</kbd> daje pewno¶æ,
¿e wszystkie pliki s± przesy³ane poprawnie, a dodatkowe dane (takie czas
czas utworzenia itp.) s± zachowywane tak samo, jak w³a¶ciwe dane pliku.
</p>

<p>Przeczytaj <a href="#exclude">Wy³±czanie plików z aktualizacji</a>,
aby zapoznaæ siê z przyk³adami u¿ycia opcji <kbd>--include</kbd> oraz
<kbd>--exclude</kbd>. <a href="rsync-mirrors">Lista serwerów rsync</a>
jest dostêpna na oddzielnej stronie.</p>

<p>Powinno siê u¿ywaæ przynajmniej tych opcji:
<strong><kbd>--times --links --hard-links --partial --block-size=8192</kbd></strong>.
To zachowa czas modyfikacji, dowi±zania (tak¿e symboliczne) oraz
wymusi u¿ycie bloku o rozmiarze 8192 bajtów (najbardziej
efektywne dla obrazów p³yt). Gdy czas modyfikacji oraz rozmiar
nie ulegn± zmianie, <kbd>rsync</kbd> pominie ten plik,
wiêc parametr <kbd>--times</kbd> jest naprawdê konieczny.</p>
#______________________________________________________________________

<toc-add-entry name="jigdolite">Tworzenie luster przy pomocy jigdo-lite jest odradzane</toc-add-entry>

<p>Ostatnie wersje <a
href="http://atterer.net/jigdo/"><kbd>jigdo-lite</kbd></a> obs³uguj±
wsadowe pobieranie wielu obrazów. Zalecamy jednak u¿ycie <kbd>jigdo-mirror</kbd>
zamiast <kbd>jigdo-lite</kbd> do tworzenia luster p³yt CD Debiana.</p>
#______________________________________________________________________

<toc-add-entry name="jigdomirror">Tworzenie luster przy pomocy jigdo-mirror jest zalecan</toc-add-entry>

<p>W³a¶ciwie to znaczy: tworzenie obrazów <tt>.iso</tt> przy pomocy
<a href="http://atterer.net/jigdo/"><kbd>jigdo-mirror</kbd></a>, nastêpnie
(je¶li równie¿ chcesz pobieraæ inne typy plików, np. <tt>.jigdo</tt>
i <tt>.template</tt>) uruchomienie rsync w danym katalogu, aby doci±gn±æ
resztê plików. Skrpty z <a
href="http://www.acc.umu.se/~maswam/debian-push/cdimage">tej strony</a>
mog± okazaæ siê pomocne.</p>

<p>
     Wielu ludzi utrzymuje &#8222;regularne&#8221; kopie lustrzane
     Debiana (<kbd>debian/</kbd>), lub po prostu ma dostêp do takiej
     kopii w pobli¿u. Oznacza to, ¿e maj± ju¿ pliki <tt>.deb</tt>, które
     wchodz± w sk³ad obrazów p³yt. Oczywistym pytaniem jest wiêc: Dlaczego
     by nie u¿yæ tych samych plików do tworzenia obrazów p³yt?
</p>

<p>
     <kbd>jigdo-mirror</kbd> to program, który umo¿liwia tworzenie
     obrazów p³yt z u¿yciem plików dostêpnych w &#8222;normalnej&#8221;
     kopii lustrzanej oraz kilku dodatkowych plików tworz±cych szablon
     jigdo.
</p>

<p>
     Na sam pocz±tek, potrzebne s± pliki szablonu jigdo.
     Mo¿na je znale¼æ na wiêkszo¶ci oficjalnych stron, jednak¿e
     dwie podstawowe lokalizacje to:
</p>

<ul compact>
     <li><kbd>rsync us.cdimage.debian.org::jigdo-area/</kbd> (USA)
     <li><kbd>rsync non-us.cdimage.debian.org::debian-jigdo/</kbd> (Europa)
</ul>

<p>
     Nale¿y pobraæ pliki z podkatalogu:
     &lt;<var>version</var>&gt;/jigdo/&lt;<var>architecture</var>&gt;
     dla ka¿dej z architektur sprzêtowych, dla jakiej maj± powstaæ
     obrazy p³yt.
</p>

<p>
     Teraz trzeba utworzyæ plik <kbd>~/.jigdo-mirror</kbd>
     w celu konfiguracji programu. Oto przyk³ad:</p>

<pre>
     jigdoDir="/gdzie/s±/kopie/lustrzane/p³yt-debiana/current/jigdo"
     imageDir="/gdzie/s±/kopie/lustrzane/p³yt-debiana/current/images"
     tmpDir="/gdzie/s±/kopie/lustrzane/p³yt-debiana/current/images"
     debianMirror="file:/gdzie/s±/kopie/lustrzane/debiana/"
     nonusMirror="file:/gdzie/s±/kopie/lustrzane/debiana-non-US"
     include='i386/|sparc/|powerpc/|source/'; exclude='-1\.'
</pre>

<p>
     Zmienne <i>include</i> oraz <i>exclude</i> zawieraj± listê
     (a raczej wyra¿enia regularne j± opisuj±ce) architektur
     dla których maj± powstaæ obrazy. Wiêcej informacji na ten temat
     mo¿na znale¼æ na stronach podrêcznika systemowego po¶wiêconych
     programowi <kbd>jigdo-mirror</kbd> oraz w jego ¼ród³ach
     (to skrypt pow³oki systemowej z du¿± ilo¶ci± komentarzy)
</p>

<p>
     Po konfiguracji, wystarczy po prostu uruchomiæ <kbd>jigdo-mirror</kbd>
     i wszystko zostanie wykonane automatycznie. Powstanie sporo plików
     oraz prawdopodobnie zabierze to wiele czasu, wiêc warto pomy¶leæ
     na przyk³ad o uruchomieniu tego zadania w sesji screena lub
     przekierowaniu standardowego wyj¶cia do pliku.
</p>
#______________________________________________________________________

<toc-add-entry name="pushmirror">Jak zostaæ tzw. serwerem lustrzanym push</toc-add-entry>

<p>Gdy tylko nowe obrazy stan± siê dostêne, serwer g³ówny mo¿e wys³aæ wiadomo¶æ
do swoich serwerów lustrzanych i zmusiæ je do natychmiastowego rozpoczêcia
aktualizacji. W ten sposób nowe dane s± "wpychane" (ang. push), a nie "pobierane"
przez serwery lustrzane podczas swoich dziennych aktualizacji. Technika ta
pozwala na znacznie szybsz± propagacjê wydañ nowych obrazów.</p>

<p>Je¶li chcesz, aby Twój serwer lustrzany by³ czê¶ci± tego systemu,
zapoznaj siê z <a href="http://www.acc.umu.se/~maswan/debian-push/cdimage/">t±
stron±</a>.</p>
#______________________________________________________________________

<toc-add-entry name="exclude">Wy³±czanie plików z aktualizacji</toc-add-entry>

<p>Aby zmniejszyæ wymagan± przez serwer lustrzany Debiana przestrzeñ dyskow±,
mo¿esz wykluczyæ pewne pliki z aktualizacji. Poni¿sze instrukcje
zawieraj± opcje programy <kbd>rsync</kbd>, ale mog± te¿ siê przydaæ
w przypadku korzystania z innego narzêdzia. W programie <kbd>rsync</kbd>
opcje <kbd>--include</kbd> i <kbd>--exclude</kbd> s± przetwarzane
w kolejno¶ci, w jakiej siê pojawiaj± w linii poleceñ - pierwsza opcja,
której wzorzec pasuje okre¶la, czy plik zostanie wy³±czony czy do³±czony.</p>

<ul>

  <li><strong>Wykluczenie kodów ¼ród³owych:</strong>
  <kbd>--exclude=source/</kbd><br>

  Obrazy zawieraj±ce kod ¼ród³owy nie bêd± pobierane. Zauwa¿, ¿e
  pewne osoby uwa¿aj± za wysoce niew³a¶ciwe udostêpnianie tylko
  kodów binarnych programów na licencji GPL bez umieszczenia
  kodów ¼ród³owych na <em>tym samym serwerze</em>.</li>

  <li><strong>Wykluczenie pe³nych obrazów:</strong>
  <kbd>--include='*businesscard*.iso' --include='*netinst*.iso'
  --exclude='*.iso'</kbd><br>

  Powy¿sze wykluczy wszystkie, pe³ne zestawy obrazów CD/DVD
  na wszystkie architektury, <em>ale</em> do³±czy obrazy
  <tt>.iso</tt> business-card-sized i net-install. Zalecamy
  pobieranie tych obrazów w ka¿dym przypadku - z powodu swoich
  ma³ych rozmiarów s± wysoce przydatne!</li>

  <li><strong>Wykluczenie pe³nych obrazów dla architektur innych ni¿ i386:</strong>
  <kbd>--include='*businesscard*.iso' --include='*netinst*.iso'
  --include='i386/**.iso' --exclude='*.iso'</kbd><br>

  Jak wy¿ej, ale <em>do³±cza</em> wszystkie obrazy CD/DVD dla architektury
  i386.</li>

  <li><strong>Wykluczenie pe³nych obrazów, poza p³ytami od 1 do 3 na
  architekturê i386:</strong>
  <kbd>--include='*netinst*.iso' --include='i386/**-[1-3].iso'
  --exclude='*.iso'</kbd><br>

  Pe³ny zestaw obrazów na i386 nadal mo¿e zajmowaæ za du¿o miejsca, je¶li
  znajduj± siê w nim obrazy DVD i obrazy dwuwarstwowych DVD. Wy³±czy to
  wszystkie obrazy <tt>.iso</tt> poza obrazem net-install i trzema pierwszymi
  p³ytami CD na i386.</li>

  <li><strong>Wy³±cz wszystkie architektury poza i386:</strong>
  <kbd>--exclude=alpha/ --exclude=arm/ --exclude=hppa/ --exclude=hurd/
  --exclude=ia64/ --exclude=m68k/ --exclude=mips/ --exclude=mipsel/
  --exclude=powerpc/ --exclude=s390/ --exclude=sh/
  --exclude=sparc/</kbd><br>

  Do³±cza tylko pe³ny zestaw plików na i386, poza plikami <tt>.jigdo</tt>,
  <tt>.iso</tt> etc. na inne architektury.</li>

</ul>
#______________________________________________________________________

<toc-add-entry name="names">Konwencje nazewnictwa i wymagania co do rozmiarów
obrazów <tt>.iso</tt></toc-add-entry>

<p>Ró¿ne odmiany obrazów <tt>.iso</tt> s± rozpoznawalne za pomoc± ich nazw,
dziêki czemu mo¿esz dok³adnie okre¶liæ typy obrazów, które chcesz pobieraæ:</p>

<ul>

  <li><strong><tt>*-businesscard.iso</tt></strong>: jeden obraz
  na ka¿d± <a href="/ports/#released">obs³ugiwan± architekturê</a>,
  50&nbsp;MB</li>

  <li><strong><tt>*-netinst.iso</tt></strong>: jeden obraz
  na ka¿d± architekturê, 110&nbsp;MB</li>

  <li><strong><tt>*-dvd.iso</tt></strong> (jednowarstwowe DVD):
  Kilka obrazów tylko na i386, ka¿dy po maks. 4482&nbsp;MB.
  Dla sarge, skumulowany rozmiar obrazów i386 wynosi oko³o
  9000&nbsp;MB.</li>

  <li><strong><tt>*-dldvd.iso</tt></strong> (dwuwarstwowe DVD):
  jak wy¿ej; poszczególne obrazy zajmuj± do 8106&nbsp;MB.
  Dla sarge nie ma obrazów <tt>.iso</tt> - jedynie pliki jigdo.</li>

  <li><strong><tt>*.iso</tt></strong>: wszystkie pozosta³e pliki <tt>.iso</tt>,
  które nie mieszcz± siê w powy¿szych kategoriach s± obrazami CD.
  Istnieje wiele obrazów na ka¿d± architekturê, ka¿dy obraz zajmuje
  do 650&nbsp;MB. Ca³kowity rozmiar wszystkich obrazów i architektur
  jest równy <a href="/mirror/size">rozmiarowi ca³ego serwera lustrzanego
  Debiana</a> (w trakcie pisania by³o to 100&nbsp;GB).</li>

</ul>
#______________________________________________________________________

<toc-add-entry name="register">Rejestrowanie kopii lustrzanej</toc-add-entry>

<p>
     Aby uczyniæ kopiê dostêpn± dla szerszej publiczno¶ci,
     mo¿na zarejestrowaæ j± na li¶cie takiej jak
     <a href="../http-ftp/">ta</a> lub <a href="rsync-mirrors">ta</a>.
     Nale¿y pamiêtaæ, ¿e pe³ne obrazy s± du¿ymi plikami i
     upublicznienie wiadomo¶ci o kopii lustrzanej mo¿e spowodowaæ
     ruch sieciowy siêgaj±cy wielu gigabajtów dziennie.
</p>

<p>
     Kopiê lustrzan± mo¿na zarejestrowaæ poprzez wype³nienie
     <a href="$(HOME)/mirror/submit">tego formularza</a>
     (pola: CDImage-* s± jednymi z wa¿niejszych) lub poprzez
     wys³anie zawiadomienia na adres:
     <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;debian-cd&#64;lists.debian.org">\
     debian-cd&#64;lists.debian.org</a>.
</p>

<p>
     Wysoko cenimy wszystkie nowe kopie lustrzane obrazów p³yt Debiana.
     Z góry dziêkujemy!
</p>
