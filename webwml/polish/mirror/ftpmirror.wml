#use wml::debian::template title="Stawianie serwera lustrzanego archiwów Debiana"
#use wml::debian::toc
#include "$(ENGLISHDIR)/releases/woody/release.data"
#use wml::debian::translation-check translation="1.40"

<toc-display/>

<p>Po postawieniu serwera lustrzanego, nale¿y go <a href="submit">zarejestrowaæ
w Debianie</a>, dziêki czemu zostanie on wymieniony na <a href="list">li¶cie
serwerów lustrzanych</a>. Zg³oszenia mog± siê odbywaæ za pomoc± <a
href="submit">prostego formularza</a>.

<p>Je¶li masz problemy lub pytania pisz na adres <email mirrors@debian.org>.</p>

<toc-add-entry name="what">Co kopiowaæ?</toc-add-entry>

<p><a href="./">Strona g³ówna serwerów lustrzanych</a> zawiera listê
archiwów, które mog± byæ umieszone na serwerach lustrzanych.
<br>
U¿ytkowników zainteresuje archiwum debian/ do instalacji Debiana
przez sieæ, budowania p³yt CD (za pomoc± jigdo) lub uaktualniania
ju¿ zainstalowanego systemu. Osoby zainteresowane kilkoma pakietami
niedostêpnymi dla serwerów lustrzanych w Stanach Zjednoczonych zajrz±
do katalogu debian-non-US/.
<br>
Archiwum debian/ jest bardzo du¿e w porównaniu z bardzo ma³ym archiwum
debian-non-US/. Zajrzyj na stronê <a href="size">z rozmiarami archiwów</a>,
gdzie znajdziesz dok³adniejsze dane.</p>

<p>NB: archiwum debian-non-US/ <strong>nie</strong> nadrzêdne w stosunku
do archiwum debian/, lecz raczej dodatkiem do niego.</p>

<p>debian-cd/ to archiwum, które nie jest identyczne na wszystkich
serwerach lustrzanych. Niektóre z nich zawieraj± szablony jigdo do
budowy obrazów CD (u¿ywanych razem z plikami z debian/). Inne zawieraj±
ju¿ gotowe obrazy p³yt, a na jeszcze innych znajdziesz obie mo¿liwo¶ci.
<br>
Wiêcej informacji na ten temat znajdziesz na stronie <a
href="$(HOME)/CD/mirroring/">Jak stworzyæ serwer lustrzany z obrazami
p³yt Debiana</a>.</p>

<p>debian-archive/ zawiera w³a¶ciwe <em>archiwum</em>, czyli starsze
i przestarza³e wersje Debiana. Zazwyczaj przeznaczone tylko dla niewielkiej
grupy osób.</p>

<p>Archiwum debian-security/ zawiera uaktualnienia bezpieczeñstwa wydane
przez grupê ds. bezpieczeñstwa Debiana. Brzmi to zachêcaj±co dla ka¿dego,
jednak z powodu rzadkiego pojawiania siê takich aktualizacji, nie trzeba
kopiowaæ tego archiwów zbyt czêsto by byæ na czasie (mo¿na te¿ wykorzystaæ
technikê <a href="push_mirroring">push mirroring</a>), dlatego tego nie
zalecamy. Jednak za to, Debiana stara siê zapewniæ jak najwiêksz± dostêpno¶æ
serwera security.debian.org.</p>

<toc-add-entry name="wherefrom">Sk±d pobieraæ dane</toc-add-entry>

<p>Wiele osób uwa¿a, ¿e <code>ftp.debian.org</code> jest g³ównym serwerem
pakietów Debiana i ¿e to w³a¶nie z niego nale¿y pobieraæ dane. <strong>Nie
jest to prawd±</strong>. <code>ftp.debian.org</code> jest po prostu jednym
z wielu serwerów pobieraj±cych dane z wewnêtrznego serwera Debiana.</p>

<p>Ka¿dy z wymienionych serwerów na <a href="list-full">pe³nej li¶cie
serwerów lustrzanych</a> maj±cych znacznik '<kbd>Type: Push-Primary</kbd>'
mo¿e pe³niæ funkcjê serwera, z którego maj± byæ pobierane dane przez inne
serwery lustrzane.</p>

<p>Je¶li chodzi o sam± zawarto¶æ serwerów, to nie ma ró¿nicy pomiêdzy serwerami
oznaczonymi jako <em>Push-Primary</em>. Z drugiej strony, je¶li wiele
osób korzysta z ftp.debian.org (a niestety korzysta), to niepotrzebnie jest
marnowana darowana przepustowo¶æ.</p>

<toc-add-entry name="how">W jaki sposób pobieraæ dane</toc-add-entry>

<p>Zalecan± metod± pobierania danych jest u¿ycie
<a href="http://packages.debian.org/stable/net/rsync">rsync</a>.</p>

<p>Uwaga: <kbd>wget</kbd> jest dobry dla tworzenia serwerów lustrzanych ma³ych
serwisów. Jednak poniewa¿ nie jest on tak konfigurowalny jak rsync odradzamy
jego stosowanie.</p>

<h3>Anonimowy rsync</h3>

<p>Aby pobraæ archiwum mo¿esz u¿yæ <a href="anonftpsync">tego skryptu</a>.
W skrypcie znajduj± siê wskazówki konfiguracji pobierania danych.

<p>Je¶li wolisz korzystaæ z innego sposobu:

<ul>
  <li>Uruchamiaj rsync przynajmniej z tymi opcjami: <kbd>--recursive --times
      --links --hard-links --delete</kbd>.

  <li>Je¶li posiadasz dodatkow± przestrzeñ dyskow±, u¿yj równie¿ opcji
      <kbd>--delete-after</kbd> by unikn±æ problemów aktualizacji.

  <li>Je¶li masz za ma³o miejsca, by pobraæ wszystko, u¿yj opcji
      <kbd>--exclude</kbd>, by wy³±czyæ czê¶æ archiwum z pobierania
      Zazwyczaj wstawia siê tu ró¿ne architektury, które nas nie interesuj±.
      Poni¿szy przyk³ad wy³±cza z pobierania <em>wszystkie</em> architektury:
      <br>
<: 
print "<code>--exclude binary-$_/ --exclude *_$_.deb</code><br>\n"
  foreach (sort keys %arches);
:>
      Przeczytaj te¿ <a href="#partial">rozdzia³ o tworzeniu czê¶ciowego
      serwera lustrzanego</a>.

  <li>Gdy rsync zakoñczy pracê, dodaj plik ze znacznikiem czasu o nazwie
      twojego serwera w katalogu <code>project/trace/</code> na serwerze
      lustrzanym Debiana. Oznacza to, ¿e po zakoñczeniu codziennej pracy
      rsynca masz wykonaæ
      <kbd>date -u &gt; .../debian/project/trace/<var>twój.serwer</var></kbd>,
      a po zakoñczeniu pracy rsynca w non-US (je¶li równie¿ pobierasz
      debian-non-US):
      <kbd>date -u &gt; .../debian-non-US/project/trace/<var>twój.serwer</var></kbd>
</ul>

<h3>Rsync z uwierzytelnianiem, z serwera typu push</h3>

<p><q>Push mirroring</q> jest metod± podobn± do u¿ycia rsync, któr± stworzyli¶my</a>
by skróciæ czas rozpowszechniania w¶ród serwerów lustrzanych wszelkich zmian.
Serwer ³±czy siê przez ssh, by powiedzieæ klienckiemu serwerowi lustrzanemu,

by ten dokona³ aktualizacji.

<p><q>Push mirroring</q> jest niezbêdne do utrzymania w pe³nej synchronizacji</a>
wielu serwerów (takich jak serwery o okrê¿nych aliasach DNA w stylu
<tt>ftp.us.debian.org</tt>) i czêsto go u¿ywamy dla serwerów lustrzanych
pierwszego i drugiego rzêdu. Dla <q>zwyk³ych</q> serwerów lustrzanych, ta metoda</a>
wymaga zbyt du¿o wysi³ku wymaganego do skonfigurowania, a który zazwyczaj
nie jest tego wart w porównaniu do dobrze zaplanowanej pracy crona.</p>

<p>Ta metoda jest dosyæ bezpieczena, poniewa¿ ssh jest konfigurowany do
zezwolenia na wykonywanie tylko jednego polecenia. Samo ¶ci±ganie danych
odbywa siê w ten sam sposób, wiêc <strong>nie</strong> jest mo¿liwe
uszkodzenie zawarto¶ci archiwum przez fa³szywy serwer push. Niektórzy
administratorzy serwerów okazuj± niechêæ wobec tej metody z powodu obaw,
¿e otwiera to ich maszyny na ataki z zewn±trz. <strong>Nie</strong> jest to
prawd±.

<p>Bardziej szczegó³owy opis dzia³ania, dlaczego jest to bezpieczne oraz
jako skonfigurowaæ serwer push znajduje siê w <a href="push_mirroring">pe³nym
wyja¶nieniu</a>.

<h3>Anonimowe FTP</h3>

<p>Anonimowe FTP przez d³ugi czas by³o najczê¶ciej stosowan± metod±
pobierania danych przez serwery lustrzne, ale zosta³o wyparte przez rsync.</p>

<p>Je¶li z jakiego¶ powodu nie mo¿esz u¿ywaæ rsync, wypróbuj program
"<a href="http://packages.debian.org/mirror">mirror</a>". Pamiêtaj jednak
o tym, ¿e jego dzia³anie zale¿y od plików ls-lR, co uniemo¿liwia
poprawne ¶ledzenie serwerów lustrzanych w katalogu <kbd>project/trace/</kbd>
na serwerach lustrzanych Debiana.</p>

<toc-add-entry name="partial">Tworzenie czê¶ciowych serwerów lustrzanych</toc-add-entry>

<p>Maj±c na uwadze to, ¿e ju¿ teraz <a href="size">archiwa Debiana zajmuj±
bardzo du¿o miejsca</a>, wiele osób woli kopiowaæ tylko czê¶ci, których
potrzebuj±. Je¶li chcesz co¶ wy³±czyæ z kopiowania, powiniene¶ wy³±czyæ
architektury.</p>

<p>W <a href="anonftpsync">anonftpsync</a> mo¿na to zrobiæ poprzez zmianê
zmiennej EXCLUDE. Mo¿esz te¿ u¿yæ specjalnie do tego celu napisanych skryptów,
jak na przyk³ad <a
href="http://packages.debian.org/unstable/net/debmirror">\
debmirror</a> (autorzy: Joey Hess i Joerg Wendland). Je¶li uwa¿asz, ¿e co¶
powinno zostaæ do nich dodane skontaktuj siê z autorami (informacje o sposobie
kontaktu powinny byæ zawarte w samych skryptach).</p>

<p>Wy³±czenie <tt>project/</tt>, <tt>doc/</tt> i innych podkatalogów
jest mocno odradzane, poniewa¿ zwykle zajmuj± one ma³o miejsca, a s± bardzo
przydatne u¿ytkownikom.</p>

<toc-add-entry name="when">Kiedy rozpoczynaæ ¶ci±ganie</toc-add-entry>

<p>G³ówne archiwum jest uaktualniane co 24 godziny.

<p>Serwery lustrzane zazwyczaj rozpoczynaj± pracê oko³o godziny 00:00 UTC,
ale nie zawsze. Zalecamy codzienne ¶ci±ganie danych zaczynaj±c kilka godzin
po tym. Przed rozpoczêciem ¶ci±gania sprawd¼ czy serwer, z którego pobierasz
dane, zostawi³ plik ze znacznikiem czasu w swoim katalogu
<kbd>project/trace/</kbd>. Plik ze znacznikiem czasu bêdzie nazwany tak samo
jak serwer i bêdzie zawiera³ czas zakoñczenia ostatniej aktualizacji.
Dodaj to tego czasu kilka godzin (dla pewno¶ci) i wtedy zacznij ¶ci±ganie.</p>

<p>Naj³atwiejsz± metod± automatycznej aktualizacji danych jest uruchamianie
codziennie tego zadania przez crona. Szczegó³y w <kbd>man crontab</kbd>.

<p>Je¶li twój serwer jest informowany o zmianach za pomoc± tzw. mechanizmu push,
nie musisz siê martwiæ o czas aktualizacji. Wszystko zostanie wykonane
automatycznie.</p>

<toc-add-entry name="settings">Zalecane dodatkowe ustawienia</toc-add-entry>

<p>Je¶li zamierzasz udostêpniæ archiwa serwera lustrzanego Debiana przez HTTP,
u¿yj poni¿szych ustawieñ w konfiguracji Apacha (zak³adaj±c, ¿e korzystasz
w³a¶nie z niego) w bloku
<code>&lt;Directory <var>/¶cie¿ka/do/katalogu/z/archiwami</var>&gt;</code>,
gdzie <var>/¶cie¿ka/do/katalogu/z/archiwami</var> powinno byæ nazw±
katalogu, w którym trzymasz pliki serwera lustrzanego:</p>

<pre>
   Options +Indexes +SymlinksIfOwnerMatch
   IndexOptions NameWidth=* +SuppressDescription
   DirectoryIndex .
</pre>

<p>W³±cza to indeksy katalogów i zapewnia, ¿e pod±¿anie za dowi±zaniami
symbolicznymi bêdzie dzia³a³o. Nazwy plików w indeksie katalogów nie bêd±
skracane a opisy (g³ównie nieistniej±ce) nie bêd± pokazywane.</p>
