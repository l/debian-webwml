#use wml::debian::template title="Tworzenie serwerów lustrzanych metod± push"
#use wml::debian::translation-check translation="1.6"

<p>Tworzenie serwerów lustrzanych metod± push wykorzystuje rsync, 
który minimalizuje czas potrzebny, aby zmiany w g³ównym archiwum pojawi³y 
siê na serwerach lustrzanych. Serwer lustrzany u¿ywa mechanizmu 
,,spustowego'', aby poinformowaæ klienta, ¿e musi on dokonaæ aktualizacji.

<p>Tworzenie serwerów lustrzancyh metod± push wymaga nieco wysi³ku przy
konfiguracji, gdy¿ opiekunowie nadrzêdnego i podrzêdnego serwera
lustrzanego musz± wymieniaæ miêdzy sob± informacje. Zyskiem jest to, ¿e
serwer nadrzêdny inicjuje proces tworzenia kopii lustrzanej natychmiast
po aktualizacji swojej zawarto¶ci. Pozwala to na niezwykle szybk±
propagacjê zmian.

<h2>Wyja¶nienie metody</h2>

<p>Zacznijmy od pewnego wprowadzenia do ssh. Ssh pozwala na ³±czenie siê
z kontami na ró¿nych komputerach w bezpieczny sposób. Nie tylko has³a
nie s± nigdy przesy³ane w jawnej formie, ale te¿ kiedy ju¿ raz
po³±czysz siê z jakim¶ komputerem, to praktycznie masz gwarancjê, ¿e
przysz³e po³±czenia bêd± nawi±zywane z tym samym komputerem. Zapobiega to 
wielu atakom typu ,,man-in-the-middle''.

<p>Jedn± ze zdolno¶ci ssh jest mo¿liwo¶æ przeniesienia przez u¿ytkownika
publicznego klucza okre¶laj±cego jego to¿samo¶æ z innego komputera i
dodanie go do pliku zawieraj±cego zaufane klucze na Twoim
komputerze. Domy¶lnie u¿ytkownik na innym komputerze (który ma prywatny
klucz okre¶laj±cy jego to¿samo¶æ powi±zany z publicznym kluczem, który
Ty dosta³e¶) otrzymuje wtedy mo¿liwo¶æ zalogowania siê na Twoje konto.
Jednak¿e jest mo¿liwe dodanie do zaufanego klucza tekstu, który bêdzie
ogranicza³ dostêp osoby korzystaj±cej z Twojego konta i bêd±cej w
posiadaniu tego klucza.

<p>Zatem, aby chroniæ podrzêdny serwer lustrzany, klucz dostarczony
przez serwer nadrzêdny jest opatrzony tekstem, który ogranicza
uprawnienia osoby korzystaj±cej z Twojego konta do jednej tylko rzeczy -
uruchomienia na Twoim komputerze programu, który uaktualni zawarto¶æ
Twojego serwera lustrzanego. Nawet je¶li komu¶ (z³ej osobie postronnej)
uda siê z³amaæ klucz, jedyne co bêdzie móg³ on zrobiæ, to uruchomiæ
program uaktualniaj±cy na Twoim komputerze. Nie musisz nawet siê martwiæ
o uruchomienie wielu kopii tego programu, gdy¿ u¿ywany jest plik
blokuj±cy (ang. lock file).

<p>Po stronie serwera nadrzêdnego, rsync mo¿e byæ tak skonfigurowany,
aby ograniczaæ mo¿liwo¶æ tworzenia obrazów lustrzanych okre¶lonych
obszarów poprzez nazwê u¿ytkownika i has³o. S± one ca³kowicie niezale¿ne
od <kbd>/etc/passwd</kbd>, wiêc serwer korzystaj±cy z technologii push
nie musi siê martwiæ o zapewnienie dostêpu dla osób postronnych.
# POPRAW MNIE: w ang.bylo : server doesn't have to worry about giving 
# others access to their machine.
Zgodnie z konfiguracj±, nazwa u¿ytkownika i has³o s± przesy³ane w formie
jawnej. Jednak¿e nie powinno to byæ problemem, poniewa¿ w najgorszym
wypadku osoba postronna mo¿e uzyskaæ mo¿liwo¶æ stworzenia obrazu
lustrzanego stron Debiana z tej witryny.

<h2>Konfiguracja klienta technologii push</h2>

<p>Zaleca siê dokonanie poni¿szej konfiguracji jako zwyk³y u¿ytkownik,
a nie jako administrator (root). Zawarto¶æ publicznego klucza ssh, który
otrzyma³e¶ od serwera nadrzêdnego powinna zostaæ umieszczona w 
<kbd>~&lt;user&gt;/.ssh/authorized_keys</kbd>.

<p>Aby zostaæ klientem technologii push dla archiwum FTP bêdziesz
potrzebowa³ plików <a href="ftpsync">ftpsync</a> oraz 
<a href="ftpsync.conf">ftpsync.conf</a>. Wyedytuj ftpsync.conf zgodnie z
zawartymi w nim wskazówkami u¿ywaj±c informacji, które otrzyma³e¶ od
serwera nadrzêdnego. 

<p>Aby zostaæ klientem technologii push dla archiwum FTP w wersji non-US
bêdziesz potrzebowa³ plików <a href="ftpsync-non-US">ftpsync-non-US</a>
oraz <a href="ftpsync-non-US.conf">ftpsync-non-US.conf</a>.
Pliki maj± ró¿ne nazwy, ¿eby¶ móg³ u¿ywaæ jednego konta dla obydu
archiwów. 

<p>Aby zostaæ klientem technologii push dla stron WWW bêdziesz
potrzebowa³ plików <a href="websync">websync</a> oraz 
<a href="websync.conf">websync.conf</a>. Wyedytuj websync.conf zgodnie z
zawartymi w nim wskazówkami u¿ywaj±c informacji, które otrzyma³e¶ od
serwera nadrzêdnego.

<h2>Podstawowi klienci technologii push (ang. Push-Primary)</h2>

<p>Podstawowi klienci technologii push (ang. Push-Primary), nazywani równie¿ 
serwerami lustrzanymi typu Tier-1, to klienci technologii push, którym wolno 
pobieraæ dane bezpo¶rednio z naszego g³ównego archiwum.

<p>Je¶li Twój serwer posiada <strong>bardzo</strong> dobre ³±cze
(zarówno bardzo dobr± przepustowo¶æ, jak i bardzo dobre po³±czenie z
najwa¿niejszymi sieciami szkieletowymi) i chcesz pozwoliæ innym serwerom
na tworzenie obrazów lustrzanych z Twojego serwera, mo¿esz daæ nam znaæ,
aby¶my mogli rozwa¿yæ Twoj± kandydaturê na podstawowego klienta technologii push.
Jednak¿e nie spodziewaj siê, ¿e stanie siê to zbyt szybko, jako ¿e mamy
ju¿ dostateczn± liczbê serwerów lustrzanych typu Tier-1.

<p>Je¶li Twój serwer staje siê podstawowym klientem technologii push dla
archiwum FTP, bêdziesz potrzebowa³ klucza publicznego ssh dla konta
archvsync@ftp-master.debian.org, albo w wersji dla 
<a href="identity.pub.master.ftp">SSH1</a>, albo dla
<a href="id_rsa.pub.ftp-master">SSH2</a>.</p>

<p>Je¶li Twój serwer staje siê podstawowym klientem technologii push dla
archiwum FTP w wesjii non-US, bêdziesz potrzebowa³ klucza publicznego ssh dla konta
archvsync@non-us.debian.org, albo w wersji dla 
<a href="identity.pub.non-US.ftp">SSH1</a>, albo dla
<a href="id_rsa.pub.non-US">SSH2</a>.</p>

<p>Je¶li Twój serwer staje siê podstawowym klientem technologii push dla
stron WWW, bêdziesz potrzebowa³ klucza publicznego ssh dla konta
archvsync@www-master.debian.org, albo w wersji dla 
<a href="identity.pub.master.web">SSH1</a>, albo dla
<a href="id_rsa.pub.web-master">SSH2</a>.</p>

<h2>Konfiguracja serwera technologii push</h2>

<p>Ze wzglêdu na du¿± ilo¶æ serwerów lustrzanych oraz wielko¶æ archiwum
Debiana, nie jest mo¿liwe, aby wszystkie serwery lustrzane u¿ywa³y
g³ównego archiwum jako ¼ród³a plików (tzn. jako ich serwera technologii
push). Wiêksz± efektywno¶æ mo¿na uzyskaæ, je¶li obci±¿enie zostanie 
rozdzielone miêdzy wiele serwerów technologii push rozmieszczonych na
ca³ym ¶wiecie.

<p>Serwery technologii push powinny byæ klientami g³ównego archiwum
(albo innego serwera technologii push) i powinny zawieraæ obraz
lustrzany ca³ego archiwum Debiana.

<p>Przeczytaj <a href="push_server">szczegó³owy opis konfiguracji
serwera technologii push</a>.
