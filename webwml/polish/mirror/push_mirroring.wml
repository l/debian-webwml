#use wml::debian::template title="Tworzenie serwerów lustrzanych metod± push"
#use wml::debian::translation-check translation="1.17"

<p>Metoda push tworzenia serwerów lustrzanych minimalizuje czas potrzebny,
aby zmiany w g³ównym archiwum pojawi³y siê na serwerach lustrzanych.
Serwer lustrzany u¿ywa mechanizmu <q>spustowego</q> (trigerów), aby 
natychmiast poinformowaæ klienta mirrora, ¿e musi on dokonaæ aktualizacji.
</p>

<p>Tworzenie serwerów lustrzancyh metod± push wymaga nieco wysi³ku przy
konfiguracji, gdy¿ administratorzy nadrzêdnego i podrzêdnego serwera
lustrzanego musz± wymieniaæ miêdzy sob± informacje. Zyskiem jest to, ¿e
serwer nadrzêdny inicjuje proces tworzenia kopii lustrzanej natychmiast
po aktualizacji swojej zawarto¶ci. Pozwala to na niezwykle szybk±
propagacjê zmian.</p>

<h2>Wyja¶nienie metody</h2>

<p>Zacznijmy od pewnego wprowadzenia do ssh. Ssh pozwala na ³±czenie siê
z kontami na ró¿nych komputerach w bezpieczny sposób. Nie tylko has³a
nie s± nigdy przesy³ane w jawnej formie, ale te¿ kiedy ju¿ raz
po³±czysz siê z jakim¶ komputerem, to praktycznie masz gwarancjê, ¿e
przysz³e po³±czenia bêd± nawi±zywane z tym samym komputerem. Zapobiega to 
wielu atakom typu <q>man-in-the-middle</q>.</p>

<p>Jedn± ze zalet ssh jest mo¿liwo¶æ przeniesienia przez u¿ytkownika
publicznego klucza okre¶laj±cego jego to¿samo¶æ z innego komputera i
dodanie go do pliku zawieraj±cego zaufane klucze na Twoim
komputerze. Domy¶lnie u¿ytkownik na innym komputerze (który ma prywatny
klucz okre¶laj±cy jego to¿samo¶æ powi±zany z kluczem publicznym, który
otrzyma³e¶) ma mo¿liwo¶æ zalogowania siê na konto na Twoim serwerze.
Jednak¿e jest mo¿liwe dodanie do klucza tekstu ograniczaj±cego
typ dostêpu osoby korzystaj±cej z konta i bêd±cej w
posiadaniu tego klucza.</p>

<p>Zatem, aby chroniæ podrzêdny serwer lustrzany, klucz dostarczony
przez serwer nadrzêdny jest opatrzony tekstem, który ogranicza
uprawnienia osoby korzystaj±cej z konta do jednej tylko rzeczy &mdash;
uruchomienia programu, który uaktualni zawarto¶æ
serwera lustrzanego. Nawet je¶li komu¶ (osobie postronnej)
uda siê z³amaæ klucz, jedyne co bêdzie móg³ zrobiæ, to uruchomiæ
program uaktualniaj±cy. Nie trzeba nawet martwiæ siê
o uruchomienie wielu kopii tego programu, gdy¿ u¿ywany jest plik
blokuj±cy (ang. lock file).</p>

<p>Po stronie serwera nadrzêdnego rsync mo¿e byæ tak skonfigurowany,
aby ograniczaæ mo¿liwo¶æ tworzenia obrazów lustrzanych okre¶lonych
obszarów poprzez podanie nazwy u¿ytkownika i has³a. S± one ca³kowicie niezale¿ne
od <kbd>/etc/passwd</kbd>, wiêc serwer korzystaj±cy z techniki push
nie musi siê martwiæ o zapewnienie dostêpu dla innych osób.
Zgodnie z konfiguracj± nazwa u¿ytkownika i has³o s± przesy³ane w formie
jawnej. Jednak¿e nie powinno to byæ problemem, poniewa¿ w najgorszym
wypadku osoba postronna mo¿e uzyskaæ mo¿liwo¶æ stworzenia obrazu
lustrzanego stron Debiana z tej witryny.</p>

<h2>Konfiguracja klienta dla metody push</h2>

<p>Zaleca siê dokonanie poni¿szej konfiguracji jako zwyk³y u¿ytkownik,
a nie jako administrator (root). Zawarto¶æ publicznego klucza ssh, który
otrzyma³e¶ od serwera nadrzêdnego powinna zostaæ umieszczona w pliku
<kbd>~&lt;user&gt;/.ssh/authorized_keys</kbd>.</p>

<p>Aby zostaæ klientem w metodzie push dla archiwum FTP trzeba skonfigurowaæ
serwer za pomoc± naszego standardowego zestawu skryptów <a href="ftpmirror#how">ftpsync</a>
z niewielkimi modyfikacjami. Wyedytuj sekcjê skryptu oznaczon± jako
konfiguracja z ochron± has³em, tak aby zosta³ w³±czony plik
<a href="ftpsync.conf">ftpsync.conf</a>. Wyedytuj ftpsync.conf i
postêpuj zgodnie ze wskazówkami przekazywanymi przez serwer nadrzêdny.
</p>

<p>Aby zostaæ klientem technologii push dla stron www bêdziesz
potrzebowa³ plików <a href="websync">websync</a> oraz 
<a href="websync.conf">websync.conf</a>. Wyedytuj websync.conf zgodnie z
zawartymi w nim wskazówkami u¿ywaj±c informacji, które otrzyma³e¶ od
serwera nadrzêdnego.</p>

<h2>Podstawowi klienci metody push</h2>

<p>Podstawowi klienci techniki push (ang. Push-Primary), nazywani równie¿ 
serwerami lustrzanymi typu Tier-1, to klienci, którym wolno 
pobieraæ dane bezpo¶rednio z naszego g³ównego archiwum.</p>

<p>Je¶li Twój serwer posiada <strong>bardzo</strong> dobre ³±cze
(zarówno bardzo dobr± przepustowo¶æ, jak i bardzo dobre po³±czenie z
najwa¿niejszymi sieciami szkieletowymi) i chcesz pozwoliæ innym serwerom
na tworzenie obrazów lustrzanych z Twojego serwera, mo¿esz daæ nam znaæ,
aby¶my mogli rozwa¿yæ Twoj± kandydaturê na podstawowego klienta metody push.
Jednak¿e nie spodziewaj siê, ¿e stanie siê to szybko, jako ¿e mamy
ju¿ dostateczn± liczbê serwerów lustrzanych typu Tier-1.</p>

<p>Je¶li Twój serwer zostanie serwerem Push-Primary dla archwum FTP,
musisz mieæ jeden z plików:</p>
<ul>
  <li><a href="id_rsa.pub.ftp-master">klucz publiczny SSH2 u¿ywany przez
      ftp-master.debian.org</a></li>
  <li><a href="id_rsa.pub.syncproxy.eu">klucz publiczny SSH2 u¿ywany przez
      syncproxy.eu.debian.org</a></li>
  <li><a href="id_rsa.pub.syncproxy.wna">klucz publiczny SSH2 u¿ywany przez
      syncproxy.wna.debian.org</a></li>
</ul>

<p>Je¶li Twój serwer zostanie serwerem Push-Primary dla stron www,
musisz mieæ <a href="id_rsa.pub.www-master">klucz publiczny SSH2 u¿ywany przez
www-master.debian.org</a>.</p>

<h2>Konfiguracja serwera w technice push</h2>

<p>Ze wzglêdu na du¿± ilo¶æ serwerów lustrzanych oraz wielko¶æ archiwum
Debiana, nie jest mo¿liwe, aby wszystkie serwery lustrzane u¿ywa³y
g³ównego archiwum jako ¼ród³a plików (tzn. jako ich serwera
push). Wiêksz± efektywno¶æ mo¿na uzyskaæ, je¶li obci±¿enie zostanie 
rozdzielone miêdzy wiele serwerów metody push rozmieszczonych na
ca³ym ¶wiecie.</p>

<p>Mirrory push powinny byæ klientami g³ównego archiwum (albo innego serwera
push) i powinny zawieraæ obraz lustrzany ca³ego archiwum Debiana.</p>

<p>Przeczytaj <a href="push_server">szczegó³owy opis konfiguracji
serwera metod± push</a>.</p>
