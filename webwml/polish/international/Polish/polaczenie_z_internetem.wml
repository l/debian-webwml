#use wml::debian::template title="Po³±czenie z internetem" NOHEADER="yes"

<h2>Po³±czenie z Internetem</h2>

<h3>Jak prosto i szybko zestawiæ po³±czenie PPP za pomoc± dostêpnych w naszej
dystrybucji narzêdzi</h3>

<p>Mo¿emy wymieniæ co najmniej kilka rzeczy, których spodziewamy siê po nowo
zainstalowanym systemie operacyjnym. Oprócz oczywistej poprawy dzia³ania
(stabilno¶æ, szybko¶æ, bezpieczeñstwo) w odniesieniu do systemu poprzedniego
(je¶li - tak jak w wiêkszo¶ci przypadków - jest nim znany produkt pewnej bardzo
du¿ej firmy, nie bêdzie to szczególnie trudne), zazwyczaj chcemy by zosta³y nam
zapewnione podstawowe warunki konieczne do wykonywania pracy lub po prostu
uprawiania ulubionych zajêæ. Dopiero potem zastanawiamy siê nad rozszerzaniem
mo¿liwo¶ci i w konsekwencji przewy¿szeniem  funkcjonalno¶ci± poprzedniego
¶rodowiska. Wróæmy jednak do elementów koniecznych - najczê¶ciej chodzi tutaj o
dostêp do dysków z innymi systemami plików, mo¿liwo¶æ drukowania, graficzny
interfejs, u³atwienia w pracy w ¶rodowisku tekstowym, obs³ugê myszki, polskie
znaki, korzystanie z dyskietek i CD-ROM-ów, d¼wiêk, programy umo¿liwiaj±ce
konwersjê miêdzy ró¿nymi formatami itd. Niebagateln± rolê odgrywa tak¿e
po³±czenie z innymi komputerami lub sieci± (naturalnie tylko wtedy, gdy mamy
tak± mo¿liwo¶æ). W³a¶ciwie jest ono spraw± podstawow±, gdy¿ zwykle dziêki niemu
uzyskujemy dostêp do informacji pomocnych w dalszej konfiguracji i
dostosowywaniu systemu do swoich potrzeb. W tym artykule opiszemy najczê¶ciej
chyba wykorzystywane po³±czenie sieciowe - modemowe po³±czenie przez ³±cze
komutowane (liniê telefoniczn±) przy u¿yciu protoko³u PPP (<i>Point-to-Point
Protocol</i>) z sieci± Internet. Jako przyk³adu u¿yjê ogólnopolskiego numeru
udostêpnianego za cenê rozmowy lokalnej przez Telekomunikacjê Polsk± S.A.
Oczywi¶cie, tekst ten powinien równie¿ okazaæ siê pomocny w przypadku innych
us³ugodawców internetowych udostêpniaj±cych po³±czenie z Sieci± na podobnych
zasadach. Wszystko zosta³o opisane w oparciu o dystrybucjê Debian 2.2 Potato
(przy czym posiadacze Debiana 2.0 Hamm i 2.1 Slink nie powinni czuæ siê
pokrzywdzeni, gdy¿ artyku³ mo¿na odnie¶æ tak¿e do tych wersji Debian
GNU/Linux) i dostêpne w niej programy.

<h3>Co nam bêdzie potrzebne</h3>

<p>Dobrze by³oby, gdyby¶my posiadali modem ;). Przy czym nie mo¿e byæ to tzw.
,,winmodem'', czyli urz±dzenie przekazuj±ce czê¶æ swoich obowi±zków
sterownikom Windows. Czêstokroæ znacznie tañsze, lecz przecie¿ w pewien sposób
wybrakowane, urz±dzenie to nie mo¿e pracowaæ pod kontrol± np. Linuksa. Dlatego
w³a¶nie konieczny jest zwyk³y modem. Oprócz tego, oczywi¶cie, potrzebujemy
zainstalowanego i dzia³aj±cego Debiana. J±dro musi posiadaæ obs³ugê protoko³u
PPP (prawdopodobnie po zwyk³ej instalacji mamy ,,PPP Support''
wkompilowane na sta³e, pó¼niej ewentualnie mo¿na skompilowaæ je jako modu³ w
celu zmniejszenia rozmiaru j±dra). Ponadto konieczna jest instalacja pakietu
<tt>ppp</tt> (w Potato numer wersji to 2.3.11-1.1) zawieraj±cego niezbêdny
demon <tt>pppd</tt> oraz program <tt>chat</tt>. Gdy nie mamy jeszcze w
katalogu <tt>/dev</tt> stworzonych urz±dzeñ oznaczaj±cych porty szeregowe
(s± to odpowiednio <tt>ttyS0</tt> - COM1, <tt>ttyS1</tt> - COM2,
<tt>ttyS2</tt> - COM3 itp. ), nale¿y tworzymy je za pomoc± skryptu
<tt>MAKEDEV</tt>: 

<tt>
[root]# cd /dev
[root]# /MAKEDEV ttySx &lt;gdzie ,,x'' to ,,numer portu - 1''&gt;
</tt>

<p>Warto te¿ stworzyæ specjalne dowi±zanie:

<tt>
[root]# ln -s /dev/ttyS1 /dev/modem    &lt;gdy mamy modem na COM2&gt;
</tt>

<p>W <tt>/etc/syslog.conf</tt> powinni¶my dodaæ nastêpuj±cy wiersz (je¶li
jeszcze jej tam nie ma):

<tt>
*.* -/var/log/ppp.log &lt;pierwsz± gwiazdkê mo¿emy zast±piæ nazw± podsystemu 
logowania np. local0 czy local2&gt;
</tt>

<p>Istotne jest ustawienie adresów serwerów DNS (<i>Domain Name System</i>) w
pliku <tt>/etc/resolv.conf</tt>, dziêki czemu nie bêdziemy musieli u¿ywaæ tylko
numerów IP, ale tak¿e zwyk³ych nazw domenowych. Mo¿na te¿ wpisaæ do niego wiele
innych rzeczy - odsy³am do strony podrêcznikowej <tt>resolv.conf(5)</tt>
(<tt>man 5 resolv.conf</tt>). My skoncentrujemy siê jednak na numerach
serwerów DNS  - tak powinien wygl±daæ efekt naszych modyfikacji (numery IP
serwerów TP S.A. - podstawowego i uzupe³niaj±cego): 

<tt>
nameserver 194.204.152.34<br>
nameserver 194.204.159.1
</tt>

<p>Dalsze wymagania zale¿± od metody, któr± wybierzemy. Gdy zamierzamy
,,pój¶æ na ³atwiznê'' (czê¶æ pierwsza, <i>,,Inteligentny''
WvDial</i>), potrzebny nam bêdzie pakiet <tt>wvdial_1.41</tt> (sekcja comm,
numer wersji jak w Potato). W przypadku drugiego sposobu (opisanego w kolejnym
rozdziale), nie obejdzie siê bez <tt>pppconfig_2.0.4</tt> (Potato). Gdy
zdecydujemy siê na sposób trzeci (czê¶æ <i>Po³±czenie w ¶rodowisku
KDE - kppp</i>), wymagane jest zainstalowanie ¶rodowiska KDE (pakiety
zaczynaj±ce siê od kde* z ró¿nych sekcji dzia³u contrib).

<h3>,,Inteligentny'' WvDial</h3>

<p>Program <tt>wvdialconf</tt> powinien uruchomiæ siê zaraz po zakoñczeniu
instalacji niezbêdnych pakietów. Automatyczna konfiguracja po³±czenia tym
sposobem ma swoje niew±tpliwe zalety: musimy podaæ tylko trzy parametry (numer
telefonu, nazwê u¿ytkownika i has³o) - trwa to do¶æ szybko, wykrywanie modemu
przebiega bez naszego aktywnego udzia³u i, co najwa¿niejsze, nie musimy
anga¿owaæ zbytnio naszych szarych komórek ;). Wed³ug mnie wad jest jednak
wiêcej, a najwa¿niejsza z nich to niemo¿no¶æ ustawienia wielu wa¿nych opcji
(program robi to za nas) i co za tym idzie olbrzymia nieelastyczno¶æ narzêdzia.
Jest to dobre rozwi±zanie, gdy nie zamierzamy zg³êbiaæ tajników konfiguracji
<tt>pppd</tt>. Jednak w przypadku pó¼niejszych problemów z po³±czeniem, warto
siêgn±æ po <tt>pppconfig</tt>. Ca³a konfiguracja znajduje siê w pliku
<tt>/etc/wvdial.conf</tt> (wydruk 4). Mo¿emy j± pó¼niej rêcznie aktualizowaæ
(gdy chcemy wy³±cznie zmieniæ ustawienia modemu, wykonujemy polecenie
<tt># /usr/sbin/wvdialconf /etc/wvdial.conf</tt>). Opcje <tt>pppd</tt>
umieszczone s± w <tt>/etc/ppp/peers/wvdial</tt>. Wiêcej informacji o
formacie pliku <tt>/etc/vwdial.conf</tt> znajdziemy na stronach
podrêcznikowych <tt>wvdial(1)</tt> oraz <tt>wvdialconf(1)</tt>.

<h3>Konfiguracja i po³±czenia przy u¿yciu pppconfig</h3>

<p>Jedynym zadaniem graficznej nak³adki o nazwie <tt>pppconfig</tt> jest
pomoc w ustawianiu i uruchomienie po³±czenia PPP. Gdy ju¿ stworzymy w ten
sposób odpowiednie wpisy w plikach konfiguracyjnych <tt>pppd</tt>
(<i>Point-to-Point Protocol Daemon</i>), mo¿emy siê ³±czyæ i roz³±czaæ przy
u¿yciu specjalnych skryptów: <tt>pon</tt> oraz <tt>poff</tt>. W katalogu
<tt>/etc/ppp</tt> znajdziemy wiêkszo¶æ interesuj±cych nas informacji (te
dotycz±ce konkretnych po³±czeñ znajduj± siê w
<tt>/etc/ppp/peers/nazwa_polaczenia</tt>). W plikach
<tt>/etc/chatscripts/nazwa_polaczenia</tt> mo¿emy obejrzeæ skrypty
programu <tt>chat</tt> s³u¿±cego do przeprowadzania ,,negocjacji''
miêdzy naszym i zdalnym demonem <tt>pppd</tt> (lub te¿ miêdzy naszym
komputerem i modemami - zale¿y od punktu widzenia). Równie¿ one s± tworzone za
pomoc± <tt>pppconfig</tt>. Oto kolejne kroki ca³ej procedury:

<ol>

<li>Uruchamiamy jako u¿ytkownik root program <tt>pppconfig</tt> poleceniem
<tt>/usr/sbin/pppconfig</tt>. Po ekranie menu poruszamy siê za pomoc±
strza³ek, tabulatorem prze³±czamy siê z menu do przycisków ,,OK'' i
,,CANCEL''. Enter s³u¿y do zatwierdzenia (OK) lub cofniêcia zmian
(CANCEL - wtedy wracamy do pierwszego ekranu).

<li>W pierwszym oknie wybieramy <b>Create a connection</b>.

<li>Nastêpnie ustawiamy nazwê po³±czenia. Gdy nie zamierzamy tworzyæ innych, to po
prostu zostawmy <b>provider</b> - wtedy pozostanie domy¶lne (i mo¿emy odwo³ywaæ
siê do niego za pomoc± poleceñ <tt>pon</tt> i <tt>poff</tt> bez podawania
nazwy). W tym przyk³adzie postêpujemy jednak inaczej - wpisujemy <b>tpsa</b>.

<li>Kolejnym krokiem jest wybór metody identyfikacji. Przekazywanie has³a czystym
tekstem (czyli u¿ywanie Chat lub PAP w formie podstawowej) nie jest sposobem
najbezpieczniejszym. Istnieje gro¼ba pods³uchu, a poza tym niepokoi sam wygl±d
plików dziennika po próbie nawi±zania takiego po³±czenia (to dotyczy
szczególnie podawania has³a bezpo¶rednio w skrypcie jak to jest w przypadku
Chat). Zaznaczamy CHAP (gdyby nasz us³ugodawca nie obs³ugiwa³ tej metody,
zawsze mamy do dyspozycji 2 pozosta³e).

<li>Tu wpisujemy has³o (w przypadku gdy zawiera spacje i inne dziwne znaki, nale¿y
koniecznie uj±æ je w podwójny cudzys³ów) - <b>ppp</b>. Teraz przechodzimy do
podstawowej konfiguracji.

<li>Nazwa u¿ytkownika - <b>ppp</b>.

<li>Port, na którym mamy modem. Dla COM2 bêdzie to <tt>/dev/ttyS1</tt> (nale¿y
postêpowaæ zgodnie z konfiguracj± w³asnego systemu - sposób przyporz±dkowania
urz±dzeñ portom zosta³ omówiony na wstêpie).

<li>Na pytanie <b>Czy u¿yæ domy¶lnego routera w zdalnej sieci?</b> w wiêkszo¶ci
przypadków odpowiemy twierdz±co. Zaznaczamy (spacj±) <b>Enable default
route</b>. 

<li>Tutaj wpisujemy nasz adres IP, je¿eli jest statyczny. Poniewa¿ w przypadku
naszego numeru zostanie przydzielony dynamicznie, zostawiamy <b>noipdefault</b>.

<li>Szybko¶æ modemu. Najlepiej nie zmieniaæ domy¶lnej warto¶ci, czyli <b>115200</b>.

<li>Sposób inicjalizacji modemu. Powinni¶my pozostaæ przy <b>ATZ</b>, chyba ¿e
mamy uzasadnione powody, by u¿yæ innego ustawienia.

<li>Numer telefonu. U nas <b>0202122</b>.

<li>Rodzaj wybierania. Tonowe (ATDT) lub pulsowe (ATDP). W przypadku wiêkszo¶ci
central telefonicznych zaznaczamy to pierwsze.

<li>Mo¿emy jeszcze raz przejrzeæ konfiguracjê. Wybranie <b>Finished</b> spowoduje
zapisanie zmian.

</ol>

<p>Teraz ju¿ mo¿emy nawi±zaæ po³±czenie wpisuj±c (jako superu¿ytkownik)
<tt>pon tpsa</tt>, a przerwaæ je poleceniem <tt>poff tpsa</tt>. Gdy chcemy
uruchamiaæ te skrypty z uprawnieniami zwyk³ego u¿ytkownika
(<tt>/usr/sbin/pppd</tt> ma bit SUID i jest w³asno¶ci± u¿ytkownika root),
powinni¶my dodaæ go do grup dialout i dip, zmieniaj±c odpowiednio plik
<tt>/etc/group</tt> (a tak¿e <tt>/etc/gshadow</tt>, je¶li taki posiadamy).
Aby dowiedzieæ siê jak to zrobiæ, nale¿y zajrzeæ na stronê podrêcznikow±
<tt>group(5)</tt>.

<h3>Po³±czenie w ¶rodowisku KDE - kppp</h3>

<p>Nie zawsze konieczne jest u¿ycie <tt>pppconfig</tt>. Posiadaj±c
zainstalowane ¶rodowisko graficzne KDE, dysponujemy programem <tt>kppp</tt>
doskonale sprawdzaj±cym siê w tej samej roli. ¯eby zacz±æ z niego korzystaæ,
musimy usun±æ opcjê lock z pliku <tt>/etc/ppp/options</tt> (<tt>kppp</tt>
sam dba o blokowanie modemu). Oprócz tego, aby program móg³ uruchamiaæ nie
tylko superu¿ytkownik, nale¿y post±piæ tak samo jak w przypadku poprzedniego
programu, czyli przypisaæ odpowiedniego u¿ytkownika do odpowiednich grup.
Gdy program <tt>kppp</tt> nie ma bitu SUID (co jest bezpiecznym
rozwi±zaniem), trzeba tak¿e nadaæ tej grupie pe³ne prawa do urz±dzenia
reprezentuj±cego nasz modem - np. gdy <tt>/dev/ttyS1</tt> jest w³asno¶ci±
grupy dialout i ma prawa dostêpu 644, jako root musimy wykonaæ polecenie
<tt>chmod 664 /dev/ttyS1</tt>. Oto krótka instrukcja konfiguracji omawianego
narzêdzia. (Zak³adam, ¿e wcze¶niej zmieniono ju¿ w KDE domy¶lny jêzyk na polski)

<ol>

<li>Uruchamiamy <tt>kppp</tt> z menu (pozycja <b>Internet</b>) lub z emulatora
terminala (wpisuj±c <tt>kppp</tt>).

<li>Uka¿e nam siê okno programu. Lewym przyciskiem myszy wprowadzamy zmiany, prawym
mo¿emy uzyskaæ pomoc dotycz±c± wybranych opcji (które uprzednio wska¿emy
kursorem). Nale¿y utworzyæ nowe po³±czenie. W tym celu wybieramy
<b>Opcje...-&gt;Nowe...</b>

<li>W pierwszym okienku (<b>Dzwonienie</b>) wpisujemy:
<dl>
<dd>Nazwa po³±czenia: <b>tpsa</b></dd>
<dd>
	Numer telefonu: <b>0202122</b> &lt;je¶li musimy u¿ywaæ wybierania
	pulsowego, na pocz±tku numeru dodajemy literê ,,P'' np.
	<b>P0202122</b>&gt;
</dd>
<dd>Identyfikacja: <b>CHAP</b></dd>
<dd>
	Reszta nie ma wiêkszego znaczenia - mo¿emy j± zmieniaæ wed³ug naszego uznania.
</dd>
</dl>

<li><b>Adres IP</b> - pozostawiamy <b>Dynamiczny</b>

<li><b>DNS</b> - najlepiej nie wpisywaæ tu nic, a opcjê <b>Dezaktywuj istniej±ce
DNS w czasie po³±czenia</b> pozostawiæ niezaznaczon±. Stosowane bêd± wtedy
serwery nazw, których adresy umieszczone s± w pliku <tt>/etc/resolv.conf</tt>.

<li><b>Router</b> - pozostawiamy <b>Domy¶lny router</b>

<li>W oknie <b>Skrypt logowania</b> nie wpisujemy nic, poniewa¿ nie zamierzamy
korzystaæ z tego typu identyfikacji. Opcjonalnie mo¿emy sobie ustawiæ
zliczanie kosztów po³±czenia (<b>Koszty</b>) - musimy wtedy odwo³aæ siê do
<b>Poland-&gt;Poland Local</b>. Zamykamy <b>Ustawienia po³±czenia</b> i
przechodzimy do innych zak³adek. 

<li><b>Port:</b>
<dl>
<dd>Port szeregowy: <b><tt>/dev/ttyS1</tt></b></dd>
<dd>Szybko¶æ portu: <b>115200</b></dd>
<dd>
	Zaznaczmy te¿ <b>U¿ywaj pliku blokuj±cego</b>, resztê pozostawmy bez zmian
</dd>
</dl>

<li>W nastêpnej czê¶ci (<b>Modem</b>) mo¿emy sprawdziæ dzia³anie naszego modemu,
w kolejnej (<b>PPP</b>) ustawiæ bardziej szczegó³owe instrukcje dotycz±ce
pó¼niejszego zachowania siê programu. W pierwszej raczej nie nale¿y
eksperymentowaæ (chyba ¿e modem nie jest wykrywany), drug± mo¿na sobie zostawiæ
na pó¼niej.

<li>Zamykamy <b>Opcje...</b>, wpisujemy has³o i nazwê u¿ytkownika w widoczne na
panelu miejsce. Mo¿emy w³±czyæ podgl±d terminala (opcja <b>Poka¿ podgl±d</b>).
Klikamy <b>Po³±cz</b>. 

</ol>

<p>Teraz powinni¶my ju¿ s³yszeæ nasz modem. Mi³ej zabawy!

<h3>Podsumowanie</h3>

<p>W Potato istnieje jeszcze kilka metod zestawienia po³±czenia. Jako przyk³ad
mo¿na wymieniæ program z pakietu <tt>minicom_1.82.1-1</tt> (sekcja comm), czy
te¿ skrypty zwi±zane z narzêdziem <tt>ifconfig</tt>. Nie ma jednak sensu ich
opisywanie - trzy podstawowe sposoby omówione w tym artykule wystarcz± nam w
zupe³no¶ci. ¯yczê wszystkim owocnej pracy i dobrej zabawy w Internecie - mam
nadziejê, ¿e ten tekst okaza³ siê pomocny.

