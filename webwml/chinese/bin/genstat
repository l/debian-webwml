#!/bin/sh

#  A simple script to generate our little statistics on web page translation
#
#  Copyrighted by Anthony Wong, released under GPL v2 or above

PWD=`pwd`
CHINESE_DIR=`pwd`/../chinese

rm -f $CHINESE_DIR/littlestat.html
cd /cvs/webwml/webwml/

find english -name '*.wml,v' > en_files
find chinese -path 'chinese/chinese' -prune -o -path 'chinese/Attic' -prune -o -name '*.wml,v' -print > zh_files

NrEngFiles=`wc -l en_files | awk '{print $1}'`
NrChiFiles=`wc -l zh_files | awk '{print $1}'`

cat > $CHINESE_DIR/littlestat.html << __END__
<HTML>
<TITLE>Chinese web pages statistics</TITLE>
<BODY BGCOLOR="WHITE">
<TABLE>
<TR>
<TD>已翻譯及翻譯中頁數  <TD> ： $NrChiFiles 
<TR>
<TD>目標（英文網頁縷`數）<TD>： $NrEngFiles
<TR>
<TD>完成度 <TD>： `echo $NrChiFiles/$NrEngFiles*100|bc -l`%
</TABLE>

<P>
已翻譯及翻譯中的網頁包括：
<P>
__END__

sed 's/,v$/<BR>/' zh_files | sed 's/^chinese\///' >> $CHINESE_DIR/littlestat.html

cat >> $CHINESE_DIR/littlestat.html << __END__
<P>
<i>Last updated on `date`</i>

</BODY>
</HTML>
__END__

chmod a+r $CHINESE_DIR/littlestat.html

rm -f en_files zh_files
