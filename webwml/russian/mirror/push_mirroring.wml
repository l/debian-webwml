#use wml::debian::template title="Проталкивающее Зеркалирование"
#use wml::debian::translation-check translation="1.22" maintainer="Lev Lamberov"

<p>
Проталкивающее зеркалирование &mdash; это форма зеркалирования, использующая rsync,
минимизирующая время, требуемое для того, чтобы изменения в главном архиве достигли зеркал.
Главный сервер использует механизм защёлки для информирования клиентского зеркала, что
ему необходимо обновиться.
</p>

<p>
Проталкивающее зеркалирование требует немного больше усилий по настройке, поскольку
сопровождающие вышележащего и нижележащего серверов должны обмениваться информацией.
Выгодой является то, что вышележащий сервер инициализирует процесс зеркалирования
непосредственно после того как его архивы были обновлены. Это позволяет изменениям в архиве
быстро распространяться.
</p>

<h2>Разъяснения метода</h2>

<p>Триггеры выполняются с помощью ssh. Проталкивающий сервер подключается через ssh к учётной
записи на зеркале, используя аутентификацию по открытому ключу. Это специальный ключ, который
используется только для запуска синхронизации зеркала, никакие другие команды не используются. Затем
на сервер запускается утилита ftpsync, которая обновляет архив с помощью rsync как это обычно делается.
<br />
Обмен открытыми ключами и потенциальный доступ к ограниченным rsync-серверам
требует координации между оператором зеркала и оператором источника зеркалирования.
</p>

<h2>Настройка клиента проталкивающего зеркала</h2>

<p>Чтобы стать клиентом проталкивающего зеркала для архива FTP, вам необходимо
установить зеркалирование, используя наш стандартный набор сценариев <a href="ftpmirror#how">ftpsync</a>.
<br />
Когда это будет работать, добавьте открытый ssh-ключ вашего источника зеркалирования
в файл <code>~<user>/.ssh/authorized_keys</code> с ограничением
<code>command="~/bin/ftpsync</code>.
(Можно разместить ftpsync в другом каталоге, тогда соответствующим
образом измените указанную команду.)

<h2>Клиентские сайты Push-Primary</h2>

<p>Клиентские зеркала Push-Primary, также отнесённые к зеркалам Tier-1, являются клиентами
проталкивающих зеркал, которые синхронизируются напрямую с внутренней сетью Debian
syncproxy.
</p>

<p>Если ваш сайт <strong>очень</strong> хорошее подключение (имеет хорошую полосу
пропускания и хорошее подключение к главным магистралям) и вы хотите позволить другим
сайтам зеркалировать с вашего сайта, вы можете дать нам знать, и мы можем рассмотреть
добавление вас к проталкивающему зеркалу. Свяжитесь с командой зеркал Debian для получения
подробных инструкций. Помните, тем не менее, что мы не принимаем все запросы на получение
статуса первичного проталкивающего зеркала, поскольку у нас уже имеется довольно большое
количество зеркал типа Tier-1.
</p>

<h2>Настройка сервера проталкивающего зеркала</h2>

<p>Учитывая большое количество зеркал и размер архива Debian,
нецелесообразно всем зеркалам использовать внутренние syncproxy
Debian в качестве источника. Более рационально, если загрузка распределяется
среди нескольких проталкивающих зеркал, распределённых по земному шару.
</p>

<p>Поэтому часть первичных проталкивающих сайтов являются, в свою очередь, проталкивающими серверами для
других сайтов. Если вы хотите настроить ваш сайт как проталкивающий сервер для нескольких других сайтов,
 которые будут использовать ваш сайт в качестве источника, то обратитесь к <a href="push_server">подробной информации о настройке проталкивающего сервера</a>.
</p>
