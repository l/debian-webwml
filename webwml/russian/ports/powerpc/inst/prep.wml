#use wml::debian::template title="Перенос на PowerPC (PReP)" NOHEADER="yes"
#include "$(ENGLISHDIR)/ports/powerpc/inst/menu.inc"
#use wml::debian::translation-check translation="1.16" maintainer="Lev Lamberov"

<h1>Страница Debian GNU/Linux PowerPC PReP</h1>
 
<h3>Введение</h3>
<p>

 IBM и Motorola производят или производили машины на архитектуре
 PReP. В настоящее время поддержка PReP протестирована только на
 старых системах Motorola PowerStack(tm) (материнские платы Blackhawk, Comet, Utah)
 и на текущем встраиваемом решении в семействе
 PowerPlus(tm). Последнее включает MTX, MTX+,
 MVME2300(sc)/2400/2600/2700/3600/4600 и MCP(n)750. IBM производит
 ряд рабочих станций, совместимых с PowerPC PReP. Это
 RS/6000 40P, 43P, 830, 850, 860, 6015 и 6030.

</p>

<h3>Известные проблемы</h3>
<p>
MTX+ (система MTX с 7 слотами PCI) не может загружать ядро 2.2, загрузка виснет при
инициализации драйвера IDE. Это известная проблема, она будет исправлены в
готовящейся заплате для ядра.
</p>
<p>
Для всех систем Motorola PowerPlus ядро плохо поддерживает IDE.
Эта проблема была идентифицирована и исправлена. Изменения скоро будут доступны
в виде заплаты для ядра Debian и будут внесены в исходный код
ядра.
</p>

<h3>Микропрограмма</h3>
<p>

В зависимости от возраста и/или изготовителя вашей системы PReP, у вас будет
либо микропрограмма PPCBUG (Motorola), либо Open Firmware (IBM или Motorola), либо IBM
PReP. Команды загрузки несколько отличаются, но все из этих систем
реализуют стандарт PReP, поэтому одно и то же ядро может быть
загружено на всех платформах. Полное объяснение команд микропрограммы
выходит за рамки настоящего документа, но некоторая информация, где это необходимо,
будет предоставлена.

</p>

<h3>Настройка для установки</h3>

<h4>Установка с дискет</h4>

<p>
Запишите <code>boot1440.bin</code>, <code>root1440.bin</code>,
<code>resc1440.bin</code>, <code>drv14-*.bin</code> и
образы на дискеты. Можно использовать <code>dd</code>
на системе Linux/Unix system или <code>rawrite</code> на
системе DOS/Windows.
</p>

<h4>Установка по сети</H4>
<p>

Поместите файлы <code>resc1440.bin</code> и <code>drivers.tgz</code>
на экспортируемую файловую систему NFS на вашем NFS-сервере. Лучше всего разместить
эти файлы следующим образом:
<code>/[точка_монтирования]/debian/[установочные_файлы]</code> .
</p>

<p>
Поместите файл <code>boot.bin</code> в каталог tftp на вашем TFTP-сервере.
</p>

<h4>Параметры консоли</h4>
<p>
На системах Motorola PPCBUG вы можете загрузиться и осуществить установку, используя 
 либо консоль VGA, либо последовательную консоль. PPCBUG и Linux будут использовать режим 
 последовательной консоли, если VGA или клавиатура не будут определены.
</p>

<p>
Для того, чтобы должным образом просматривать процесс установки через последовательную консоль, необходимы
некоторые возможности эмуляции терминала. Чтобы видеть
установку в цвете, необходимо иметь эмулятор терминала с
поддержкой цветов ANSI. Достаточно иметь стандартный цветной xterm, имеющийся в большинстве
дистрибутивов Linux, такими также являются большинство терминалов в
Windows (напр., <a
href="http://www.chiark.greenend.org.uk/~sgtatham/putty/">PuTTY</a>).
Чтобы видеть символы рисования линий,
при помощи которых рисуются рамки GUI, необходимо, чтобы использовался шрифт, содержащий
расширенный набор символов для строк IBM. В Linux можно использовать шрифт «linux8x8»,
а под Windows можно выбрать шрифт MSLineDraw.
</p>


<h3>Загрузка</h3>
<dl>
<dt> PPCBUG
<dd> Используйте команду «ENV» и включите параметр «Network PReP boot enable» (Включить сетевую загрузку PReP).
<dd> Используйте команду «NIOT» для настройки клиента, сервера и (необязательно) IP-адреса шлюза,
     которые будут использовать для загрузки ядра через tftp. Если вы используете новую плату, выполните
     <tt>SET <var>&lt;дата/время&gt;</var></tt> для запуска hwclock, в противном случае сеть и всё остальное не будут работать.
<dt> Загрузите образ с 
<dd> PPCBUG&gt;NBO 0 0 ,,, bootprep.bin
<dt> OpenFirmware
<dt> Используйте следующую команду для загрузки по tftp образа PReP:
<dd> &gt;boot &lsaquo;ip-адрес_сервера&rsaquo;,&lsaquo;файл&rsaquo;,&lsaquo;ip-адрес_клиента&rsaquo;
</dl>



<h2>Установка Debian</h2>
<ol>
<li> Настройка клавиатуры
<p>
 Если вы используете последовательную консоль, пропустите шаг настройки клавиатуры.
</p>

<li> Разметка жёсткого диска
<p>
Создайте первичный раздел объемом 2МБ и измените его тип на тип загрузочного раздела PPC PReP
(type 41). Машины OF PReP могут иметь проблемы с загрузкой, если загрузочный раздел PPC PReP
находится на на первичном разделе 1. Несмотря на то, что все
системы Motorola PPCBUG могут иметь загрузочный раздел PPC PReP на любом первичном
разделе, общей практикой является делать загрузочный раздел PPC PReP на
sda1 или hda1.
</p>
<p>
После создания загрузочного раздела PPC PReP, следуйте обычным соглашениям Linux
по поводу разметки диска. По меньшей мере, следует создать корневой раздел и раздел
подкачки, они могут быть расположены на первичных или вторичных разделах.
</p>

<li> Установка аварийной дискеты и дискеты с драйверами
<p>
Установка с дискеты проста, вставьте аварийную дискету и дискету с
драйверами как только вас об этом попросят.
</p>
<p>
Во время установки по сети выберите параметр NFS и вас попросят
настроить сеть. Когда вас попросят ввести используемый
NFS-сервер, введите адрес NFS-сервера и каталог, созданный вами
ранее. Для остальных вопросов выберите параметры по умолчанию.
</p>

<li> Настройка моделей драйверов
<p>
 Важные модули включены в ядро, поэтому просто выберите «Выход».
</p>

<li> Установка базовой системы
<p>
Если выбрана установка с дискет, просто вставьте базовые дискеты, когда это будет нужно.
Если выбрана установка с NFS, введите адрес NFS-сервера и каталог, в котором
расположена базовая система, и выберите стандартные настройки для установки
базовой системы Debian.
</p>

<li> Включение загрузки с жёсткого диска
<p>
Пометьте созданный ранее раздел загрузочным в загрузочном разделе PPC PReP.
Если этого раздела нет, будет выведено сообщение об ошибке.
</p>

<li> Создание загрузочной дискеты
<p>
Запишите загрузочный образ на дискету в дисководе.
</p>

</ol>

<h2>Загрузка базовой системы Debian</h2>
<p>
 Если вы настроили загрузочный раздел PReP типа 41 PReP и программа установки
 сделала, чтобы система загружалась с жёсткого диска, то вы можете просто
 выполнить загрузочную команду микропрограммы, чтобы загрузиться с жёсткого диска (PPCBUG и
 OF имеют параметр autoboot (автоматическая загрузка), который можно включить).
</p>
<p>
Заметьте: чтобы заставить ядро стартовать с правильного раздела, вероятно будет
необходимо прописать переменную глобального окружения PReP (PReP Global Environment), «bootargs».
В случае установки Motorola PReP, по умолчанию будет выбираться
sda1, а если фактически корневая файловая система расположена на sda2, следует установить
<tt>bootargs=/dev/sda2</tt> .
</p>

<p>PPCBUG</p>

<dl>
<dt>Установите параметр bootargs
<dd>PPCBUG&gt;GEVEDIT bootargs
<dd>PPCBUG&gt;bootargs=root=/dev/sda2
<dt>Выполните загрузку (предполагается, что диск SCSI подключён к контроллеру 0, SCSI ID 0):
<dd>PPCBUG&gt;PBOOT 0 
<dt>Выполните загрузку (предполагается, что диск SCSI подключён к контроллеру 0, SCSI ID x) 
<dd>PPCBUG&gt;PBOOT 0 x0 
</dl>
<dl>
<dt>Openfirmware
<dt>Выполните загрузку (IDE/SCSI диск с установленной системой имеет псевдоним disk0)
<dd>&gt;boot disk0
<dt>Выполните загрузку (IDE/SCSI диск с установленной системой имеет псевдоним hdisk0)
<dd>&gt;boot hdisk0 
</dl>
<p>
 Теперь ядро загружается с жёсткого диска.
</p>

<hr>
Пожалуйста, отправляйте любый предложения/жалобы/сообщения о проблемах по поводу установки
на платформу PReP и по поводу этой документации <a href="mailto:porter@debian.org">Мэту Портеру (Matt Porter)</a>
