<define-tag description>セーフモードのバイパスとCRLF の挿入</define-tag>
<define-tag moreinfo>
<p>Wojciech Purczynski さんにより、セーフモードを有効にしているとき
でも、PHP を経由してメールを送信する際に、スクリプトから任意のテキスト
をコマンドライン引数として sendmail に送ることができるという問題が
発見されました。
5番目の引数を渡すことは、PHP がセーフモードに設定されているときには
無効にされるべきで、新しいバージョンの PHP と、以下のバージョンでは
そうなっています。
また、PHP3 はこの問題の影響を受けません。
</p>

<p>Wojciech Purczynski さんは、さらに、任意の ASCII 制御文字が mail()
関数の文字列に挿入できることを発見しました。
mail() 関数がユーザ入力から取られている場合、これによって
メールヘッダを含むメールの内容を変更することが可能です。
</p>

<p>Ulf Harnhammar さんは、file() 関数と fopen() 関数は CRLF の挿入に
対して脆弱であることを発見しました。
攻撃者は、これを用いて特定の制限を逃れ、渡される所定の HTTP リクエスト
に任意のテキストを追加することができます。
</p>

<p>ただし、この問題は、関数に有効なファイル名や URL ではないものが
渡されるときに発生します。制御文字を含む文字列は、有効な URL では
ありえません。URL であるべき文字列を何らかの関数に渡すとき、
それをエンコードするのに urlencode() 関数を使わなければならないからです。
</p>

<p>まとめると、PHP には、三つの問題が発見されています:</p>

<ol>
<li>mail() 関数で、宛先のアドレスまたは subject 行に CR/LF 文字が
含まれていた場合に、任意のメールヘッダの指定が可能となってしまいます。
</li>

<li>mail() 関数は、セーフモードで実行されているときに sendmail に
任意のコマンドラインオプションを渡さないようにする処理が
適切に行われていません。
</li>

<li>fopen() 関数は、URL を取得する際に、CR/LF 文字を含む URL を
使ってリソースに対するリクエスト処理を可能にしてしまいます。
例えば、HTTP リクエストにヘッダを加えることが可能です。
</li>
</ol>

<p>この問題は、現安定版 (stable) (woody) では、 PHP3 については
バージョン 3.0.18-23.1woody1 、PHP4 についてはバージョン 4.1.2-5 で、
修正されています。
また、旧安定版 (potato) では、PHP3 については 3.0.18-0potato1.2 で、
PHP4 については 4.0.3pl1-0potato4 で修正されています。
不安定版 (unstable)(sid) では、PHP3 についてはバージョン 3.0.18-23.2で、
PHP4 については 4.2.3-3 で修正されています。</p>

<p>PHP パッケージをアップグレードすることをお勧めします。</p>
</define-tag>

#use wml::debian::translation-check translation="1.2"
# do not modify the following line
#include "$(ENGLISHDIR)/security/2002/dsa-168.data"
# $Id$

