#use wml::debian::template title="ミラーサイトになるには"
<!--original_revision: 1.7 :-->

<P>世界はとても広く、世界中に数多くのミラーサイトがなければ、多くの人が Debian
を手に入れることは難しくなっています。

<P>もちろん、このためにはこれらのミラーサイトの構築や保守を行なう人が必要です。
それはあなたかも知れません。もし、Debian がアクセスしやすくなる様にディスク
スペースやネットワーク接続機材を提供する用意があるのなら、このページを御覧
ください。

<P>Debian には ftp アーカイブ用とウェブ用の 2 つのサイトがあります。ftp
アーカイブサイトには全てのパッケージとソース、インストールに必要な一式が収められています。ウェブサイトには Debian についての情報や、文書、開発者のための
情報、関連サイトへのリンクがあります。ウェブサイトをミラーするか、ftp サイトを
ミラーするか、両方ともミラーするかは選択することができます。非公開のミラー
サイトとしておくこともできますが、多くの人は
<A HREF="../misc/README.mirrors">ミラーサイト一覧</A> の
ftp サイトに登録しています。

<H2>公式ミラーサイトになる</H2>
<P>登録の際、Debian の公式サイトになるかどうかを選択できます。
公式サイトのアドレスは ftp.&lt;country&gt;.debian.org または
www.&lt;country&gt;.debian.org となります。
これらのサイトは多くの人に対し Debian の顔になるのですから、宣伝としても最高
ですし、最も利用されるサイトにもなります。これにより各公式サイトの負荷も確実に
減らすことができます。

<UL>
<LI>公式サイトには信頼度の高いマシンを使用し、24 時間稼働としてください。
   常に高い負荷がかかっているようなマシンは使用しないでください。
<LI>(各国の状況に応じて)充分なネットワーク接続性を備えてください。通信帯域は
   T1 相当を推奨しています。
<LI>ftp サイト: Debian ftp のディレクトリ構成は /debian 配下で利用できるように
   してください。これは各サイトで一慣性を持たせるためです。
<LI>ftp サイト: 私たちは ftp アーカイブを http でも利用できる
   (ftp://ftp.site/debian を http://ftp.site/debian としても利用できるように
   してください)新たな公式 ftp サイトを捜しています。http/1.1 による転送は ftp
   による転送よりも効果的な能力を持ち合わせているため、私たちはその方向で進めて
   いこうとしています。もちろん、全てのミラーサイトで http によるアクセスが可能
   であればとても嬉しく思います。
<LI>www サイト: 実サーバ、バーチャルサーバ共にそれ自身で IP アドレスを持った
   ものを使用してください。もし可能であればメーリングリストとバグ情報の
   アーカイブもミラーしてください(ミラーリングの注意事項を御覧ください)。
<LI>www サイト: cgi は中央サイトの cgi.debian.org で処理されますので、cgi
   に関する御配慮は結構です。
<LI>www サイト: content negotiation は有効にしてください。私たちはこれにより
   (ブラウザに対して正しい設定を行なっている方々に)各国語で翻訳されたウェブ
   ページを配信しています。Apache によるこの機能の提供は素晴らしいものです。
   この件について質問がある場合は
   <A HREF="mailto:webmaster@debian.org">webmaster@debian.org</A>
   宛にメールを送ってください。
<LI>ディスクスペースについて(拡張用の空間を含む):
          www サイト 1 GB 以上 (メーリングリストとバグ情報のアーカイブを含む)。
          ftp サイト 6 GB 以上。
<LI>ミラーサイトは少なくとも一日一回は更新してください。可能であれば、バグ情報
   のアーカイブは頻繁にミラーしてください。
</UL>
これらは事実上のガイドラインですのでよく読んでください。もし不明確な点が
あれば、質問事項を <A HREF="mailto:webmaster@debian.org">webmaster@debian.org</A>
宛に送ってください。

<P>公式ミラーサイトを希望する場合は、使用するマシンの名前とアドレスを、ミラー
サイトの保守を行なう方の名前と e-mail アドレスと共に、
<A HREF="MAILTO:WEBMASTER@DEBIAN.ORG">WEBMASTER@DEBIAN.ORG</A>
宛に送ってください。ミラーサイトの一覧に ftp サイトとして追加した場合は、
WEBMASTER が DNS の設定を行ないます。全てがうまく動作すれば、ウェブページの
ミラーサイトに登録します。

<P>現在のところ公式サイトの設置は各国毎に 1 つのみとしています。もし既に公式
ミラーサイトがある場合は、非公式なミラーサイトとして設置する事ができます。
Debian は現在でも北米とアフリカに於いて公式ミラーサイトを捜しています
(長期的な目標には南極や宇宙でのミラーも含まれています。笑わないでください。
私たちには既にスペースシャトルでの動作経験があります)。

<H2>ミラーリング</H2>
ミラーリングに関しては公式サイトと非公式サイトのどちらも同様です。
ftp サイトは
<A HREF="ftp://debian.crosslink.net/pub/debian">ftp://debian.crosslink.net/pub/debian</A>
をミラーしてください。
www サイトは
<A HREF="ftp://debian.crosslink.net/www/debian.org">ftp://debian.crosslink.net/www/debian.org</A>
と
<A HREF="ftp://debian.crosslink.net/www/debian.org-local">ftp://debian.crosslink.net/www/debian.org-local</A>.
をミラーしてください。もちろん、近くのミラーサイトを選択することもできます。

<P>FTP のミラーサイトはミラーサイト一覧に収めるため、Debian に登録する必要が
あります。<A HREF="mailto:mirrors@debian.org">mirrors@debian.org</A> 宛に
ミラーサイトの保守を行なう方の名前とミラーサイト名、Debian アーカイブのある
path の情報を書いてメールを送ってください。

<P> ウェブのミラーサイトには、あと何点か注意事項があります。debian.org には
debian.org-local へのリンクがあるため、ウェブサーバにはシンボリックリンクを
使えるようにしてください。さらに(サーバマシン上で Debian が動作していれば)、
Debian ポリシーを破り、ウェブページ中で /doc を使用できるよう決められています。
このため srm.conf 中の 'Alias /doc/ /usr/doc/' をコメントアウトしてください。
sponsor.html と sponsor_img.jpg は置き換えることができますし、またそれをすべき
です。これらはあなたのサイトの宣伝になるので、人々は誰がスポンサーなのかを
知ることができます。オリジナルファイルはあなたがミラーリングしているサイトの
sponsor.deb.html と sponsor.deb.jpg にあります。Debian は置き換える際のサンプル
としてこれらを提供しています。ロゴの推奨最大サイズは 120x60 です。

<H2>ミラープログラム</H2>
ほとんどの人が anonymous ftp を使ってミラーしています。このため、ftp アーカイブ
サイト上では 'mirror' というプログラムが適しています。ですが、バグ情報と
メーリングリストのアーカイブにはかなりの数のファイルがあるため、多くの RAM
がなければ (75MB で動作したとの報告があります)このプログラムで debian.org-local
をミラーリングするのは難しいでしょう。mirror の開発者はこの問題を認識しています
し、将来のバージョンではこの問題を修正する予定です。ご察しの通り、'mirror' は
Deban パッケージとして提供しています。もし、この Debian パッケージを既に
インストールしているならば、ftp アーカイブをミラーリングするためのサンプル
スクリプトが /etc/mirror/packages/ftp.debian.org にあります。

<P>サーバマシン上にミラーリング用のアカウントがある場合、多くの人が rsync を
利用しています。大きなアーカイブに効果を発揮する一方、安全なネットワーク接続の
ために ssh を利用することもできます。<A HREF="rsync_examples">rsync の使用例</A>
を御覧になれば、Debian のサイトをミラーリングするための rsync 使用方法について
有益な情報が見つかるかもしれません。rsync は version 1.7.4 かそれ以降のものを
ご利用ください。これ以前のものは、より多くのメモリを消費します。

<P>小規模サイトのミラーリングには wget が適していますが、mirror や rsync ほど
効率がよいとは言えないため、Debian サイトのミラーリングにはお勧めしません。

<H2>Content Negotiation</H2>
Content Negotiation とは、配信させる文書のタイプを判別するよう、サーバに対して
ブラウザに交渉させる手法のことです。この利用方法は数多くありますが、最も一般的
な利用方法としては、受け取りたい文書の言語に関する交渉です。Debian はこの手法を
使い(技術的にも)とてもエレガントに各国語のページを配信しています。

<P>Apache をご利用の方へ。Apache は頻繁に更新されます。以下の記述と同様のものを
/etc/apache/access.conf に追加し (/debian/web の箇所はウェブページのある
ディレクトリに置き換えてください)、サーバを再起動してください(この例では
Apache 1.3 beta またはそれ以降を想定しています)。
<blockquote><pre>
&lt;Directory /debian/web&gt;
Options +Multiviews   
&lt;/Directory&gt;
</pre></blockquote>

<H2>ウェブサーバの設定に関するその他の変更</H2>
ディレクトリインデックスファイルを正しく配信するためには、おそらく
/etc/apache/srm.conf 中の DirectoryIndex エントリを変更する必要があります。
少なくても以下のエントリは満たしておいてください。
<pre>
   DirectoryIndex index index.html index.shtml index.htm
</pre>
補足として、ウェブサイトにあらゆる言語のページが置かれた時にサーバが取り扱える
ようになっているかを確認してください。これらの設定は AddLanguage タグで行なわれ
ています。以下は単なるサンプルですので、後で必要に応じて追加してください。
<pre>
   AddLanguage en .en
   AddLanguage fr .fr                                                       
   AddLanguage de .de                         
   AddLanguage it .it
   AddLanguage es .es
   AddLanguage ja .ja
   AddLanguage da .da
</pre>

