#use wml::debian::template title="Exempel på hur rsync används, och hur man sätter upp lösenordslös ssh" NOHEADER=yes
#use wml::debian::translation-check translation="1.5"

<H3>Exempel på hur rsync används</H3>

<P>Nedan finns exempelkod som speglar både webb- och ftp-platsen.
Du måste modifiera maskinnamnet och de sökvägar som används för att passa
för att passa dina inställningar.

<P>Låsfilen är användbar om du kör det här via cron.
Om speglingen av någon orsak skulle misslyckas kommer nästa försök att
generera ett e-postmeddelande.
Det gör att du kan spåra problemet, rätta till det och radera låsfilen,
varefter speglingen kan fungera korrekt nästa gång det körs.

<blockquote>
<pre>
\#!/bin/bash -e

lockfile -r 1 rsync.master.lock || exit 23

rsync -avz -e ssh --exclude sponsor.* --delete &lt;maskin&gt;:/web/debian.org/ debian.org

echo Färdig med uppdatering av webbspeglingen. Övergår nu till ftp-speglingen...

rsync -avz --delete -e ssh &lt;maskin&gt;:/debian debian

rm -f rsync.master.lock
</pre>
</blockquote>

<P>Skriptet ovan kommer att fråga dig efter ett lösenord om du inte har ställt
in ssh på enligt nedan.

<H3><a name="passwordlessssh">Hur du sätter upp ssh så att du slipper frågas
efter lösenord</a>:</H3>

<p>Du kan skapa en RSA-autentiseringsnyckel som kan användas för att logga
in på en fjärrserver från ditt konto, utan att du behöver ange lösenordet.

<P>
Observera att när du väl satt upp detta kan en inkräktare som bryter sig in
på ditt konto/din server även få fri tillgång till webbplatsen du speglar!
Därför bör detta <strong>aldrig</strong> göras från root-kontot.

<ul>
  <li>Kör <code>ssh-keygen</code> på din maskin, och tryck bara
      Enter när du ombeds ange ett lösenord.
  <li>Lägg därefter innehållet i <code>~/.ssh/identity.pub</code> från din
      maskin till <code>~/.ssh/authorized_keys</code> på spegeln
      (filen bör ha rättigheten 600).
</ul>

<p>
Det ska nu gå att logga in till spegeln med ssh utan att du blir efterfrågad
om ett lösenord.
