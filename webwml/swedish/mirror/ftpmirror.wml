#use wml::debian::template title="Sätta upp en ftp-spegel"
#use wml::debian::toc
#use wml::debian::translation-check translation="1.22"

<define-tag toc-title-formatting endtag="required" whitespace="delete">
<h2>%body</h2>
</define-tag>

<p>Spegling görs på samma sätt på både inofficiella och
<a href="official">officiella</a> speglar.

<p>
När en spegel satts upp bör den <a href="submit">registreras hos Debian</a>
så att den kan läggas in i
<a href="../misc/README.mirrors">spegellistan</a>.
Registrering kan göras via vårt <A href="submit">enkla webbformulär</a>.

<p>
Problem eller frågor kan ställas till
<a href="mailto:mirrors@debian.org">mirrors@debian.org</a>.
</p>

<toc-display/>

<toc-add-entry name="wherefrom">Platser att spegla</toc-add-entry>

<p>Många tror att <code>ftp.debian.org</code> är &rdquo;rätt&rdquo; plats
för Debianpaket och att det är bäst att spegla därifrån.
Detta är <strong>inte sant</strong>.
<code>ftp.debian.org</code> är bara en av många servrar som uppdateras från
en intern Debianserver.</p>

<p>Alla servrar i den <a href="mirrors_full">kompletta spegellistan</a> som
är märkta &rdquo;<kbd>Type: Push-Primary</kbd>&rdquo; bör vara lämpade att
spegla från.</p>

<p>För dig är det i praktiken ingen skillnad mellan att spegla från den
servern eller att spegla från en annan
<em>primär &rdquo;push&rdquo;</em>-spegel.
Å andra sidan, om många använder ftp.debian.org (vilket tyvärr sker) slösar
detta med donerad bandbredd.</p>

<toc-add-entry name="methods">Sätt att spegla</toc-add-entry>

<p>
Den rekommenderade metoden för att spegla är via rsync.

<p>Observera:
Trots att <kbd>wget</kbd> fungerar bra för att spegla små arkiv är det inte
lika konfigurerbart som mirror eller rsync, så det rekommenderas inte för
detta.

<h3>Anonym rsync</h3>

<p>Du kan använda <a href="anonftpsync">detta skript</a> för att spegla
arkivet.
Följ instruktionerna i skriptet för att sätta upp speglingen.

<h3>Rsync med autentisering, från en "push"-spegling</h3>

<p>
"Push"-spegling är en form av spegling med rsync vi har utvecklat
som minimerar tiden det tar för ändringar i huvudarkivet att nå speglingarna.
Den servande spegeln använder en utlösarmekanism för att informera
klientspeglingen om att den måste uppdateras.

<p>
Denna metod är relativt säker eftersom ssh konfigureras för att köra ett
enda kommando.
Dessutom är speglingen fortfarande "pull", så det är <strong>inte</strong>
möjligt att förstöra innehållet i arkivet via en förfalskad "push"-spegel.
Vissa spegeladministratörer har uppvisat viss motvillighet mot att
använda denna typ av spegling på grund av oro för att metoden öppnar deras
maskin för intrång, något som <strong>inte</strong> är sant.

<p>
För en mer utförlig beskrivning av hur det fungerar, varför det är
säkert, och hur man sätter upp en "push"-spegling, se
<a href="push_mirroring">den kompletta förklaringen</a>.

<h3>Anonym ftp med "mirror"</h3>

<p>Anonym med ftp var länge det vanligaste sättet att spegla.
För att göra detta på Debianarkivet fungerar programmet "mirror" bra,
och som du antagligen har gissat, så finns "mirror" som ett Debianpaket.
Om du har installerat Debianpaketet finns det ett exempelskript för att
spegla ftp-arkivet i filen /etc/mirror/packages/ftp.debian.org

<toc-add-entry name="partial">Spegla delmängder</toc-add-entry>

<p>Med tanke på hur stort Debianarkivet redan är föredrar vissa att bara
spegla de delar de behöver.
För det behövs ett specialskrivet skript, som de från
<a href="http://cvs.kitenet.net/~checkout~/joey-cvs/bin/debmirror?tag=HEAD&amp;content-type=text/plain">
Joey Hess</a> och
<a href="http://people.debian.org/~absurd/">Stephan Suerken</a>.
Om du anser att något bör läggas in i dessa ber vi dig kontakta respektive
författare (kontaktinformation bör finnas i skripten själva).

<toc-add-entry name="when">När du bör spegla</toc-add-entry>

<p>Huvudarkivet uppdateras var 24:e timme.

<p>Om din plats blir "push"-speglad behöver du inte oroa dig om detta.
Om inte, och platsen du valt att spegla använder rsync, bör du leta i
<kbd>project/trace/</kbd> i Debianarkivet på spegelplatsen efter en fil med
namnet på den platsen.
Filen bör innehålla tiden speglingen senast blev klar.
Lägg till en viss tid, säg en timme, till den tiden och spegla då.

<p>Det enklaste sättet att automatiskt köra spegeln varje dag är att använda
cron.
Se <kbd>man crontab</kbd> för detaljer.

<toc-add-entry name="settings">Rekommenderade ytterligare inställningar</toc-add-entry>

<p>Om du planerar att göra Debianspeglingen tillgänglig över HTTP ber vi dig
lägga till följande inställningar till Apaches konfiguration (förutsatt,
naturligtvis, att du använder Apache) för katalogindex:

<pre>
&lt;directory /org/ftp.debian.org/ftp&gt;
   IndexOptions NameWidth=* +SuppressDescription
   DirectoryIndex .
&lt;/directory&gt;
</pre>

<p>(ersätt <code>/org/ftp.debian.org/ftp</code> med namnet med katalogen där
du har speglingen)
