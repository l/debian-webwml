#use wml::debian::template title="Espelhos do site web do Debian"
#use wml::debian::toc
#include "$(ENGLISHDIR)/mirror/webmirrors.data"
#use wml::debian::translation-check translation="1.37"

<toc-display/>

<hrline>

<toc-add-entry name="list">Lista dos espelhos web</toc-add-entry>

<p>Existem espelhos das páginas WWW do Debian nos seguintes países:

<webmirrors>

<p>Se o seu país não está listado e você gostaria de patrocinar um espelho,
por favor fale conosco. Se seu país já está na lista, muito provavelmente ele
<strong>não necessita</strong> de um outro espelho. Nós normalmente <strong>não
incentivamos</strong> criação de novos espelhos para o site web do Debian.

<toc-add-entry name="whynot">Por que nós não precisamos de mais espelhos web</toc-add-entry>

<p>Nosso site web requer manutenção (um pouco mais que os espelhos do site
FTP, uma vez que você precisa mudar os arquivos de configuração do Apache de vez
em quando) e custa recursos dos patrocinadores. Entretanto, devido à natureza
das páginas web, das quais você não precisa fazer download com freqüência e nem
se preocupar muito caso elas cheguem a 2kbps ou a 30kbps, já que elas são
absolutamente pequenas, a questão sobre a utilidade de ter muitos espelhos
do site web vem à tona.

<p>Houve um tempo em que as conexões de Internet pelo mundo não eram
rápidas, e acessar a página www.debian.org a partir de um outro continente, por
exemplo, era terrível e mais lento que uma típica conexão de modem. Então, nós
organizamos a criação de espelhos e vários espelhos do site web vieram a
existir. Dez (ou onze, se você contar a Turquia) deles estão na Europa.

<p>Entretanto, hoje nós temos a explosão de links de redes rápidas,
especialmente na Europa, de maneira que não haverá a necessidade de um monte de
espelhos. De fato, devido ao aumento de velocidade dos links entre a Europa e a
América, até mesmo o acesso a www.debian.org a partir da Europa não é mais
lento.

<p>Este é basicamente o porquê de nós não necessitarmos de mais espelhos
do site web, especialmente nos continentes onde já existem espelhos.
Por favor, respeite nosso desejo. Obrigado por sua cooperação.

<p>Caso tenha alguma questão, envie um mail para
<a href="mailto:mirrors@debian.org">mirrors@debian.org</a>.

<hrline>

<p><strong>As informações a partir deste ponto são fornecidas apenas como
referência aos responsáveis dos espelhos existentes.</strong>

<toc-add-entry name="how">Processo de espelhamento</toc-add-entry>

<p>O método recomendado de se fazer um espelho é com o rsync. Não existe acesso
anônimo aos arquivos do site web. Você pode configurar o acesso autenticado com
o responsável pelo site a partir do qual você deseja fazer o espelho, envie um
e-mail para <a href="mailto:mirrors@debian.org">mirrors@debian.org</a>.

<p>O espelho é um processo `pull', isto é. o cliente requisita os dados do
servidor de sua conveniência. Para obtê-lo, você pode usar o
<a href="websync">script websync</a> e <a href="websync.conf">seu
arquivo de configuração</a>, o qual pode ser executado a partir da
crontab, e fará tudo automaticamente. Siga as instruções do script 
para ter certeza que tudo ocorreu bem.

<h3>Fazendo um espelho a partir de um 'espelho push'</h3>

<p>O 'espelhamento push' é uma forma que desenvolvemos para fazer um espelho 
usando rsync para minimizar o tempo gasto no exame dos repositórios dos 
espelhos. O servidor usa um gatilho ssh para informar o espelho cliente 
para se atualizar.

<p>Este método é totalmente seguro já que o ssh é configurado para executar
apenas um simples comando. Além disso, o espelho segue sendo `pull' de maneira
que <strong>não</strong> é possível corromper o conteúdo dos repositórios por
meio de um 'espelho push' forjado.
Alguns administradores têm demonstrado relutância para usar este método de
espelhamento devido a temores de que o método possa abrir sua máquina para
invasão.
Isto simplesmente <strong>não</strong> é verdade.

<p>Para uma descrição mais detalhada de como isto funciona e porque é seguro, e
como configurar um 'espelho push', por favor veja <a href="push_mirroring">a
explicação completa</a>.

<toc-add-entry name="when">Quando fazer espelho</toc-add-entry>

<p>O site principal é atualizado aproximadamente a cada quatro horas.

<p>Se seu site utiliza o método 'push', então você não precisa se preocupar com
isto. Se não, você deve calcular o tempo para se fazer a cópia para seu site
de acordo com as datas do arquivo de registro de data e hora do diretório
<code>/mirror/timestamps/</code> do espelho do site web. Adicione mais algum
tempo, digamos meia hora, à hora registrada e então copie.

<p>A maneira mais fácil de se ter o espelho executando automaticamente todos os 
dias é usar o cron. Veja <kbd>man crontab</kbd> para detalhes.

<toc-add-entry name="sponsor">Anunciando o patrocinador do espelho</toc-add-entry>

<p>Os arquivos <code>sponsor.html</code> e <code>sponsor_img.jpg</code> podem
e devem ser substituídos por você. Eles existem para você anunciar seu site e
para as pessoas saberem que você é o patrocinador. Os originais estão sob
<code>sponsor.deb.html</code> e <code>sponsor.deb.jpg</code>, já que o site
de que você está fazendo o espelho pode ter substituído os que o Debian fornece
como exemplos.
A sugestão para o tamanho máximo de seu logo é 120x60.

<p>Devido à <a href="#cn">negociação de conteúdo</a> que é usada na páginas web
para selecionar o idioma preferido, você pode criar um
<code>sponsor.html</code> para idiomas diferentes. Para fazer isto, simplesmente
crie um sponsor.&lt;idioma&gt;.html para cada &lt;idioma&gt; que você deseje.

<p>Certifique-se de adicionar à lista de excluídos os arquivos que você não
queira sobrescrever quando estiver fazendo o espelho.

<toc-add-entry name="configure">Configurando o servidor web</toc-add-entry>

<h3>Várias Alterações no Servidor Web</h3>

<p>Se sua máquina está executando o Debian, foi decidido quebrar a política do
Debian e usar <code>/doc</code> nas páginas web.  Isto significa que você deve
comentar a linha `<code>Alias /doc/ /usr/share/doc/</code>' do seu arquivo
<code>/etc/apache/srm.conf</code> .

<P>Nota: todos nossos scripts CGI são executados centralizadamente em
cgi.debian.org, sendo assim você não precisa se preocupar com eles.

<h3><a name="cn">Negociação de Conteúdo</a></h3>

<p>A Negociação de Conteúdo é um método que deixa um navegador negociar com um
servidor o tipo de documento que deve ser mostrado. Embora haja diversas
utilizações para isso, a mais comum é para negociar em qual o idioma um
documento deve ser mostrado. Utilizar este recurso permite ao Debian servir
suas páginas em mais de um idioma de maneira (tecnicamente) muito elegante.

<P>Para quem está usando Apache, a mudança é quase trivial.
Simplesmente adicione esta opção:

<pre>
Options +Multiviews   
</pre>

<p>na seção <code>&lt;Directory&gt;</code> para as páginas do Debian no seu
arquivo
<kbd>/etc/apache/access.conf</kbd> , e reinicie o servidor.

<p>Adicionalmente, você precisa certificar-se de que o servidor suporta todos
os idiomas que estarão no site web. Isto é feito usando o rótulo (tag)
<kbd>AddLanguage</kbd> . O que segue abaixo é a lista dos idiomas
já usados - esperamos mais tarde adicionar outros:

<pre>
  AddLanguage en .en
<:
foreach $l (keys %langs) { push @codes, $langs{$l}; }
foreach $c (sort @codes) { print "  AddLanguage $c .$c\n" if (($c ne "en") && ($c ne "zh")); }
:>  \
  AddLanguage pt-br .pt
  AddLanguage nb .nb
  AddLanguage zh-CN .zh-cn
  AddLanguage zh-HK .zh-hk
  AddLanguage zh-TW .zh-tw
</pre>

<p>Devido a uma problema no apache, um idioma errado pode ser mostrado em
algumas circunstâncias, assim, é uma boa idéia adicionar todos os idiomas
servidos na opção LanguagePriority, desta maneira:

<pre>
<:
print "LanguagePriority en fr es ";
foreach $c (sort @codes) { print "$c " if (($c ne "en") && ($c ne "fr") && ($c ne "es") && ($c ne "zh")); }
print "nb zh-CN zh-HK zh-TW\n";
print "pt-br nb zh-CN zh-HK zh-TW\n";
:>\
</pre>

<p>Para evitar de servir arquivos de conteúdo-negociado com um conjunto de
caracteres errado, certifique-se de que qualquer configuração
<code>AddDefaultCharSet</code> está comentada o configurada para
`<code>Off</code>'.

+<p>If using apache 1, in order to serve directory index files correctly, you
+will probably need to modify the <code>DirectoryIndex</code> entry in
+<code>/etc/apache/srm.conf</code>. This won't work with apache 2 though.
+The following should be sufficient for apache 1:

<p>Se estiver usando apache 1, para servir corretamente os arquivos de índice
de diretório, você provavelmente precisará modificar a entrada
<code>DirectoryIndex</code> em <code>/etc/apache/srm.conf</code>. No entanto,
isto não funcionará no apache 2. O seguinte deve ser suficiente para o
apache 1:

<pre>
DirectoryIndex index index.html
</pre>

<p>Para enviar o cabeçalho Content-Type correto para favicon.ico, o Apache
deve ser instruído a usar o tipo image/x-icon, deste modo:</p>

<pre>
AddType image/x-icon .ico
</pre>

<p>Para enviar o cabeçalho Context-Type correto para feeds RSS, o Apache
deve ser instruído a usar o tipo application/rss+xml desta forma:</p>

<pre>
AddType application/rss+xml .rdf
</pre>

<p>Para evitar problemas de negociação de conteúdo com o conteúdo sob
<a href="../events/">/events</a>, arquivos de calendário precisam receber
menor prioridade to que conteúdo text/html:</p>

<pre>
AddType text/calendar;qs=0.9 .ics
</pre>

<h3>Redirecionamento</h3>

<p>Como algumas partes do site web estavam começando a ficar muito grandes para
serem espelhadas por muitos sites, nós as separamos do site principal. Embora
muitos links devam ser convertidos para usar as novas localizações, você é
incentivado a adicionar um redirecionador para outro site, assim nenhum link
fica quebrado. Isto pode ser feito em
<kbd>/etc/apache/srm.conf</kbd>. Por exemplo:

<pre>
Redirect /Lists-Archives http://lists.debian.org/
Redirect /search http://search.debian.org
Redirect /Packages http://packages.debian.org
Redirect /lintian http://lintian.debian.org
</pre>
