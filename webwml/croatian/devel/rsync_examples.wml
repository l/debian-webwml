#use wml::debian::template title="Primjer upotrebe rsynca"

<P>Slijedi primjer koji æe mirrorati i WWW i FTP site. Morat æete
promijeniti ime stroja i direktorije u pitanju ovisno o svojoj situaciji.

<P>'lock' datoteka je korisna ako æete ovo pokretati kao cron zadatak.
Ako iz bilo kojeg razloga mirror ne zavr¹i s poslom, sljedeæi put æe
vam pri pokretanju mirror poslati e-mail. Tako æete moæi utvrditi gdje
le¾i problem, ispraviti ga, obrisati lock datoteku i mirror æe ispravno
raditi pri sljedeæem pokretanju.

<blockquote>
<pre>
#!/bin/bash
set -e

lockfile -r 1 rsync.master.lock || exit 23

rsync -avz -e ssh --exclude .glbuild --delete &lt;stroj&gt;:/web/debian.org/ debian.org
rsync -avz -e ssh --delete &lt;stroj&gt;:/web/debian.org-local/ debian.org-local

echo ZAVR©IO S OSVJE®AVANJEM WWW-a. SADA PRELAZIM NA FTP.

rsync -avz --delete -e ssh &lt;stroj&gt;:/debian debian

rm -f rsync.master.lock
</pre>
</blockquote>

<H3>Kako podesiti ssh da vas ne pita lozinku:</H3>

Gornja skripta æe vas pitati lozinku osim ako ne podesite ssh na stanovit
naèin. Prvo, kada koristite ssh-keygen, samo pritisnite return kada vas
bude tra¾io lozinku [1]. Dalje, dodajte sadr¾aj datoteke ~/.ssh/identity.pub
u ~/.ssh/authorized_keys na sustavu s kojeg mirrorate (ta datoteka mora
imati dozvole 600).
Tako biste trebali moæi koristiti ssh za logiranje na mirrorani sustav
bez pitanja o lozinci.

<P>
[1] Primijetite da pode¹avanje ssh-a sa praznom lozinkom svakom uljezu koji
provali u va¹ sustav omoguæava slobodan pristup sustavu kojeg mirrorate.
Zato se to nikad ne bi smjelo raditi kao root.

