#use wml::debian::template title="Spejlinger af Debians websted"
#use wml::debian::toc
#use wml::debian::translation-check translation="1.46"
#include "$(ENGLISHDIR)/mirror/webmirrors.data"

<toc-display/>

<hrline />

<toc-add-entry name="whynot">Hvorfor vi ikke har brug for flere webspejle</toc-add-entry>

<p>Spejlingerne af vores websted kræver vedligeholdelse (endda lidt mere end
i forbindelse med spejlinger af ftp-stedet, da du af og til skal ændre på 
opsætningen af Apache) og koster sponsorerne ressourcer.  Men, på grund af 
hvordan websider er indrettet, man behøver ikke at hente dem jævnligt og da de
er ret små spiller det ikke den store rolle om de ankommer ved 2 eller 30 kbps, 
er spørgsmålet om det er nyttigt at have mange spejlinger af webstedet.</p>

<p>Engang var Internet-forbindelser mellem de forskellige verdensdele ikke ret
hurtige, og det var for eksempel en langsommelig affære at hente www.debian.org
fra et andet kontinent, det var meget langsommere end en typisk forbindelse via
modem.  Derfor organiserede via spejling og flere spejlinger af webstedet blev
etableret.  Ti (eller elleve hvis Tyrkiet medregnes) af dem er i Europa.</p>

<p>Men i dag har vi lynhurtige netværksforbindelser, specielt i Europa, så der
er næppe den store brug for så mange spejle.  Faktisk er det på grund af den 
forøgende hastighed på netværksforbindelser mellem Europa og Nordamerika, går
det ikke engang langsomt at tilgå www.debian.org fra Europa.</p>

<p>Dette er i store træk hvorfor vi ikke har brug for flere spejlinger af 
webstedet, specielt på kontinenter hvor der allerede findes spejle.  Vær venlig
at respektere vore ønsker.  Tak for din samarbejdsvilje.</p>

<p>Hvis du har spørgsmål, så send en e-mail på engelsk til 
<a href="mailto:mirrors@debian.org">mirrors@debian.org</a>.</p>

<hrline />

<toc-add-entry name="ref">Reference til eksisterende spejle</toc-add-entry>

<p><strong>Oplysningerne nedenfor stilles kun til rådighed som vejledning til 
vedligeholdere af eksisterende spejle.</strong></p>

<h3>Spejlingsprocessen</h3>

<p>Den anbefalede metode til spejling er med rsync.  Der findes ikke anonym
adgang til filerne på webstedet.  I samarbejde med vedligeholderen af det sted
du ønsker at spejle, kan opsætte godkendt adgang, send en e-mail på engelsk til
<a href="mailto:mirrors@debian.org">mirrors@debian.org</a>.</p>

<p>Spejlingen følger <q>pull</q>-metoden (hent-metoden), det vil sige at klienten 
beder om data fra serveren som den finder det passende.  For at opsætte dette 
kan du bruge <a href="websync">websync-scriptet</a> og <a href="websync.conf">\
dets opsætningsfil</a>, som kan køres fra crontab, og som vil gøre alt 
automatisk.  Følg punkterne i scriptet for at sikre dig at alt fungerer som det 
skal.</p>

<h4>Spejling fra et <q>push</q>-spejl</h4>

<p><q>Push</q>-spejling (skub-spejling) er en form for spejling ved hjælp af rsync
vi har udviklet for at minimere den tid der tager, for ændringer til arkivet at
når frem til spejlene.  Serverspejlet anvender en ssh-udløser til at fortælle
spejlet at det skal opdatere sig selv.</p>

<p>Denne metode er ganske sikker da ssh er opsat til kun at køre en enkelt 
kommando.  Desuden er spejlningen stadig <q>pull</q>, så det er <strong>ikke</strong>
muligt at ødelægge arkivets indhold via et forfalsket <q>push</q>-spejl.  Nogle
spejles administratorer har tøvet med at anvende denne metode til spejling, af
frygt for at metoden giver mulighed for en invadering af den.  Dette er ganske
enkelt <strong>ikke</strong> korrekt.</p>

<p>For en mere udførlig beskrivelse af hvordan dette fungerer, hvorfor det er 
sikkert, og hvordan et <q>push</q>-spejl sættes op, se <a href="push_mirroring">den
fuldstændige beskrivelse</a>.</p>

<h3>Når der skal spejles</h3>

<p>Det primære websted opdateres normalt hver fjerde time.</p>

<p>Hvis dit websted <q>push</q>-spejles, behøver du ikke bekymre dig om dette.  Hvis
ikke bør du beregne spejlingstiden for dit websted jævnfør 
tidsstemplingsfilerne i mappen <code>/mirror/timestamps/</code> på 
webstedsspejlet.  Tilføj noget tid, for ekesempel en halv time, til resultatet
og brug det som spejlingstidspunkt.</p>

<p>Den nemmeste måde, automatisk at lade spejlingen køre hver dag, er at 
anvende cron.  Se <kbd>man crontab</kbd> for flere oplysninger.</p>

<h3>Reklame for spejlets sponsor</h3>

<p>Hvis du ønsker det, kan du erstatte <code>sponsor_img.jpg</code> med et
(beskedent) logo for din egen virksomhed eller organisation, samt gøre 
<code>sponsor.html</code> til en omdirigering til jeres egen hjemmeside.
Som standard spejles ingen af disse to filer.  Standardfilnavnene er
<code>sponsor.deb.html</code> og <code>sponsor.deb.jpg</code>; selv om du må
anvende disse to standardfiler, opfordrer vi dig til at bruge dit eget billede.
Den anbefalede maksimale størrelse på dit logo er 120x60.</p>

<p>Da <a href="#cn">indholdsforhandling</a> anvendes på websiderne til at vælge
det foretrukne sprog, kan du sågar have <code>sponsor.html</code> på 
forskellige sprog.  For at gøre dette skal du blot oprette 
sponsor.&lt;sprog&gt;.html til hvert  &lt;sprog&gt; du ønsker.</p>

<p>Sørg for at tilføje alle filer som du ikke ønsker skal overskrives, til 
listen over filer som skal undlades fra spejlingen.</p>

<h3>Opsætning af webserveren</h3>

<h4>Forskellige ændringer til webserveren</h4>

<p>Hvis din maskine kører Debian, er det blevet besluttet af bryde Debians
retninglinier og anvende <code>/doc</code> på websiderne.  Dette betyder at du
skal udkommentere linien <q><code>Alias /doc/ /usr/share/doc/</code></q> i din
<code>/etc/apache/srm.conf</code>-fil.</p>

<p>Bemærk: Alle vores CGI-scripts kører centralt på cgi.debian.org, så dem skal
du ikke bekymre dig om.</p>

<h4><a name="cn">Indholdsforhandling</a></h4>

<p>Indholdsforhandling er en metode som lader en browser forhandle med en 
server om hvilken dokumenttype der skal leveres.  Der er flere måder at gøre
dette på, den mest almindelige er at forholdne sig frem til på hvilket sprog et
dokument skal leveres.  Ved at anvende denne metode kan Debian levere sine 
sider i mange sprog på en (teknisk) meget elegant måde.</p>

<p>For dem der anvender Apache er ændringen nærmæst triviel.  Tilføj blot denne
indstilling:</p>

<pre>
Options +Multiviews
</pre>

<p>til <code>&lt;Directory&gt;</code>-sektionen vedrørende Debian-websiderne i
din <kbd>/etc/apache/access.conf</kbd>-fil, og genstart serveren.</p>

<p>Desuden skal du sikre dig at serveren kan håndtere alle sprogene som 
webstedet findes på.  Dette gøres ved at bruge kommandoen 
<kbd>AddLanguage</kbd>.  Her følger en liste over de sprog som er i brug - 
forvent at skulle tilføje flere:</p>

<pre>
  AddLanguage en .en
<:
foreach $l (keys %langs) { push @codes, $langs{$l}; }
foreach $c (sort @codes) { print "  AddLanguage $c .$c\n" if (($c ne "en") && ($c ne "zh")); }
:>  \
  AddLanguage pt-br .pt
  AddLanguage nb .nb
  AddLanguage zh-CN .zh-cn
  AddLanguage zh-HK .zh-hk
  AddLanguage zh-TW .zh-tw
</pre>

<p>På grund af en fejl i Apache kan det forkerte sprog risikere at blive 
leveret i visse situationer, så det er en god idé at tilføje alle sprog der kan
leveres til kommandoen <q>LanguagePriority</q>, på denne måde:</p>

<pre>
<:
print "LanguagePriority en fr es ";
foreach $c (sort @codes) { print "$c " if (($c ne "en") && ($c ne "fr") && ($c ne "es") && ($c ne "zh")); }
print "pt-br nb zh-CN zh-HK zh-TW\n";
:>\
</pre>

<p>For at undgå at levere indholdsforhandlede filer med det forkerte tegnsæt,
skal du forvisse dig om at indstillingen <code>AddDefaultCharSet</code> er 
kommenteret ud eller sat til <q><code>Off</code></q>.</p>

<p>Til Apache 1, for at levere mappeindeksfiler korrekt, skal du formentlig 
ændre <code>DirectoryIndex</code>-linien i <code>/etc/apache/srm.conf</code>. 
Det fungerer dog ikke med Apache 2. Følgende burde være tilstrækkeligt:</p>

<pre>
DirectoryIndex index index.html
</pre>

<p>For at sende den korrekte Content-Type-header for filen favicon.ico, skal
Apache opsættes til at anvende typen image/x-icon type, på følgende måde:</p>

<pre>
AddType image/x-icon .ico
</pre>

<p>For at sende den korrekte Context-Type-header til RSS-feeds, skal Apache
opsættes til at anvende typen application/rss+xml på følgende måde:</p>	

<pre>
AddType application/rss+xml .rdf
</pre>

<p>For at sende den korrekte Content-Type-header vedrørende spanske 
oversættelser af HTML-, PDF- og rene tekst-filer, skal Apache instrueres i at 
anvende de korrekte typer, som det følgende:</p>

<pre>
&lt;Files *.html.es>
  ForceType text/html
&lt;/Files>

&lt;Files *.pdf.es>
  ForceType application/pdf
&lt;/Files>

&lt;Files *.txt.es>
  ForceType text/plain
&lt;/Files>
</pre>

<p>For at undgå problemer med indholdsforhandling i forbindelse med indholdet i
<a href="../events/">/events</a>, skal kalenderfiler tildeles en lavere
prioritet end indhold i form af text/html:</p>

<pre>
AddType text/calendar;qs=0.9 .ics
</pre>


<h4>Viderestilling</h4>

<p>Fordi nogle dele af webstedet begyndte at blive for store til at kunne 
spejles af de fleste websteder, har vi adskilt dem fra det primære websted.
Selvom de fleste links skulle være rettet til at anvende de nye placeringer, er
du velkommen til at tilføje viderestillinger til et andet websted så der ikke 
forekommer links der ikke virker.  Dette kan gøres i 
<kbd>/etc/apache/srm.conf</kbd>.  For eksempel:</p>

<pre>
Redirect /Lists-Archives http://lists.debian.org/
Redirect /search http://search.debian.org
Redirect /Packages http://packages.debian.org
Redirect /lintian http://lintian.debian.org
</pre>


<h4>Virtuelle værter</h4>

<p>Debians hjemmeside på <a href="$(HOME)">www.debian.org</a> og under 
flere andre navne, anvender en GeoDNS-opsætning, for at fordele belastningen og
vælge et spejl tæt på hvor brugeren befinder sig.</p>

<p>Som en følge deraf, bør Debians hjemmeside være tilgængelig gennem flere 
virtuelle værter i Apache, som på denne måde:</p>

<pre>ServerAlias www.debian.org www.debian.com debian.org www.*.debian.org</pre>
