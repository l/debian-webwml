#use wml::debian::template title="Opsætning af ftp-filspejl"
#use wml::debian::toc
#use wml::debian::translation-check translation="1.26"

<p>Der er ingen forskel på <a href="official">officielle</a> og uofficielle 
filspejle.</p>

<p>Når et filspejl er blevet sat up, bør det 
<a href="submit">registereres hos Debian</a> for at blive optaget på
<a href="list">listen over filspejle</a>.
Det gøres ved at benytte vores <a href="submit">simple webformular</a>.</p>

<p>Problemer eller forespørgsler stilles til 
<a href="mailto:mirrors@debian.org">mirrors@debian.org</a>.</p>

<toc-display/>

<toc-add-entry name="wherefrom">Hvor der kan filspejles fra</toc-add-entry>

<p>Mange lader til at tro, at <code>ftp.debian.org</code> er det kanoniske sted
for Debian-pakker og at det vil være bedst for dem at filspejle det ftp-sted.
Det er <strong>ikke rigtigt</strong>. <code>ftp.debian.org</code> er blot en af
flere servere som opdateres fra en intern Debian-server.</p>

<p>En hvilken som helst server på den <a href="mirrors_full">fuldstændige liste 
over filspejle</a> som har flaget '<kbd>Type: Push-Primary</kbd>' skulle være 
god at basere sit filspejl på.</p>

<p>For dig vil der i praksis ikke være nogen forskel på at basere et filspejl
på den server eller fra et andet <em>primært 'push'</em>-filspejl 
("Push-Primary mirror"). På den anden siden, hvis mange bruger ftp.debian.org 
(og det gør de desværre) sker der et spild af doneret båndbredde.</p>

<toc-add-entry name="methods">Filspejlingsmetoder</toc-add-entry>

<p>Den anbefalede filspejlingsmetode er at benytte rsync.</p>

<p>Bemærk: mens <kbd>wget</kbd> fungerer fint ved filspejling af små steder, er
det ikke så konfigurérbart som rsync eller 'mirror' og anbefales ikke til denne
opgave.</p>

<h3>Anonym rsync</h3>

<p>Du kan bruge <a href="anonftpsync">dette script</a> til at lave et filspejl
af arkivet. Følg instruktionerne i script'et for at sætte filspejlingen op.</p>

<h3>Rsync med godkendelse fra et 'push'-filspejl</h3>

<p>'Push'-filspejling er en form for spejling ved hjælp af rsync vi har 
udviklet for at minimere den tid det tager ændringer i arkivet at nå ud til 
filspejlene. Server-filspejlet anvender en ssh-udløser til at fortælle 
klient-filspejlet at det sker opdatere sig selv.</p>

<p>Push-filspejling er nødvendig hvis mange servere skal være synkrone (så som
servere i DNS der på skrift svarer på et alias som <tt>ftp.us.debian.org</tt>),
og vi bruger det almindeligvis i forbindelse med vores primære og sekundære 
filspejle. I forbindelse med "normale" filspejle er det et stort arbejde at 
sætte op, som ikke er umagen værd i forhold til et veltilpasset cron-job.</p>

<p>Denne metode er ganske sikker da ssh er sat op til kun at køre en enkelt 
kommando. Desuden er spejlingen stadig 'pull' så det er <strong>ikke</strong>
muligt at ødelægge indholdet af arkivet ved hjælp af et forfalsket 
'push'-filspejl. Nogle administratorer af filspejle har vist sig utilbøjelige 
til at anvende denne form for filspejl af frygt for at deres maskiner vil være
åbne for angreb. Det er simpelthen <strong>ikke</strong> korrekt.</p>

<p>For en mere detaljeret beskrivelse af hvordan dette fungerer, hvorfor det er
sikkert, og hvordan man opsætter et 'push'-filspejl, se 
<a href="push_mirroring">den komplette beskrivelse</a>.</p>

<h3>Anonym ftp ved hjælp af 'mirror'</h3>

<p>Anonym ftp var i lang tid den gængse filspejlningsmetode. Til dette formål
fungerer programmet 'mirror' fint i forbindelse med Debians arkiv. Som du nok
har gættet er 'mirror' tilgængelig som en Debian-pakke. Hvis du har installeret
Debian-pakken, er der et eksempel på et script til filspejl af ftp-arkivet i
/etc/mirror/packages/ftp.debian.org .</p>

<toc-add-entry name="partial">Delvis filspejling</toc-add-entry>

<p>Det allerede <a href="size">store Debian-arkiv</a> taget i betragtning, 
foretrækker nogle kun at spejle de dele som de har brug for. Hvis du ønsker at
fravælge noget, bør du fravælge arkitekturer.</p>

<p>Med <a href="anonftpsync">anonftpsync</a> kan dette gøres ved at ændre 
EXCLUDE-variablen. Du kan også bruge specielt fremstillede scripts som 
<a href="http://packages.debian.org/unstable/net/debmirror.html">debmirror</a>
(af Joey Hess og Joerg Wendland) eller 
<a href="http://people.debian.org/~absurd/absurd_debmirror/">\
absurd_debmirror</a> (af Stephan Suerken). Hvis du mener at noget bør føjes til 
disse scripts, så kontakt forfatterne (kontaktoplysninger skulle være at finde 
i scriptene selv).</p>

<p>Vi advarer kraftigt imod at fravælge katalogerne <tt>project/</tt>, 
<tt>doc/</tt> og andre underkataloger. Normalt er de ikke særligt store og 
alligevel nyttige for brugerne.</p>

<toc-add-entry name="when">Hvornår man skal filspejle</toc-add-entry>

<p>Hovedarkivet opdateres en gang i døgnet.</p>

<p>Hvis dit netsted 'push'-filspejles behøver du ikke bekymre dig om det. Hvis
ikke, og stedet du har valgt af filspejle bruger rsync, bør du tage et kig i
<kbd>project/trace/</kbd> det pågældende steds Debians arkiv, efter en fil med
samme navn som filspejlet. Filen skulle indeholde klokkeslettet på hvornår en
filspejlning sidst blev afsluttet. Læg noget tid til, for eksempel en time, og
start din filspejl på det tidspunkt.</p>

<p>Den nemmeste måde, automatisk at få filspejlet opdateret hver dag er at 
anvende cron. Se <kbd>man crontab</kbd> for flere oplysninger.</p>

<toc-add-entry name="settings">Yderligere anbefalet opsætning</toc-add-entry>

<p>Hvis du ønsker at gøre et Debian-filspejl tilgængeligt via HTTP, tilføj da
følgende indstillinger til din opsætning af Apache (naturligvis forudsat at du
bruger Apache) til katalog-indekserne:</p>

<pre>
&lt;directory /org/ftp.debian.org/ftp&gt;
   IndexOptions NameWidth=* +SuppressDescription
   DirectoryIndex .
&lt;/directory&gt;
</pre>

<p>(udskift <code>/org/ftp.debian.org/ftp</code> med navnet på kataloget hvor
du har dit filspejl).</p>
