#! /bin/bash

. `dirname $0`/../config.sh

contentsdir=${filesdir}/contents
test -d ${contentsdir} || mkdir -p ${contentsdir}

cd ${archivedir}

# Main Archive
#
for dist in ${dists} 
do
   test -d ${contentsdir}/${dist} || mkdir -p ${contentsdir}/${dist}
   cd us/${dist}
   foo=\$arch_${dist//-/_}
   for arch in `eval echo $foo`
   do
      test Contents-${arch}.gz -nt  ${contentsdir}/${dist}/Contents-${arch} &&
      zcat Contents-${arch}.gz | tail --lines=+33 \
         > ${contentsdir}/${dist}/Contents-${arch}
   done
   cd ${archivedir}
done

# non-US
#
for dist in ${dists} 
do
   test -d ${contentsdir}/${dist} || mkdir -p ${contentsdir}/${dist}
   cd non-US/${dist}
   foo=\$arch_${dist//-/_}
   for arch in `eval echo $foo`
   do
      test Contents-${arch}.gz -nt  ${contentsdir}/${dist}/Contents-${arch}.non-US &&
      zcat Contents-${arch}.gz | tail --lines=+33 > ${contentsdir}/${dist}/Contents-${arch}.non-US
   done            
   cd ${archivedir}
done
